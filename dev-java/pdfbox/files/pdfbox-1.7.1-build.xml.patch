--- /tmp/pdfbox-1.7.1.orig/pdfbox/build.xml	2012-07-17 21:31:50.000000000 +0300
+++ ./build.xml	2012-10-18 22:49:36.141782954 +0300
@@ -36,6 +36,7 @@
     <property name="pdfbox.src.dir" value="src/main/java" />
     <property name="pdfbox.target.dir" value="target" />
     <property name="pdfbox.dest.dir" value="${pdfbox.target.dir}/classes" />
+    <property name="pdfbox.test.classes.dir" value="${pdfbox.target.dir}/test-classes" />
     <property name="pdfbox.test.dir" value="src/test/java" />
     <property name="pdfbox.testfiles.dir" value="/src/test/resources" />
     <property name="pdfbox.resources.dir" value="src/main/resources" />
@@ -181,15 +182,12 @@
         <mkdir dir="${jempbox.dest.dir}"/>
     </target>
 
-    <target name="pdfbox.compile" depends="fontbox.package,jempbox.package,pdfbox.init,get.adobefiles"
+    <target name="pdfbox.compile" depends="pdfbox.init,get.adobefiles"
             description="Compile Java source files">
         <!-- required encoding flag to be able to build using ibm-jdk on redhat ES-->
         <javac srcdir="${pdfbox.src.dir}" destdir="${pdfbox.dest.dir}"
                target="1.5" source="1.5" debug="on" deprecation="on"
                classpathref="pdfbox.build.classpath" encoding="ISO-8859-1"/>
-        <javac srcdir="${pdfbox.test.dir}" destdir="${pdfbox.dest.dir}"
-               target="1.5" source="1.5" debug="on" deprecation="on"
-               classpathref="pdfbox.build.classpath" encoding="ISO-8859-1"/>
     </target>
 
     <target name="fontbox.compile" depends="fontbox.init"
@@ -214,7 +212,7 @@
                classpathref="jempbox.build.classpath" encoding="ISO-8859-1"/>
     </target>
 
-    <target name="test" depends="testextract,test-junit,testimage" description="Run all the junit tests"/>
+    <target name="test" depends="testextract,test-junit" description="Run all the junit tests"/>
 
     <target name="find.adobefiles">
         <available property="adobefiles.found" file="${dest.dir}/org/apache/pdfbox/resources/cmap"/>
@@ -277,7 +275,7 @@
         <unjar src="${testfiles.encryption.jar}" dest="${testinput-ext.dir}"/>
     </target>
 
-    <target name="testextract" depends="clean,pdfbox.compile" description="Test text extraction">
+    <target name="testextract" depends="pdfbox.test.compile" description="Test text extraction">
         <junit printsummary="off" fork="on" dir=".">
             <jvmarg value="-Xmx1024M"/>
             <jvmarg value="-Xms512M"/>
@@ -300,7 +298,7 @@
         </junit>
     </target>
 
-    <target name="testimage" depends="clean,pdfbox.compile" description="Test image rendering">
+    <target name="testimage" depends="pdfbox.test.compile" description="Test image rendering">
         <junit printsummary="off" fork="on" dir="."  >
             <jvmarg value="-Xmx1024M"/>
             <jvmarg value="-Xms512M"/>
@@ -323,8 +321,15 @@
             <test name="org.apache.pdfbox.util.TestPDFToImage" />
         </junit>
     </target>
+	
+	<target name="pdfbox.test.compile" depends="pdfbox.compile">
+		<mkdir dir="${pdfbox.test.classes.dir}" />
+        <javac srcdir="${pdfbox.test.dir}" destdir="${pdfbox.dest.dir}"
+               target="1.5" source="1.5" debug="on" deprecation="on"
+               classpathref="pdfbox.build.classpath" encoding="ISO-8859-1"/>
+	</target>
 
-    <target name="test-junit" depends="clean,pdfbox.compile" description="run junit tests">
+    <target name="test-junit" depends="pdfbox.test.compile" description="run junit tests">
         <junit printsummary="off" fork="on" dir=".">
             <sysproperty key="java.util.logging.config.file"
                          value="src/test/resources/logging.properties"/>
