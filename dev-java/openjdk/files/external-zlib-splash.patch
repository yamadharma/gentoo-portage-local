Index: openjdk-b13/j2se/make/sun/splashscreen/FILES_c.gmk
===================================================================
--- openjdk-b13.orig/j2se/make/sun/splashscreen/FILES_c.gmk
+++ openjdk-b13/j2se/make/sun/splashscreen/FILES_c.gmk
@@ -52,20 +52,6 @@ FILES_c = \
 	$(CTARGDIR)dgif_lib.c \
 	$(CTARGDIR)gif_err.c \
 	$(CTARGDIR)gifalloc.c \
-	$(CTARGDIR)compress.c \
-	$(CTARGDIR)deflate.c \
-	$(CTARGDIR)gzio.c \
-	$(CTARGDIR)infblock.c \
-	$(CTARGDIR)infcodes.c \
-	$(CTARGDIR)inffast.c \
-	$(CTARGDIR)inflate.c \
-	$(CTARGDIR)inftrees.c \
-	$(CTARGDIR)infutil.c \
-	$(CTARGDIR)trees.c \
-	$(CTARGDIR)uncompr.c \
-	$(CTARGDIR)zadler32.c \
-	$(CTARGDIR)zcrc32.c \
-	$(CTARGDIR)zutil.c \
 	$(CTARGDIR)jcomapi.c \
 	$(CTARGDIR)jdapimin.c \
 	$(CTARGDIR)jdapistd.c \
@@ -111,3 +97,19 @@ FILES_c = \
 	$(CTARGDIR)jfdctfst.c \
 	$(CTARGDIR)jfdctint.c
 
+ifneq ($(EXTERNAL_ZLIB),true)
+FILES_c += $(CTARGDIR)compress.c \
+	$(CTARGDIR)deflate.c \
+	$(CTARGDIR)gzio.c \
+	$(CTARGDIR)infblock.c \
+	$(CTARGDIR)infcodes.c \
+	$(CTARGDIR)inffast.c \
+	$(CTARGDIR)inflate.c \
+	$(CTARGDIR)inftrees.c \
+	$(CTARGDIR)infutil.c \
+	$(CTARGDIR)trees.c \
+	$(CTARGDIR)uncompr.c \
+	$(CTARGDIR)zadler32.c \
+	$(CTARGDIR)zcrc32.c \
+	$(CTARGDIR)zutil.c
+endif
Index: openjdk-b13/j2se/make/sun/splashscreen/Makefile
===================================================================
--- openjdk-b13.orig/j2se/make/sun/splashscreen/Makefile
+++ openjdk-b13/j2se/make/sun/splashscreen/Makefile
@@ -83,9 +83,15 @@ vpath %.c   $(SHARE_SRC)/native/$(PKGDIR
 vpath %.c   $(PLATFORM_SRC)/native/$(PKGDIR)/splashscreen
 
 CPPFLAGS += -I$(PLATFORM_SRC)/native/$(PKGDIR)/splashscreen -I$(SHARE_SRC)/native/$(PKGDIR)/splashscreen
-CPPFLAGS += -I$(SHARE_SRC)/native/$(PKGDIR)/image/jpeg -I$(SHARE_SRC)/native/java/util/zip/zlib-1.1.3
+CPPFLAGS += -I$(SHARE_SRC)/native/$(PKGDIR)/image/jpeg
 
 #
 # Has been converted to the JNI: generate JNI-style header files
 #
 JAVAHFLAGS += -jni
+
+ifeq ($(EXTERNAL_ZLIB), true)
+  OTHER_LDLIBS += -lz
+else
+  CPPFLAGS += -I$(SHARE_SRC)/native/java/util/zip/zlib-1.1.3
+endif
