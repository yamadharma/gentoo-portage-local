diff -U2 --recursive TeXmacs-1.0.6.10-src.orig/plugins/maxima/bin/maxima_detect TeXmacs-1.0.6.10-src/plugins/maxima/bin/maxima_detect
--- TeXmacs-1.0.6.10-src.orig/plugins/maxima/bin/maxima_detect	2007-05-16 00:54:34.000000000 +0700
+++ TeXmacs-1.0.6.10-src/plugins/maxima/bin/maxima_detect	2007-08-29 00:22:14.000000000 +0700
@@ -1,3 +1,3 @@
-#!/bin/sh
+#!/bin/bash
 # if there is an argument, find maxima_toc.html
 
@@ -37,18 +37,15 @@
 }
 
-PATH="/cygdrive/c/Program Files/Maxima-5.9.2/bin:$PATH"
-PATH="/cygdrive/c/Program Files/Maxima-5.9.3/bin:$PATH"
-export PATH
-
-MAXIMA=`type -p maxima 2>/dev/null`
+if [ $OSTYPE == "cygwin" ] ; then EXT='.bat'; else EXT=''; fi
+MAXIMA=`type -p maxima$EXT 2>/dev/null`
 if [ $? -eq 0 ]
 then
-  if [ -f "/usr/bin/cygwin1.dll" ]
+  if [ $OSTYPE == "cygwin" ]
   then
     if [ "$1" ]
     then
-      maxima.bat -d | grep -F 'maxima-htmldir=' | \
-        sed -e 's/maxima-htmldir=/"/' -e 's|$|/maxima_toc.html"|' \
-	    -e 's|\\|/|g' -e 's|C:|/cygdrive/c/|'
+      maxima -d | grep -F 'maxima-htmldir=' | \
+        sed -e 's/maxima-htmldir=/"/' -e 's|$|/maxima_toc.html"|' | \
+        cygpath -f -
     else
       echo '("cygwin")'
@@ -65,7 +62,8 @@
 version 5.10
 version 5.11
-version 5.12" >/dev/null
+version 5.12
+version 5.13" >/dev/null
         then
-          # 5.9.1 or 5.9.2 or 5.9.3 or 5.10 or 5.11 or 5.12
+          # 5.9.1 or 5.9.2 or 5.9.3 or 5.10 or 5.11 or 5.12 or 5.13
           maxima -d | grep -F 'maxima-htmldir=' | sed -e \
           's/maxima-htmldir=/"/' -e 's|$|/maxima_toc.html"|'
diff -U2 --recursive TeXmacs-1.0.6.10-src.orig/plugins/maxima/bin/tm_maxima TeXmacs-1.0.6.10-src/plugins/maxima/bin/tm_maxima
--- TeXmacs-1.0.6.10-src.orig/plugins/maxima/bin/tm_maxima	2007-05-16 00:54:34.000000000 +0700
+++ TeXmacs-1.0.6.10-src/plugins/maxima/bin/tm_maxima	2007-08-29 00:23:07.000000000 +0700
@@ -3,7 +3,4 @@
 TEXMACS_MAXIMA_PATH="$TEXMACS_PATH/plugins/maxima/lisp"
 export TEXMACS_MAXIMA_PATH
-PATH="/cygdrive/c/Program Files/Maxima-5.9.2/bin:$PATH"
-PATH="/cygdrive/c/Program Files/Maxima-5.9.3/bin:$PATH"
-export PATH
 
 case $1 in
@@ -21,13 +18,7 @@
   5.9.1.1* | 5.9.2* | 5.9.3*) exec maxima -u $1 -l $2 -p "$TEXMACS_MAXIMA_PATH/texmacs-maxima-5.9.2.lisp";;
   5.10.*) exec maxima -u $1 -l $2 -p "$TEXMACS_MAXIMA_PATH/texmacs-maxima-5.10.0.lisp";;
-  5.11.* | 5.12.*) exec maxima -u $1 -l $2 -p "$TEXMACS_MAXIMA_PATH/texmacs-maxima-5.11.0.lisp";;
+  5.11.* | 5.12.* | 5.13.*) exec maxima -u $1 -l $2 -p "$TEXMACS_MAXIMA_PATH/texmacs-maxima-5.11.0.lisp";;
   cygwin)
-    CYGWIN_ROOT="C:\cygwin"
-    CYGWIN_TEXMACS_HOME=`echo $TEXMACS_HOME_PATH | sed 's|/|\\\\|g'`
-    export CYGWIN_TEXMACS_HOME
-    cp -f "$TEXMACS_MAXIMA_PATH/texmacs-maxima-5.9.2.lisp" \
-          "$CYGWIN_ROOT$CYGWIN_TEXMACS_HOME\system\tmp"
-    exec maxima.bat -p \
-      "$CYGWIN_ROOT$CYGWIN_TEXMACS_HOME\system\tmp\texmacs-maxima-5.9.2.lisp";;
+    exec maxima.bat -p "`echo $TEXMACS_MAXIMA_PATH/texmacs-maxima-5.11.0.lisp|cygpath --windows -f -`";;
   *) echo -e "\2latex:\\red Unsupported version of maxima: $1\5"
 esac
