--- chart2/source/controller/chartapiwrapper/DiagramWrapper.cxx	2008-01-14 14:56:02.000000000 +0100
+++ chart2/source/controller/chartapiwrapper/DiagramWrapper.cxx	2008-01-18 16:09:02.000000000 +0100
@@ -136,6 +136,8 @@
 
     PROP_DIAGRMA_RIGHT_ANGLED_AXES,
 
+    PROP_DIAGRAM_STARTING_ANGLE,
+
     PROP_DIAGRAM_HAS_X_AXIS,
     PROP_DIAGRAM_HAS_X_AXIS_DESCR,
     PROP_DIAGRAM_HAS_X_AXIS_TITLE,
@@ -158,7 +160,10 @@
     PROP_DIAGRAM_HAS_SECOND_X_AXIS_DESCR,
 
     PROP_DIAGRAM_HAS_SECOND_Y_AXIS,
-    PROP_DIAGRAM_HAS_SECOND_Y_AXIS_DESCR
+    PROP_DIAGRAM_HAS_SECOND_Y_AXIS_DESCR,
+
+    PROP_DIAGRAM_HAS_SECOND_X_AXIS_TITLE,
+    PROP_DIAGRAM_HAS_SECOND_Y_AXIS_TITLE
 };
 
 void lcl_AddPropertiesToVector(
@@ -256,6 +261,14 @@
                   beans::PropertyAttribute::BOUND
                   | beans::PropertyAttribute::MAYBEDEFAULT ));
 
+    //for pie and donut charts
+    rOutProperties.push_back(
+        Property( C2U( "StartingAngle" ),
+                  PROP_DIAGRAM_STARTING_ANGLE,
+                  ::getCppuType( reinterpret_cast< const sal_Int32 * >(0) ),
+                  beans::PropertyAttribute::BOUND
+                  | beans::PropertyAttribute::MAYBEDEFAULT ));
+
     // XAxisXSupplier
     rOutProperties.push_back(
         Property( C2U( "HasXAxis" ),
@@ -379,6 +392,20 @@
                   ::getBooleanCppuType(),
                   beans::PropertyAttribute::BOUND
                   | beans::PropertyAttribute::MAYBEDEFAULT ));
+
+    // XSecondAxisTitleSupplier
+    rOutProperties.push_back(
+        Property( C2U( "HasSecondaryXAxisTitle" ),
+                  PROP_DIAGRAM_HAS_SECOND_X_AXIS_TITLE,
+                  ::getBooleanCppuType(),
+                  beans::PropertyAttribute::BOUND
+                  | beans::PropertyAttribute::MAYBEDEFAULT ));
+    rOutProperties.push_back(
+        Property( C2U( "HasSecondaryYAxisTitle" ),
+                  PROP_DIAGRAM_HAS_SECOND_Y_AXIS_TITLE,
+                  ::getBooleanCppuType(),
+                  beans::PropertyAttribute::BOUND
+                  | beans::PropertyAttribute::MAYBEDEFAULT ));
 }
 
 const uno::Sequence< Property > & lcl_GetPropertySequence()
@@ -954,6 +981,28 @@
     return m_xYMainGrid;
 }
 
+// ____ XSecondAxisTitleSupplier ____
+Reference<
+    drawing::XShape > SAL_CALL DiagramWrapper::getSecondXAxisTitle()
+    throw (uno::RuntimeException)
+{
+    if( !m_xSecondXAxisTitle.is() )
+    {
+        m_xSecondXAxisTitle = new TitleWrapper( TitleHelper::SECONDARY_X_AXIS_TITLE, m_spChart2ModelContact );
+    }
+    return m_xSecondXAxisTitle;
+}
+
+Reference<
+    drawing::XShape > SAL_CALL DiagramWrapper::getSecondYAxisTitle()
+    throw (uno::RuntimeException)
+{
+    if( !m_xSecondYAxisTitle.is() )
+    {
+        m_xSecondYAxisTitle = new TitleWrapper( TitleHelper::SECONDARY_Y_AXIS_TITLE, m_spChart2ModelContact );
+    }
+    return m_xSecondYAxisTitle;
+}
 
 // ____ XStatisticDisplay ____
 Reference<
@@ -1023,6 +1072,8 @@
     DisposeHelper::DisposeAndClear( m_xXAxisTitle );
     DisposeHelper::DisposeAndClear( m_xYAxisTitle );
     DisposeHelper::DisposeAndClear( m_xZAxisTitle );
+    DisposeHelper::DisposeAndClear( m_xSecondXAxisTitle );
+    DisposeHelper::DisposeAndClear( m_xSecondYAxisTitle );
     DisposeHelper::DisposeAndClear( m_xXAxis );
     DisposeHelper::DisposeAndClear( m_xYAxis );
     DisposeHelper::DisposeAndClear( m_xZAxis );
--- chart2/source/controller/chartapiwrapper/DiagramWrapper.hxx	2007-08-17 14:12:04.000000000 +0200
+++ chart2/source/controller/chartapiwrapper/DiagramWrapper.hxx	2007-11-20 17:56:51.000000000 +0100
@@ -39,8 +39,8 @@
 #include "ServiceMacros.hxx"
 #include "DiagramHelper.hxx"
 
-#ifndef _CPPUHELPER_IMPLBASE9_HXX_
-#include <cppuhelper/implbase9.hxx>
+#ifndef _CPPUHELPER_IMPLBASE10_HXX_
+#include <cppuhelper/implbase10.hxx>
 #endif
 #ifndef _COMPHELPER_UNO3_HXX_
 #include <comphelper/uno3.hxx>
@@ -96,6 +96,10 @@
 #include <com/sun/star/lang/XEventListener.hpp>
 #endif
 
+#ifndef _COM_SUN_STAR_CHART_XSECONDAXISTITLESUPPLIER_HPP_
+#include <com/sun/star/chart/XSecondAxisTitleSupplier.hpp>
+#endif
+
 #include <boost/shared_ptr.hpp>
 
 namespace chart
@@ -106,7 +110,7 @@
 
 class Chart2ModelContact;
 
-class DiagramWrapper : public ::cppu::ImplInheritanceHelper9<
+class DiagramWrapper : public ::cppu::ImplInheritanceHelper10<
                       WrappedPropertySet
                      , ::com::sun::star::chart::XDiagram
                      , ::com::sun::star::chart::XAxisZSupplier
@@ -118,6 +122,7 @@
    	                 , ::com::sun::star::lang::XComponent
 //                      , ::com::sun::star::lang::XEventListener
                      , ::com::sun::star::chart2::XDiagramProvider
+                     , ::com::sun::star::chart::XSecondAxisTitleSupplier
                     >
 {
 public:
@@ -216,6 +221,14 @@
         ::com::sun::star::beans::XPropertySet > SAL_CALL getYMainGrid()
         throw (::com::sun::star::uno::RuntimeException);
 
+   // ____ XSecondAxisTitleSupplier ____
+    virtual ::com::sun::star::uno::Reference<
+        ::com::sun::star::drawing::XShape > SAL_CALL getSecondXAxisTitle()
+        throw (::com::sun::star::uno::RuntimeException);
+    virtual ::com::sun::star::uno::Reference<
+        ::com::sun::star::drawing::XShape > SAL_CALL getSecondYAxisTitle()
+        throw (::com::sun::star::uno::RuntimeException);
+
     // ____ XStatisticDisplay ____
     virtual ::com::sun::star::uno::Reference<
         ::com::sun::star::beans::XPropertySet > SAL_CALL getUpBar()
@@ -268,6 +281,12 @@
     ::com::sun::star::uno::Reference<
         ::com::sun::star::drawing::XShape >
                         m_xZAxisTitle;
+    ::com::sun::star::uno::Reference<
+        ::com::sun::star::drawing::XShape >
+                        m_xSecondXAxisTitle;
+    ::com::sun::star::uno::Reference<
+        ::com::sun::star::drawing::XShape >
+                        m_xSecondYAxisTitle;
 
     ::com::sun::star::uno::Reference<
         ::com::sun::star::beans::XPropertySet >
--- chart2/source/controller/chartapiwrapper/WrappedAxisAndGridExistenceProperties.cxx	2007-12-05 11:45:37.000000000 +0100
+++ chart2/source/controller/chartapiwrapper/WrappedAxisAndGridExistenceProperties.cxx	2007-12-18 14:45:29.000000000 +0100
@@ -229,7 +229,7 @@
 class WrappedAxisTitleExistenceProperty : public WrappedProperty
 {
 public:
-    WrappedAxisTitleExistenceProperty( sal_Int32 nDimensionIndex
+    WrappedAxisTitleExistenceProperty( sal_Int32 nTitleIndex
         , ::boost::shared_ptr< Chart2ModelContact > spChart2ModelContact );
     virtual ~WrappedAxisTitleExistenceProperty();
 
@@ -254,15 +254,17 @@
     rList.push_back( new WrappedAxisTitleExistenceProperty( 0, spChart2ModelContact ) );//x axis title
     rList.push_back( new WrappedAxisTitleExistenceProperty( 1, spChart2ModelContact ) );//y axis title
     rList.push_back( new WrappedAxisTitleExistenceProperty( 2, spChart2ModelContact ) );//z axis title
+    rList.push_back( new WrappedAxisTitleExistenceProperty( 3, spChart2ModelContact ) );//secondary x axis title
+    rList.push_back( new WrappedAxisTitleExistenceProperty( 4, spChart2ModelContact ) );//secondary y axis title
 }
 
-WrappedAxisTitleExistenceProperty::WrappedAxisTitleExistenceProperty( sal_Int32 nDimensionIndex
+WrappedAxisTitleExistenceProperty::WrappedAxisTitleExistenceProperty( sal_Int32 nTitleIndex
                 , ::boost::shared_ptr< Chart2ModelContact > spChart2ModelContact )
             : WrappedProperty(OUString(),OUString())
             , m_spChart2ModelContact( spChart2ModelContact )
             , m_eTitleType( TitleHelper::Y_AXIS_TITLE )
 {
-    switch( nDimensionIndex )
+    switch( nTitleIndex )
     {
         case 0:
             m_aOuterName = C2U( "HasXAxisTitle" );
@@ -272,6 +274,14 @@
             m_aOuterName = C2U( "HasZAxisTitle" );
             m_eTitleType = TitleHelper::Z_AXIS_TITLE;
             break;
+        case 3:
+            m_aOuterName = C2U( "HasSecondaryXAxisTitle" );
+            m_eTitleType = TitleHelper::SECONDARY_X_AXIS_TITLE;
+            break;
+        case 4:
+            m_aOuterName = C2U( "HasSecondaryYAxisTitle" );
+            m_eTitleType = TitleHelper::SECONDARY_Y_AXIS_TITLE;
+            break;
         default:
             m_aOuterName = C2U( "HasYAxisTitle" );
             m_eTitleType = TitleHelper::Y_AXIS_TITLE;
--- chart2/source/controller/dialogs/Bitmaps_HC.hrc	2007-05-22 19:26:01.000000000 +0200
+++ chart2/source/controller/dialogs/Bitmaps_HC.hrc	2007-12-18 09:37:18.000000000 +0100
@@ -38,6 +38,8 @@
 
 // RID_SCH_START is 30512 (see svtools/solar.hrc)
 
+// next free: 100
+
 #ifndef SC_HC_MASKCOLOR
 #define SC_HC_MASKCOLOR Color { Red = 0xFF00; Green = 0x0000; Blue = 0xFF00; }
 #endif
@@ -188,10 +190,12 @@
 
 //-----------------------------------------------------------------------------
 //SchStatisticTabPage and SchDataStatisticsDlg part 1
-#define BMP_INDICATE_NONE_HC (RID_SCH_START + 88)
-#define BMP_INDICATE_BOTH_HC (RID_SCH_START + 89)
+#define BMP_INDICATE_BOTH_VERTI_HC (RID_SCH_START + 89)
 #define BMP_INDICATE_UP_HC (RID_SCH_START + 90)
 #define BMP_INDICATE_DOWN_HC (RID_SCH_START + 91)
+#define BMP_INDICATE_BOTH_HORI_HC (RID_SCH_START + 97)
+#define BMP_INDICATE_RIGHT_HC (RID_SCH_START + 98)
+#define BMP_INDICATE_LEFT_HC (RID_SCH_START + 99)
 
 //SchStatisticTabPage and SchDataStatisticsDlg part 2
 #define BMP_REGRESSION_NONE_HC (RID_SCH_START + 92)
--- chart2/source/controller/dialogs/Bitmaps_HC.src	2007-05-22 19:26:22.000000000 +0200
+++ chart2/source/controller/dialogs/Bitmaps_HC.src	2007-12-18 09:37:43.000000000 +0100
@@ -446,22 +446,31 @@
 //---------------------
 //---------------------
 //error indicator
-Bitmap BMP_INDICATE_NONE_HC
+Bitmap BMP_INDICATE_BOTH_VERTI_HC
 {
-	File = "indinone_h.bmp" ;
-};
-Bitmap BMP_INDICATE_BOTH_HC
-{
-	File = "indiboth_h.bmp" ;
+	File = "errorbothverti_30_h.png" ;
 };
 Bitmap BMP_INDICATE_DOWN_HC
 {
-	File = "indidown_h.bmp" ;
+	File = "errordown_30_h.png" ;
 };
 Bitmap BMP_INDICATE_UP_HC
 {
-	File = "indiup_h.bmp" ;
+	File = "errorup_30_h.png" ;
 };
+Bitmap BMP_INDICATE_BOTH_HORI_HC
+{
+	File = "errorbothhori_30_h.png" ;
+};
+Bitmap BMP_INDICATE_RIGHT_HC
+{
+	File = "errorright_30_h.png" ;
+};
+Bitmap BMP_INDICATE_LEFT_HC
+{
+	File = "errorleft_30_h.png" ;
+};
+
 //---------------------
 //regression curves
 Bitmap BMP_REGRESSION_NONE_HC
--- chart2/source/controller/dialogs/Bitmaps.hrc	2007-05-22 19:25:39.000000000 +0200
+++ chart2/source/controller/dialogs/Bitmaps.hrc	2007-12-18 09:35:46.000000000 +0100
@@ -39,6 +39,8 @@
 #include <svtools/solar.hrc>
 #endif
 
+// next free: 100
+
 #ifndef STD_MASKCOLOR
 #define STD_MASKCOLOR Color { Red = 0xFF00; Green = 0x0000; Blue = 0xFF00; }
 #endif
@@ -190,10 +192,12 @@
 
 //-----------------------------------------------------------------------------
 //SchStatisticTabPage and SchDataStatisticsDlg part 1
-#define BMP_INDICATE_NONE (RID_APP_START + 88)
-#define BMP_INDICATE_BOTH (RID_APP_START + 89)
+#define BMP_INDICATE_BOTH_VERTI (RID_APP_START + 89)
 #define BMP_INDICATE_UP (RID_APP_START + 90)
 #define BMP_INDICATE_DOWN (RID_APP_START + 91)
+#define BMP_INDICATE_BOTH_HORI (RID_APP_START + 97)
+#define BMP_INDICATE_RIGHT (RID_APP_START + 98)
+#define BMP_INDICATE_LEFT (RID_APP_START + 99)
 
 //SchStatisticTabPage and SchDataStatisticsDlg part 2
 #define BMP_REGRESSION_NONE (RID_APP_START + 92)
--- chart2/source/controller/dialogs/Bitmaps.src	2007-05-22 19:25:50.000000000 +0200
+++ chart2/source/controller/dialogs/Bitmaps.src	2007-12-18 09:37:58.000000000 +0100
@@ -446,22 +446,31 @@
 //---------------------
 //---------------------
 //error indicator
-Bitmap BMP_INDICATE_NONE
+Bitmap BMP_INDICATE_BOTH_VERTI
 {
-	File = "indinone.bmp" ;
-};
-Bitmap BMP_INDICATE_BOTH
-{
-	File = "indiboth.bmp" ;
+	File = "errorbothverti_30.png" ;
 };
 Bitmap BMP_INDICATE_DOWN
 {
-	File = "indidown.bmp" ;
+	File = "errordown_30.png" ;
 };
 Bitmap BMP_INDICATE_UP
 {
-	File = "indiup.bmp" ;
+	File = "errorup_30.png" ;
 };
+Bitmap BMP_INDICATE_BOTH_HORI
+{
+	File = "errorbothhori_30.png" ;
+};
+Bitmap BMP_INDICATE_RIGHT
+{
+	File = "errorright_30.png" ;
+};
+Bitmap BMP_INDICATE_LEFT
+{
+	File = "errorleft_30.png" ;
+};
+
 //---------------------
 //regression curves
 Bitmap BMP_REGRESSION_NONE
--- chart2/source/controller/dialogs/DataBrowser.cxx	2007-07-25 10:30:12.000000000 +0200
+++ chart2/source/controller/dialogs/DataBrowser.cxx	2007-12-10 15:40:03.000000000 +0100
@@ -161,17 +161,21 @@
 public:
     SeriesHeaderEdit( Window * pParent );
     virtual ~SeriesHeaderEdit();
+    virtual void MouseButtonDown( const MouseEvent& rMEvt );
 
     void setStartColumn( sal_Int32 nStartColumn );
     sal_Int32 getStartColumn() const;
+    void SetShowWarningBox( bool bShowWarning = true );
 
 private:
     sal_Int32 m_nStartColumn;
+    bool m_bShowWarningBox;
 };
 
 SeriesHeaderEdit::SeriesHeaderEdit( Window * pParent ) :
         Edit( pParent ),
-        m_nStartColumn( 0 )
+        m_nStartColumn( 0 ),
+        m_bShowWarningBox( false )
 {}
 SeriesHeaderEdit::~SeriesHeaderEdit()
 {}
@@ -186,6 +190,20 @@
     return m_nStartColumn;
 }
 
+void SeriesHeaderEdit::SetShowWarningBox( bool bShowWarning )
+{
+    m_bShowWarningBox = bShowWarning;
+}
+
+void SeriesHeaderEdit::MouseButtonDown( const MouseEvent& rMEvt )
+{
+    Edit::MouseButtonDown( rMEvt );
+
+    if( m_bShowWarningBox )
+        WarningBox( this, WinBits( WB_OK ),
+                    String( SchResId( STR_INVALID_NUMBER ))).Execute();
+}
+
 class SeriesHeader
 {
 public:
@@ -524,6 +542,7 @@
     m_bIsReadOnly( false ),
     m_bIsDirty( false ),
     m_bLiveUpdate( bLiveUpdate ),
+    m_bDataValid( true ),
     m_aNumberEditField( & EditBrowseBox::GetDataWindow(), WB_NOBORDER ),
     m_aTextEditField( & EditBrowseBox::GetDataWindow(), WB_NOBORDER ),
     m_rNumberEditController( new ::svt::FormattedFieldCellController( & m_aNumberEditField )),
@@ -814,8 +833,60 @@
     m_aCellModifiedLink = rLink;
 }
 
+void DataBrowser::MouseButtonDown( const BrowserMouseEvent& rEvt )
+{
+    if( !m_bDataValid )
+        ShowWarningBox();
+    else
+        EditBrowseBox::MouseButtonDown( rEvt );
+}
+
+void DataBrowser::ShowWarningBox()
+{
+    WarningBox( this, WinBits( WB_OK ),
+                String( SchResId( STR_INVALID_NUMBER ))).Execute();
+}
+
+bool DataBrowser::ShowQueryBox()
+{
+    QueryBox* pQueryBox = new QueryBox( this, WB_YES_NO, String( SchResId( STR_DATA_EDITOR_INCORRECT_INPUT )));
+
+    return ( pQueryBox->Execute() == RET_YES );
+}
+
+bool DataBrowser::IsDataValid()
+{
+    bool bValid = true;
+    const sal_Int32 nRow = lcl_getRowInData( GetCurRow());
+    const sal_Int32 nCol = lcl_getColumnInData( GetCurColumnId());
+
+    if( m_apDataBrowserModel->getCellType( nCol, nRow ) == DataBrowserModel::NUMBER )
+    {
+        sal_uInt32 nDummy = 0;
+        double fDummy = 0.0;
+        String aText( m_aNumberEditField.GetText());
+
+        if( aText.Len() > 0 &&
+            m_spNumberFormatterWrapper.get() &&
+            m_spNumberFormatterWrapper->getSvNumberFormatter() &&
+            ! m_spNumberFormatterWrapper->getSvNumberFormatter()->IsNumberFormat(
+              aText, nDummy, fDummy ))
+        {
+            bValid = false;
+        }
+    }
+
+    return bValid;
+}
+
+bool DataBrowser::IsEnableItem()
+{
+    return m_bDataValid;
+}
+
 void DataBrowser::CellModified()
 {
+    m_bDataValid = IsDataValid();
     SetDirty();
     if( m_aCellModifiedLink.IsSet())
         m_aCursorMovedHdlLink.Call( this );
@@ -880,6 +951,7 @@
         if( IsModified() )
             SaveModified();
 
+        m_bDataValid = true;
         m_apDataBrowserModel->removeDataSeries( nColIdx );
         RenewTable();
 	}
@@ -912,6 +984,7 @@
         if( IsModified() )
             SaveModified();
 
+        m_bDataValid = true;
         m_apDataBrowserModel->removeDataPointForAllSeries( nRowIdx );
 		RenewTable();
 	}
@@ -1081,6 +1154,12 @@
         ? GetRowCount() - 1
         : 0;
 
+    if( !m_bDataValid )
+    {
+        const_cast< DataBrowser* >( this )->ShowWarningBox();
+        return sal_False;
+    }
+
     return ( nRow != nBadRow ||
              nCol != nBadCol );
 }
@@ -1167,8 +1246,6 @@
                 ! m_spNumberFormatterWrapper->getSvNumberFormatter()->IsNumberFormat(
                     aText, nDummy, fDummy ))
             {
-                WarningBox( this, WinBits( WB_OK ),
-                            String( SchResId( STR_INVALID_NUMBER ))).Execute();
                 bChangeValid = sal_False;
             }
             else
@@ -1199,13 +1276,18 @@
     return bChangeValid;
 }
 
-void DataBrowser::EndEditing()
+bool DataBrowser::EndEditing()
 {
     if( IsModified())
         SaveModified();
 
     // apply changes made to series headers
     ::std::for_each( m_aSeriesHeaders.begin(), m_aSeriesHeaders.end(), impl::applyChangesFunctor());
+
+    if( m_bDataValid )
+        return true;
+    else
+        return ShowQueryBox();
 }
 
 sal_Int16 DataBrowser::GetFirstVisibleColumNumber() const
@@ -1276,10 +1358,17 @@
 {
     if( pEdit )
     {
-        DeactivateCell();
-        MakeFieldVisible( GetCurRow(), static_cast< sal_uInt16 >( pEdit->getStartColumn()), true /* bComplete */ );
-        ActivateCell();
-        m_aCursorMovedHdlLink.Call( this );
+        pEdit->SetShowWarningBox( !m_bDataValid );
+
+        if( !m_bDataValid )
+            GoToCell( 0, 0 );
+        else
+        {
+            //DeactivateCell();
+            MakeFieldVisible( GetCurRow(), static_cast< sal_uInt16 >( pEdit->getStartColumn()), true /* bComplete */ );
+            ActivateCell();
+            m_aCursorMovedHdlLink.Call( this );
+        }
     }
     return 0;
 }
--- chart2/source/controller/dialogs/DataBrowser.hxx	2007-09-18 16:53:14.000000000 +0200
+++ chart2/source/controller/dialogs/DataBrowser.hxx	2007-12-10 12:39:22.000000000 +0100
@@ -87,6 +87,7 @@
     virtual void CellModified();
 	virtual void ColumnResized( USHORT nColId );
     virtual void EndScroll();
+    virtual void MouseButtonDown( const BrowserMouseEvent& rEvt );
 
     void SetDirty();
 
@@ -149,6 +150,7 @@
 	void RemoveColumn();
 
     using BrowseBox::RemoveColumn;
+    using BrowseBox::MouseButtonDown;
 
 	void SwapRow();
 	void SwapColumn();
@@ -166,7 +168,7 @@
     void SetCellModifiedHdl( const Link& rLink );
 
     /// confirms all pending changes to be ready to be closed
-    void EndEditing();
+    bool EndEditing();
 
     // calls the protected inline-function BrowseBox::GetFirstVisibleColNumber()
     sal_Int16 GetFirstVisibleColumNumber() const;
@@ -177,6 +179,11 @@
 
     sal_uInt32 GetNumberFormatKey( sal_Int32 nRow, sal_uInt16 nCol ) const;
 
+    bool IsEnableItem();
+    bool IsDataValid();
+    void ShowWarningBox();
+    bool ShowQueryBox();
+
 private:
     ::com::sun::star::uno::Reference<
             ::com::sun::star::chart2::XChartDocument > m_xChartDoc;
@@ -192,6 +199,7 @@
     bool                m_bIsReadOnly;
     bool                m_bIsDirty;
     bool                m_bLiveUpdate;
+    bool                m_bDataValid;
 
     FormattedField      m_aNumberEditField;
     Edit                m_aTextEditField;
--- chart2/source/controller/dialogs/dlg_DataEditor.cxx	2007-05-22 19:32:56.000000000 +0200
+++ chart2/source/controller/dialogs/dlg_DataEditor.cxx	2007-12-10 12:39:22.000000000 +0100
@@ -204,14 +204,23 @@
     if( m_bReadOnly )
         return 0;
 
-    m_aTbxData.EnableItem( TBI_DATA_INSERT_ROW, m_apBrwData->MayInsertRow() );
-    m_aTbxData.EnableItem( TBI_DATA_INSERT_COL, m_apBrwData->MayInsertColumn() );
-    m_aTbxData.EnableItem( TBI_DATA_DELETE_ROW, m_apBrwData->MayDeleteRow() );
-    m_aTbxData.EnableItem( TBI_DATA_DELETE_COL, m_apBrwData->MayDeleteColumn() );
-
-    m_aTbxData.EnableItem( TBI_DATA_SWAP_COL,   m_apBrwData->MaySwapColumns() );
-    m_aTbxData.EnableItem( TBI_DATA_SWAP_ROW,   m_apBrwData->MaySwapRows() );
+    if( m_apBrwData->IsEnableItem() )
+    {
+        m_aTbxData.EnableItem( TBI_DATA_INSERT_ROW, m_apBrwData->MayInsertRow() );
+        m_aTbxData.EnableItem( TBI_DATA_INSERT_COL, m_apBrwData->MayInsertColumn() );
+        m_aTbxData.EnableItem( TBI_DATA_DELETE_ROW, m_apBrwData->MayDeleteRow() );
+        m_aTbxData.EnableItem( TBI_DATA_DELETE_COL, m_apBrwData->MayDeleteColumn() );
 
+        m_aTbxData.EnableItem( TBI_DATA_SWAP_COL,   m_apBrwData->MaySwapColumns() );
+        m_aTbxData.EnableItem( TBI_DATA_SWAP_ROW,   m_apBrwData->MaySwapRows() );
+    }
+    else
+    {
+        m_aTbxData.EnableItem( TBI_DATA_INSERT_ROW, FALSE );
+        m_aTbxData.EnableItem( TBI_DATA_INSERT_COL, FALSE );
+        m_aTbxData.EnableItem( TBI_DATA_SWAP_COL, FALSE );
+        m_aTbxData.EnableItem( TBI_DATA_SWAP_ROW, FALSE );
+    }
 //     m_aTbxData.EnableItem( TBI_DATA_SORT_COL,       m_apBrwData->MaySortColumn() );
 //     m_aTbxData.EnableItem( TBI_DATA_SORT_ROW,       m_apBrwData->MaySortRow() );
 //     m_aTbxData.EnableItem( TBI_DATA_SORT_TABLE_COL, m_apBrwData->MaySortColumn() );
@@ -353,13 +362,15 @@
 
 BOOL DataEditor::Close()
 {
-    ApplyChangesToModel();
-    return ModalDialog::Close();
+    if( ApplyChangesToModel() )
+        return ModalDialog::Close();
+    else
+        return TRUE;
 }
 
-void DataEditor::ApplyChangesToModel()
+bool DataEditor::ApplyChangesToModel()
 {
-    m_apBrwData->EndEditing();
+    return m_apBrwData->EndEditing();
 }
 
 // sets the correct toolbar icons depending on the current mode (e.g. high contrast)
--- chart2/source/controller/dialogs/dlg_InsertErrorBars.cxx	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/dlg_InsertErrorBars.cxx	2008-01-09 17:36:34.000000000 +0100
@@ -0,0 +1,141 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: dlg_InsertErrorBars.cxx,v $
+ *
+ *  $Revision: 1.1.2.2 $
+ *
+ *  last change: $Author: bm $ $Date: 2008/01/09 16:36:34 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+// MARKER(update_precomp.py): autogen include statement, do not remove
+#include "precompiled_chart2.hxx"
+
+#include "dlg_InsertErrorBars.hxx"
+#include "dlg_InsertErrorBars.hrc"
+#include "res_ErrorBar.hxx"
+#include "ResourceIds.hrc"
+#include "ResId.hxx"
+#include "Strings.hrc"
+#include "chartview/ExplicitValueProvider.hxx"
+#include "ChartModelHelper.hxx"
+#include "ObjectIdentifier.hxx"
+#include "DiagramHelper.hxx"
+#include "AxisHelper.hxx"
+
+#include <com/sun/star/chart2/XAxis.hpp>
+#include <com/sun/star/chart2/XDiagram.hpp>
+
+using ::rtl::OUString;
+using ::com::sun::star::uno::Reference;
+using namespace ::com::sun::star;
+using namespace ::com::sun::star::chart2;
+
+//.............................................................................
+namespace chart
+{
+//.............................................................................
+
+InsertErrorBarsDialog::InsertErrorBarsDialog(
+    Window* pParent, const SfxItemSet& rMyAttrs,
+    ErrorBarResources::tErrorBarType eType /* = ErrorBarResources::ERROR_BAR_Y */ ) :
+        ModalDialog( pParent, SchResId( DLG_DATA_YERRORBAR )),
+        rInAttrs( rMyAttrs ),
+        aBtnOK( this, SchResId( BTN_OK )),
+        aBtnCancel( this, SchResId( BTN_CANCEL )),
+        aBtnHelp( this, SchResId( BTN_HELP )),
+        m_apErrorBarResources( new ErrorBarResources( this, rInAttrs, eType ))
+{
+    FreeResource();
+    this->SetText( String( SchResId( STR_PAGE_YERROR_BARS )));
+}
+
+InsertErrorBarsDialog::~InsertErrorBarsDialog()
+{
+}
+
+void InsertErrorBarsDialog::Reset()
+{
+    m_apErrorBarResources->Reset(rInAttrs);
+}
+
+void InsertErrorBarsDialog::FillItemSet(SfxItemSet& rOutAttrs)
+{
+    m_apErrorBarResources->FillItemSet(rOutAttrs);
+}
+
+void InsertErrorBarsDialog::DataChanged( const DataChangedEvent& rDCEvt )
+{
+    ModalDialog::DataChanged( rDCEvt );
+
+    if ( (rDCEvt.GetType() == DATACHANGED_SETTINGS) && (rDCEvt.GetFlags() & SETTINGS_STYLE) )
+        m_apErrorBarResources->FillValueSets();
+}
+
+void InsertErrorBarsDialog::SetAxisMinorStepWidthForErrorBarDecimals( double fMinorStepWidth )
+{
+    m_apErrorBarResources->SetAxisMinorStepWidthForErrorBarDecimals( fMinorStepWidth );
+}
+
+//static
+double InsertErrorBarsDialog::getAxisMinorStepWidthForErrorBarDecimals(
+    const Reference< frame::XModel >& xChartModel,
+    const Reference< uno::XInterface >& xChartView,
+    const OUString& rSelectedObjectCID )
+{
+    double fStepWidth = 0.001;
+
+    ExplicitValueProvider* pExplicitValueProvider( ExplicitValueProvider::getExplicitValueProvider(xChartView) );
+    if( pExplicitValueProvider )
+    {
+        Reference< XAxis > xAxis;
+        Reference< XDiagram > xDiagram( ChartModelHelper::findDiagram( xChartModel ) );
+        Reference< XDataSeries > xSeries = ObjectIdentifier::getDataSeriesForCID( rSelectedObjectCID, xChartModel );
+        xAxis = DiagramHelper::getAttachedAxis( xSeries, xDiagram );
+        if(!xAxis.is())
+            xAxis = AxisHelper::getAxis( 1/*nDimensionIndex*/, true/*bMainAxis*/, xDiagram );
+        if(xAxis.is())
+        {
+            ExplicitScaleData aExplicitScale;
+            ExplicitIncrementData aExplicitIncrement;
+            pExplicitValueProvider->getExplicitValuesForAxis( xAxis,aExplicitScale, aExplicitIncrement );
+
+            fStepWidth = aExplicitIncrement.Distance;
+            if( aExplicitIncrement.SubIncrements.getLength()  && aExplicitIncrement.SubIncrements[0].IntervalCount>0 )
+                fStepWidth=fStepWidth/double(aExplicitIncrement.SubIncrements[0].IntervalCount);
+            else
+                fStepWidth/=10;
+        }
+    }
+
+    return fStepWidth;
+}
+
+//.............................................................................
+} //namespace chart
+//.............................................................................
--- chart2/source/controller/dialogs/dlg_InsertErrorBars.hrc	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/dlg_InsertErrorBars.hrc	2007-12-20 17:16:37.000000000 +0100
@@ -0,0 +1,39 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: dlg_InsertErrorBars.hrc,v $
+ *
+ *  $Revision: 1.1.2.1 $
+ *
+ *  last change: $Author: bm $ $Date: 2007/12/20 16:16:37 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#include "ResourceIds.hrc"
+
+#define BTN_OK 1
+#define BTN_CANCEL 1
+#define BTN_HELP 1
--- chart2/source/controller/dialogs/dlg_InsertErrorBars.src	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/dlg_InsertErrorBars.src	2007-12-20 17:16:37.000000000 +0100
@@ -0,0 +1,51 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: dlg_InsertErrorBars.src,v $
+ *
+ *  $Revision: 1.1.2.1 $
+ *
+ *  last change: $Author: bm $ $Date: 2007/12/20 16:16:37 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#include "dlg_InsertErrorBars.hrc"
+#include "SchSlotIds.hxx"
+#include "HelpIds.hrc"
+#include "CommonResources.hrc"
+#include "res_ErrorBar.hrc"
+
+ModalDialog DLG_DATA_YERRORBAR
+{
+// 	HelpID = SID_INSERT_STATISTICS ;
+	OutputSize = TRUE ;
+	SVLook = TRUE ;
+	Size = MAP_APPFONT ( 308 , 150 ) ;
+	Moveable = TRUE ;
+    BUTTONS_OK_CANCEL_HELP_STACKED(252)
+    RESOURCE_ERRORBARS( 252 - 6 )
+};
--- chart2/source/controller/dialogs/dlg_InsertStatistic.cxx	2007-07-25 10:33:18.000000000 +0200
+++ chart2/source/controller/dialogs/dlg_InsertStatistic.cxx	1970-01-01 01:00:00.000000000 +0100
@@ -1,146 +0,0 @@
-/*************************************************************************
- *
- *  OpenOffice.org - a multi-platform office productivity suite
- *
- *  $RCSfile: dlg_InsertStatistic.cxx,v $
- *
- *  $Revision: 1.12 $
- *
- *  last change: $Author: rt $ $Date: 2007/07/25 08:33:18 $
- *
- *  The Contents of this file are made available subject to
- *  the terms of GNU Lesser General Public License Version 2.1.
- *
- *
- *    GNU Lesser General Public License Version 2.1
- *    =============================================
- *    Copyright 2005 by Sun Microsystems, Inc.
- *    901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *    This library is free software; you can redistribute it and/or
- *    modify it under the terms of the GNU Lesser General Public
- *    License version 2.1, as published by the Free Software Foundation.
- *
- *    This library is distributed in the hope that it will be useful,
- *    but WITHOUT ANY WARRANTY; without even the implied warranty of
- *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *    Lesser General Public License for more details.
- *
- *    You should have received a copy of the GNU Lesser General Public
- *    License along with this library; if not, write to the Free Software
- *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *    MA  02111-1307  USA
- *
- ************************************************************************/
-
-// MARKER(update_precomp.py): autogen include statement, do not remove
-#include "precompiled_chart2.hxx"
-
-#include "dlg_InsertStatistic.hxx"
-#include "dlg_InsertStatistic.hrc"
-#include "res_ErrorBar.hxx"
-#include "ResId.hxx"
-#include "Strings.hrc"
-#include "chartview/ExplicitValueProvider.hxx"
-#include "ChartModelHelper.hxx"
-#include "ObjectIdentifier.hxx"
-#include "DiagramHelper.hxx"
-#include "AxisHelper.hxx"
-
-#ifndef _COM_SUN_STAR_CHART2_XAXIS_HPP_
-#include <com/sun/star/chart2/XAxis.hpp>
-#endif
-#ifndef _COM_SUN_STAR_CHART2_XDIAGRAM_HPP_
-#include <com/sun/star/chart2/XDiagram.hpp>
-#endif
-
-using namespace ::com::sun::star;
-using namespace ::com::sun::star::chart2;
-
-//.............................................................................
-namespace chart
-{
-//.............................................................................
-
-SchDataStatisticsDlg::SchDataStatisticsDlg(Window* pWindow, const SfxItemSet &rMyAttrs)
-    : ModalDialog(pWindow, SchResId(DLG_DATA_STAT)),
-    rInAttrs(rMyAttrs),
-    aBtnOK (this, SchResId (BTN_OK)),
-    aBtnCancel (this, SchResId (BTN_CANCEL)),
-    aBtnHelp (this, SchResId (BTN_HELP)),
-    m_apErrorBarResources( new ErrorBarResources(this,rInAttrs) )
-{
-    FreeResource();
-    this->SetText( String( SchResId( STR_PAGE_STATISTICS ) ) );
-}
-
-SchDataStatisticsDlg::~SchDataStatisticsDlg()
-{
-}
-
-void SchDataStatisticsDlg::Reset()
-{
-    m_apErrorBarResources->Reset(rInAttrs);
-}
-
-void SchDataStatisticsDlg::FillItemSet(SfxItemSet& rOutAttrs)
-{
-    m_apErrorBarResources->FillItemSet(rOutAttrs);
-}
-
-void SchDataStatisticsDlg::DataChanged( const DataChangedEvent& rDCEvt )
-{
-    ModalDialog::DataChanged( rDCEvt );
-
-    if ( (rDCEvt.GetType() == DATACHANGED_SETTINGS) && (rDCEvt.GetFlags() & SETTINGS_STYLE) )
-        m_apErrorBarResources->FillValueSets();
-}
-
-void SchDataStatisticsDlg::EnableTrendLine( bool bEnable )
-{
-    m_apErrorBarResources->EnableTrendLine( bEnable );
-    Reset();
-}
-
-void SchDataStatisticsDlg::SetAxisMinorStepWidthForErrorBarDecimals( double fMinorStepWidth )
-{
-    m_apErrorBarResources->SetAxisMinorStepWidthForErrorBarDecimals( fMinorStepWidth );
-}
-
-//static
-double SchDataStatisticsDlg::getAxisMinorStepWidthForErrorBarDecimals(
-            const uno::Reference< frame::XModel >& xChartModel,
-            const uno::Reference< uno::XInterface >& xChartView,
-            const ::rtl::OUString& rSelectedObjectCID )
-{
-    double fStepWidth = 0.001;
-
-    ExplicitValueProvider* pExplicitValueProvider( ExplicitValueProvider::getExplicitValueProvider(xChartView) );
-    if( pExplicitValueProvider )
-    {
-        uno::Reference< XAxis > xAxis;
-        uno::Reference< XDiagram > xDiagram( ChartModelHelper::findDiagram( xChartModel ) );
-        uno::Reference< XDataSeries > xSeries = ObjectIdentifier::getDataSeriesForCID( rSelectedObjectCID, xChartModel );
-        xAxis = DiagramHelper::getAttachedAxis( xSeries, xDiagram );
-        if(!xAxis.is())
-            xAxis = AxisHelper::getAxis( 1/*nDimensionIndex*/, true/*bMainAxis*/, xDiagram );
-        if(xAxis.is())
-        {
-            ExplicitScaleData aExplicitScale;
-            ExplicitIncrementData aExplicitIncrement;
-            pExplicitValueProvider->getExplicitValuesForAxis( xAxis,aExplicitScale, aExplicitIncrement );
-
-            fStepWidth = aExplicitIncrement.Distance;
-            if( aExplicitIncrement.SubIncrements.getLength()  && aExplicitIncrement.SubIncrements[0].IntervalCount>0 )
-                fStepWidth=fStepWidth/double(aExplicitIncrement.SubIncrements[0].IntervalCount);
-            else
-                fStepWidth/=10;
-        }
-    }
-
-    return fStepWidth;
-}
-
-//.............................................................................
-} //namespace chart
-//.............................................................................
--- chart2/source/controller/dialogs/dlg_InsertStatistic.hrc	2007-07-25 10:33:30.000000000 +0200
+++ chart2/source/controller/dialogs/dlg_InsertStatistic.hrc	1970-01-01 01:00:00.000000000 +0100
@@ -1,39 +0,0 @@
-/*************************************************************************
- *
- *  OpenOffice.org - a multi-platform office productivity suite
- *
- *  $RCSfile: dlg_InsertStatistic.hrc,v $
- *
- *  $Revision: 1.4 $
- *
- *  last change: $Author: rt $ $Date: 2007/07/25 08:33:30 $
- *
- *  The Contents of this file are made available subject to
- *  the terms of GNU Lesser General Public License Version 2.1.
- *
- *
- *    GNU Lesser General Public License Version 2.1
- *    =============================================
- *    Copyright 2005 by Sun Microsystems, Inc.
- *    901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *    This library is free software; you can redistribute it and/or
- *    modify it under the terms of the GNU Lesser General Public
- *    License version 2.1, as published by the Free Software Foundation.
- *
- *    This library is distributed in the hope that it will be useful,
- *    but WITHOUT ANY WARRANTY; without even the implied warranty of
- *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *    Lesser General Public License for more details.
- *
- *    You should have received a copy of the GNU Lesser General Public
- *    License along with this library; if not, write to the Free Software
- *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *    MA  02111-1307  USA
- *
- ************************************************************************/
-#include "ResourceIds.hrc"
-
-#define BTN_OK 1
-#define BTN_CANCEL 1
-#define BTN_HELP 1
--- chart2/source/controller/dialogs/dlg_InsertStatistic.src	2007-05-22 19:36:05.000000000 +0200
+++ chart2/source/controller/dialogs/dlg_InsertStatistic.src	1970-01-01 01:00:00.000000000 +0100
@@ -1,51 +0,0 @@
-/*************************************************************************
- *
- *  OpenOffice.org - a multi-platform office productivity suite
- *
- *  $RCSfile: dlg_InsertStatistic.src,v $
- *
- *  $Revision: 1.5 $
- *
- *  last change: $Author: vg $ $Date: 2007/05/22 17:36:05 $
- *
- *  The Contents of this file are made available subject to
- *  the terms of GNU Lesser General Public License Version 2.1.
- *
- *
- *    GNU Lesser General Public License Version 2.1
- *    =============================================
- *    Copyright 2005 by Sun Microsystems, Inc.
- *    901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *    This library is free software; you can redistribute it and/or
- *    modify it under the terms of the GNU Lesser General Public
- *    License version 2.1, as published by the Free Software Foundation.
- *
- *    This library is distributed in the hope that it will be useful,
- *    but WITHOUT ANY WARRANTY; without even the implied warranty of
- *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *    Lesser General Public License for more details.
- *
- *    You should have received a copy of the GNU Lesser General Public
- *    License along with this library; if not, write to the Free Software
- *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *    MA  02111-1307  USA
- *
- ************************************************************************/
-
-#include "dlg_InsertStatistic.hrc"
-#include "SchSlotIds.hxx"
-#include "HelpIds.hrc"
-#include "CommonResources.hrc"
-#include "res_Statistic.hrc"
-
-ModalDialog DLG_DATA_STAT
-{
-	HelpID = SID_INSERT_STATISTICS ;
-	OutputSize = TRUE ;
-	SVLook = TRUE ;
-	Size = MAP_APPFONT ( 308 , 150 ) ;
-	Moveable = TRUE ;
-    BUTTONS_OK_CANCEL_HELP_STACKED(252)
-    RESOURCE_STATISTIC( 6, 140 )
-};
--- chart2/source/controller/dialogs/dlg_InsertTitle.cxx	2007-05-22 19:36:23.000000000 +0200
+++ chart2/source/controller/dialogs/dlg_InsertTitle.cxx	2007-11-20 18:17:18.000000000 +0100
@@ -49,7 +49,7 @@
 
 SchTitleDlg::SchTitleDlg(Window* pWindow, const TitleDialogData& rInput )
     : ModalDialog(pWindow, SchResId(DLG_TITLE))
-    , m_apTitleResources( new TitleResources(this) )
+    , m_apTitleResources( new TitleResources(this,true) )
 	, aBtnOK(this, SchResId(BTN_OK))
 	, aBtnCancel(this, SchResId(BTN_CANCEL))
 	, aBtnHelp(this, SchResId(BTN_HELP))
--- chart2/source/controller/dialogs/dlg_InsertTitle.src	2007-08-17 17:05:46.000000000 +0200
+++ chart2/source/controller/dialogs/dlg_InsertTitle.src	2008-01-14 16:50:45.000000000 +0100
@@ -43,9 +43,8 @@
 	HelpID = SID_INSERT_TITLE ;
 	OutputSize = TRUE ;
 	SVLook = TRUE ;
-    Size = MAP_APPFONT ( 240 , 88 ) ;
+    Size = MAP_APPFONT ( 220 , 156 ) ;
 	Moveable = TRUE ;
-	 // Closeable = TRUE;	// Dialog hat Cancel und/oder OK-Button ! (KH)
-    BUTTONS_OK_CANCEL_HELP_STACKED(184)
-	TITLES(6,6,100,30)
+	BUTTONS_OK_CANCEL_HELP_STACKED(164)
+	TITLES(6,6,152,6,10)
 };
--- chart2/source/controller/dialogs/dlg_InsertTrendline.cxx	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/dlg_InsertTrendline.cxx	2008-01-15 09:19:54.000000000 +0100
@@ -0,0 +1,131 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: dlg_InsertTrendline.cxx,v $
+ *
+ *  $Revision: 1.1.2.4 $
+ *
+ *  last change: $Author: bm $ $Date: 2008/01/15 08:19:54 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+// MARKER(update_precomp.py): autogen include statement, do not remove
+#include "precompiled_chart2.hxx"
+
+#include "dlg_InsertTrendline.hxx"
+#include "dlg_InsertTrendline.hrc"
+#include "res_Trendline.hxx"
+#include "ResourceIds.hrc"
+#include "ResId.hxx"
+#include "Strings.hrc"
+#include "chartview/ExplicitValueProvider.hxx"
+#include "ChartModelHelper.hxx"
+#include "ObjectIdentifier.hxx"
+#include "DiagramHelper.hxx"
+#include "AxisHelper.hxx"
+
+#ifndef _COM_SUN_STAR_CHART2_XAXIS_HPP_
+#include <com/sun/star/chart2/XAxis.hpp>
+#endif
+#ifndef _COM_SUN_STAR_CHART2_XDIAGRAM_HPP_
+#include <com/sun/star/chart2/XDiagram.hpp>
+#endif
+
+#include <svtools/controldims.hrc>
+
+using namespace ::com::sun::star;
+using namespace ::com::sun::star::chart2;
+
+namespace
+{
+void lcl_SetControlXPos( Control & rControl, long nPosPixel )
+{
+    Point aPos( rControl.GetPosPixel());
+    aPos.setX( nPosPixel );
+    rControl.SetPosPixel( aPos );
+}
+} // anonymous namespace
+
+//.............................................................................
+namespace chart
+{
+//.............................................................................
+
+InsertTrendlineDialog::InsertTrendlineDialog( Window* pParent, const SfxItemSet& rMyAttrs ) :
+        ModalDialog( pParent, SchResId( DLG_DATA_TRENDLINE )),
+        rInAttrs( rMyAttrs ),
+        aBtnOK( this, SchResId( BTN_OK )),
+        aBtnCancel( this, SchResId( BTN_CANCEL )),
+        aBtnHelp( this, SchResId( BTN_HELP )),
+        m_apTrendlineResources( new TrendlineResources( this, rInAttrs, true ))
+{
+    FreeResource();
+    this->SetText( String( SchResId( STR_OBJECT_CURVES )));
+}
+
+InsertTrendlineDialog::~InsertTrendlineDialog()
+{
+}
+
+void InsertTrendlineDialog::adjustSize()
+{
+    long nControlsRightEdge = m_apTrendlineResources->adjustControlSizes();
+    long nButtonXPos = nControlsRightEdge +
+        LogicToPixel( Size( RSC_SP_CTRL_X, 10 ), MapMode( MAP_APPFONT )).getWidth();
+    lcl_SetControlXPos( aBtnOK, nButtonXPos );
+    lcl_SetControlXPos( aBtnCancel, nButtonXPos );
+    lcl_SetControlXPos( aBtnHelp, nButtonXPos );
+
+    Size aDialogSize( GetSizePixel());
+    aDialogSize.setWidth(
+        nControlsRightEdge +
+        LogicToPixel( Size( RSC_SP_CTRL_X + RSC_CD_PUSHBUTTON_WIDTH + RSC_SP_DLG_INNERBORDER_RIGHT, 0 ),
+                      MapMode( MAP_APPFONT )).getWidth());
+    SetSizePixel( aDialogSize );
+}
+
+void InsertTrendlineDialog::Reset()
+{
+    m_apTrendlineResources->Reset(rInAttrs);
+}
+
+void InsertTrendlineDialog::FillItemSet(SfxItemSet& rOutAttrs)
+{
+    m_apTrendlineResources->FillItemSet(rOutAttrs);
+}
+
+void InsertTrendlineDialog::DataChanged( const DataChangedEvent& rDCEvt )
+{
+    ModalDialog::DataChanged( rDCEvt );
+
+    if ( (rDCEvt.GetType() == DATACHANGED_SETTINGS) && (rDCEvt.GetFlags() & SETTINGS_STYLE) )
+        m_apTrendlineResources->FillValueSets();
+}
+
+//.............................................................................
+} //namespace chart
+//.............................................................................
--- chart2/source/controller/dialogs/dlg_InsertTrendline.hrc	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/dlg_InsertTrendline.hrc	2007-12-20 17:16:55.000000000 +0100
@@ -0,0 +1,39 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: dlg_InsertTrendline.hrc,v $
+ *
+ *  $Revision: 1.1.2.1 $
+ *
+ *  last change: $Author: bm $ $Date: 2007/12/20 16:16:55 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#include "ResourceIds.hrc"
+
+#define BTN_OK 1
+#define BTN_CANCEL 1
+#define BTN_HELP 1
--- chart2/source/controller/dialogs/dlg_InsertTrendline.src	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/dlg_InsertTrendline.src	2008-01-14 13:15:55.000000000 +0100
@@ -0,0 +1,56 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: dlg_InsertTrendline.src,v $
+ *
+ *  $Revision: 1.1.2.3 $
+ *
+ *  last change: $Author: bm $ $Date: 2008/01/14 12:15:55 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#include "dlg_InsertTrendline.hrc"
+#include "SchSlotIds.hxx"
+#include "HelpIds.hrc"
+#include "CommonResources.hrc"
+#include "res_Trendline.hrc"
+
+// is only an initial size, will be calculated to contain all controls
+#define DLG_DATA_TRENDLINE_RES_WIDTH   130
+#define DLG_DATA_TRENDLINE_ADD_TO_RES   62
+
+ModalDialog DLG_DATA_TRENDLINE
+{
+	HelpID = SID_INSERT_STATISTICS ;
+	OutputSize = TRUE ;
+	SVLook = TRUE ;
+	Size = MAP_APPFONT( DLG_DATA_TRENDLINE_RES_WIDTH + DLG_DATA_TRENDLINE_ADD_TO_RES, 172 );
+	Moveable = TRUE ;
+    BUTTONS_OK_CANCEL_HELP_STACKED( DLG_DATA_TRENDLINE_RES_WIDTH + DLG_DATA_TRENDLINE_ADD_TO_RES )
+    RESOURCE_TRENDLINE( DLG_DATA_TRENDLINE_RES_WIDTH, 22 )
+};
+
--- chart2/source/controller/dialogs/dlg_ObjectProperties.cxx	2007-11-23 12:46:53.000000000 +0100
+++ chart2/source/controller/dialogs/dlg_ObjectProperties.cxx	2008-01-15 20:18:28.000000000 +0100
@@ -51,10 +51,11 @@
 #include "tp_LegendPosition.hxx"
 #include "tp_PointGeometry.hxx"
 #include "tp_Scale.hxx"
-#include "tp_SeriesStatistic.hxx"
+#include "tp_ErrorBars.hxx"
+#include "tp_Trendline.hxx"
 #include "tp_SeriesToAxis.hxx"
 #include "tp_TitleRotation.hxx"
-#include "tp_RegressionOptions.hxx"
+#include "tp_PolarOptions.hxx"
 #include "ResId.hxx"
 #include "ViewElementListProvider.hxx"
 #include "macros.hxx"
@@ -139,6 +140,7 @@
         , m_bHasScaleProperties(false)
         , m_bCanAxisLabelsBeStaggered(false)
         , m_bHasNumberProperties(false)
+        , m_bProvidesStartingAngle(false)
 {
     rtl::OUString aParticleID = ObjectIdentifier::getParticleID( m_aObjectCID );
     m_bAffectsMultipleObjects = aParticleID.equals(C2U("ALLELEMENTS"));
@@ -170,13 +172,14 @@
         m_bHasGeometryProperties = ChartTypeHelper::isSupportingGeometryProperties( xChartType, nDimensionCount );
         m_bHasAreaProperties     = ChartTypeHelper::isSupportingAreaProperties( xChartType, nDimensionCount );
         m_bHasSymbolProperties   = ChartTypeHelper::isSupportingSymbolProperties( xChartType, nDimensionCount );
-
+        
         if( bHasSeriesProperties )
         {
             m_bHasStatisticProperties =  ChartTypeHelper::isSupportingStatisticProperties( xChartType, nDimensionCount );
             m_bHasRegressionProperties = ChartTypeHelper::isSupportingRegressionProperties( xChartType, nDimensionCount );
             m_bProvidesSecondaryYAxis =  ChartTypeHelper::isSupportingSecondaryAxis( xChartType, nDimensionCount, 1 );
             m_bProvidesOverlapAndGapWidth =  ChartTypeHelper::isSupportingOverlapAndGapWidthProperties( xChartType, nDimensionCount );
+            m_bProvidesStartingAngle = ChartTypeHelper::isSupportingStartingAngle( xChartType );
         }
     }
     m_bHasLineProperties     = true; //@todo ask object
@@ -266,6 +269,10 @@
 {
     return m_bHasNumberProperties;
 }
+bool ObjectPropertiesDialogParameter::ProvidesStartingAngle() const
+{
+    return m_bProvidesStartingAngle;
+}
 
 //const USHORT nNoArrowDlg          = 1100;
 const USHORT nNoArrowNoShadowDlg    = 1101;
@@ -302,9 +309,10 @@
     , m_pSymbolShapeProperties(NULL)
     , m_pAutoSymbolGraphic(NULL)
     , m_fAxisMinorStepWidthForErrorBarDecimals(0.1)
+    , m_bOKPressed(false)
 {
     FreeResource();
-    
+
     NumberFormatterWrapper aNumberFormatterWrapper( xNumberFormatsSupplier );
     m_pNumberFormatter = aNumberFormatterWrapper.getSvNumberFormatter();
 
@@ -344,11 +352,13 @@
             AddTabPage(RID_SVXPAGE_CHAR_EFFECTS, String(SchResId(STR_PAGE_FONT_EFFECTS)));
             AddTabPage(TP_DATA_DESCR, String(SchResId(STR_OBJECT_DATALABELS)), DataLabelsTabPage::Create, NULL);
             if( m_pParameter->HasStatisticProperties() )
-                AddTabPage(TP_STAT, String(SchResId(STR_PAGE_STATISTICS)), SchStatisticTabPage::Create, NULL);
+                AddTabPage(TP_YERRORBAR, String(SchResId(STR_PAGE_YERROR_BARS)), ErrorBarsTabPage::Create, NULL);
             if( m_pParameter->HasGeometryProperties() )
                 AddTabPage(TP_LAYOUT, String(SchResId(STR_PAGE_LAYOUT)),SchLayoutTabPage::Create, NULL);
             if( m_pParameter->ProvidesSecondaryYAxis() || m_pParameter->ProvidesOverlapAndGapWidth() )
                 AddTabPage(TP_OPTIONS, String(SchResId(STR_PAGE_OPTIONS)),SchOptionTabPage::Create, NULL);
+            if( m_pParameter->ProvidesStartingAngle())
+                AddTabPage(TP_POLAROPTIONS, String(SchResId(STR_PAGE_OPTIONS)),PolarOptionsTabPage::Create, NULL);
             break;
 
         case OBJECTTYPE_AXIS:
@@ -376,8 +386,9 @@
             break;
 
         case OBJECTTYPE_DATA_CURVE:
+            OSL_ASSERT( m_pParameter->HasRegressionProperties());
+            AddTabPage(TP_TRENDLINE, String(SchResId(STR_PAGE_TRENDLINE_TYPE)), TrendlineTabPage::Create, NULL);
             AddTabPage(RID_SVXPAGE_LINE, String(SchResId(STR_PAGE_LINE)));
-            AddTabPage(TP_REGRESSION_OPTIONS, String(SchResId(STR_PAGE_REGRESSION_OPTIONS)), RegressionOptionsTabPage::Create,  NULL);
             break;
 
         case OBJECTTYPE_DATA_STOCK_LOSS:
@@ -405,6 +416,12 @@
             AddTabPage(RID_SVXPAGE_NUMBERFORMAT, String(SchResId(STR_PAGE_NUMBERS)));
             break;
     }
+
+    // used to find out if user left the dialog with OK. When OK is pressed but
+    // no changes were done, Cancel is returned by the SfxTabDialog. See method
+    // DialogWasClosedWithOK.
+    m_aOriginalOKClickHdl = GetOKButton().GetClickHdl();
+    GetOKButton().SetClickHdl( LINK( this, SchAttribTabDlg, OKPressed ));
 }
 
 SchAttribTabDlg::~SchAttribTabDlg()
@@ -510,18 +527,31 @@
 			rPage.PageCreated(aSet);
             break;
 
-        case TP_STAT:
-            static_cast< SchStatisticTabPage & >( rPage ).EnableTrendLine(
-                m_pParameter->HasRegressionProperties() );
-            static_cast< SchStatisticTabPage & >( rPage ).SetAxisMinorStepWidthForErrorBarDecimals(
-                m_fAxisMinorStepWidthForErrorBarDecimals );
-            break;
-
-        case TP_REGRESSION_OPTIONS:
+        case TP_YERRORBAR:
+        {
+            ErrorBarsTabPage * pTabPage = dynamic_cast< ErrorBarsTabPage * >( &rPage );
+            OSL_ASSERT( pTabPage );
+            if( pTabPage )
+            {
+                pTabPage->SetAxisMinorStepWidthForErrorBarDecimals( m_fAxisMinorStepWidthForErrorBarDecimals );
+                pTabPage->SetErrorBarType( ErrorBarResources::ERROR_BAR_Y );
+            }
             break;
+        }
     }
 }
 
+IMPL_LINK( SchAttribTabDlg, OKPressed, void * , EMPTYARG )
+{
+    m_bOKPressed = true;
+    return m_aOriginalOKClickHdl.Call( this );
+}
+
+bool SchAttribTabDlg::DialogWasClosedWithOK() const
+{
+    return m_bOKPressed;
+}
+
 //.............................................................................
 } //namespace chart
 //.............................................................................
--- chart2/source/controller/dialogs/hidother.src	2007-11-23 12:47:11.000000000 +0100
+++ chart2/source/controller/dialogs/hidother.src	2008-01-14 18:37:01.000000000 +0100
@@ -52,7 +52,6 @@
 hidspecial HID_SCH_CB_SECONDARY_ZGRID {HelpId= HID_SCH_CB_SECONDARY_ZGRID; };
 
 hidspecial HID_SCH_CT_INDICATE {HelpId= HID_SCH_CT_INDICATE; };
-hidspecial HID_SCH_CT_REGRESS {HelpId= HID_SCH_CT_REGRESS; };
 
 hidspecial HID_SCH_STATISTIK_MEANVALUE {HelpId= HID_SCH_STATISTIK_MEANVALUE; };
 hidspecial HID_SCH_STATISTIK_NO_ERROR {HelpId= HID_SCH_STATISTIK_NO_ERROR; };
@@ -87,9 +86,21 @@
 hidspecial HID_SCH_TITLE_X {HelpId= HID_SCH_TITLE_X; };
 hidspecial HID_SCH_TITLE_Y {HelpId= HID_SCH_TITLE_Y; };
 hidspecial HID_SCH_TITLE_Z {HelpId= HID_SCH_TITLE_Z; };
+hidspecial HID_SCH_TITLE_SECONDARY_X {HelpId= HID_SCH_TITLE_SECONDARY_X; };
+hidspecial HID_SCH_TITLE_SECONDARY_Y {HelpId= HID_SCH_TITLE_SECONDARY_Y; };
 
 hidspecial HID_SCH_NUM_OF_LINES {HelpId= HID_SCH_NUM_OF_LINES; };
 
 hidspecial HID_SCH_WIZARD_ROADMAP {HelpId= HID_SCH_WIZARD_ROADMAP; };
 hidspecial HID_SCH_WIN_DOCUMENT {HelpId= HID_SCH_WIN_DOCUMENT; };
 hidspecial HID_SCH_DATA_SERIES_LABEL {HelpId= HID_SCH_DATA_SERIES_LABEL; };
+
+hidspecial HID_SCH_STARTING_ANGLE_DIAL {HelpId= HID_SCH_STARTING_ANGLE_DIAL; };
+
+hidspecial HID_SCH_TRENDLINE_RB_NONE {HelpId= HID_SCH_TRENDLINE_RB_NONE; };
+hidspecial HID_SCH_TRENDLINE_RB_LINEAR {HelpId= HID_SCH_TRENDLINE_RB_LINEAR; };
+hidspecial HID_SCH_TRENDLINE_RB_LOGARITHMIC {HelpId= HID_SCH_TRENDLINE_RB_LOGARITHMIC; };
+hidspecial HID_SCH_TRENDLINE_RB_EXPONENTIAL {HelpId= HID_SCH_TRENDLINE_RB_EXPONENTIAL; };
+hidspecial HID_SCH_TRENDLINE_RB_POWER {HelpId= HID_SCH_TRENDLINE_RB_POWER; };
+hidspecial HID_SCH_TRENDLINE_SHOW_EQUATION {HelpId= HID_SCH_TRENDLINE_SHOW_EQUATION; };
+hidspecial HID_SCH_TRENDLINE_SHOW_R_SQUARED {HelpId= HID_SCH_TRENDLINE_SHOW_R_SQUARED; };
--- chart2/source/controller/dialogs/makefile.mk	2007-11-23 12:47:27.000000000 +0100
+++ chart2/source/controller/dialogs/makefile.mk	2008-01-14 17:06:23.000000000 +0100
@@ -65,6 +65,7 @@
                 $(SLO)$/res_Titles.obj \
                 $(SLO)$/res_TextSeparator.obj \
                 $(SLO)$/res_ErrorBar.obj \
+                $(SLO)$/res_Trendline.obj \
                 $(SLO)$/res_BarGeometry.obj \
                 $(SLO)$/res_LegendPosition.obj \
                 $(SLO)$/res_DataLabel.obj \
@@ -80,12 +81,14 @@
                 $(SLO)$/tp_LegendPosition.obj \
                 $(SLO)$/tp_PointGeometry.obj \
                 $(SLO)$/tp_Scale.obj \
-                $(SLO)$/tp_SeriesStatistic.obj \
+                $(SLO)$/tp_Trendline.obj \
+                $(SLO)$/tp_ErrorBars.obj \
                 $(SLO)$/tp_SeriesToAxis.obj \
                 $(SLO)$/tp_TitleRotation.obj \
                 $(SLO)$/tp_3D_SceneGeometry.obj \
                 $(SLO)$/tp_3D_SceneAppearance.obj \
                 $(SLO)$/tp_3D_SceneIllumination.obj \
+                $(SLO)$/tp_PolarOptions.obj \
                 $(SLO)$/dlg_ObjectProperties.obj \
                 $(SLO)$/dlg_DataEditor.obj \
                 $(SLO)$/dlg_DataSource.obj \
@@ -93,7 +96,8 @@
                 $(SLO)$/dlg_InsertAxis_Grid.obj \
                 $(SLO)$/dlg_InsertDataLabel.obj \
                 $(SLO)$/dlg_InsertLegend.obj \
-                $(SLO)$/dlg_InsertStatistic.obj \
+                $(SLO)$/dlg_InsertTrendline.obj \
+                $(SLO)$/dlg_InsertErrorBars.obj \
                 $(SLO)$/dlg_InsertTitle.obj \
                 $(SLO)$/dlg_CreationWizard.obj \
                 $(SLO)$/dlg_CreationWizard_UNO.obj \
@@ -102,8 +106,7 @@
                 $(SLO)$/RangeSelectionButton.obj \
                 $(SLO)$/RangeSelectionHelper.obj \
                 $(SLO)$/RangeSelectionListener.obj \
-                $(SLO)$/RangeEdit.obj \
-                $(SLO)$/tp_RegressionOptions.obj
+                $(SLO)$/RangeEdit.obj
 
 # --- Resources ---------------------------------------------------------------
 
@@ -124,12 +127,14 @@
                 tp_LegendPosition.src \
                 tp_PointGeometry.src \
                 tp_Scale.src \
-                tp_SeriesStatistic.src \
+                tp_Trendline.src \
+                tp_ErrorBars.src \
                 tp_SeriesToAxis.src \
                 tp_TitleRotation.src \
                 tp_3D_SceneGeometry.src \
                 tp_3D_SceneAppearance.src \
                 tp_3D_SceneIllumination.src \
+                tp_PolarOptions.src \
                 dlg_ObjectProperties.src \
                 Strings_Statistic.src \
                 Strings_Scale.src \
@@ -144,20 +149,21 @@
 				dlg_InsertAxis_Grid.src \
                 dlg_InsertDataLabel.src \
                 dlg_InsertLegend.src \
-                dlg_InsertStatistic.src \
+                dlg_InsertTrendline.src \
+                dlg_InsertErrorBars.src \
                 dlg_InsertTitle.src \
                 dlg_ChartType.src \
-                dlg_CreationWizard.src \
-				tp_RegressionOptions.src
+                dlg_CreationWizard.src
 
 SRS1NAME=$(TARGET)
 
 # --- Targets -----------------------------------------------------------------
-LOCALIZE_ME=res_DataLabel_tmpl.hrc res_LegendPosition_tmpl.hrc res_Statistic_tmpl.hrc res_Titlesx_tmpl.hrc res_SecondaryAxisCheckBoxes_tmpl.hrc 
+LOCALIZE_ME=res_DataLabel_tmpl.hrc res_LegendPosition_tmpl.hrc res_Trendline_tmpl.hrc res_ErrorBar_tmpl.hrc res_Titlesx_tmpl.hrc res_SecondaryAxisCheckBoxes_tmpl.hrc 
 .INCLUDE: target.mk
 $(SRS)$/chcdialogs.srs: $(INCCOM)$/res_DataLabel.hrc
 $(SRS)$/chcdialogs.srs: $(INCCOM)$/res_LegendPosition.hrc
-$(SRS)$/chcdialogs.srs: $(INCCOM)$/res_Statistic.hrc
+$(SRS)$/chcdialogs.srs: $(INCCOM)$/res_Trendline.hrc
+$(SRS)$/chcdialogs.srs: $(INCCOM)$/res_ErrorBar.hrc
 $(SRS)$/chcdialogs.srs: $(INCCOM)$/res_Titlesx.hrc
 $(SRS)$/chcdialogs.srs: $(INCCOM)$/res_SecondaryAxisCheckBoxes.hrc
 
@@ -175,19 +181,20 @@
         dlg_InsertAxis_Grid.hrc \
         dlg_InsertDataLabel.hrc \
         dlg_InsertLegend.hrc \
-        dlg_InsertStatistic.hrc \
+        dlg_InsertTrendline.hrc \
+        dlg_InsertErrorBars.hrc \
         dlg_InsertTitle.hrc \
         dlg_View3D.hrc \
         res_Titles.hrc \
         tp_3D_SceneAppearance.hrc \
         tp_3D_SceneGeometry.hrc \
         tp_3D_SceneIllumination.hrc \
+        tp_PolarOptions.hrc \
         tp_ChartType.hrc \
         tp_DataSource.hrc \
         tp_Location.hrc \
         tp_RangeChooser.hrc \
-        tp_Wizard_TitlesAndObjects.hrc \
-		tp_RegressionOptions.hrc
+        tp_Wizard_TitlesAndObjects.hrc
 
 #        res_DataLabel.hrc \
 #        res_LegendPosition.hrc \
--- chart2/source/controller/dialogs/ObjectNameProvider.cxx	2007-11-23 12:45:30.000000000 +0100
+++ chart2/source/controller/dialogs/ObjectNameProvider.cxx	2007-12-18 14:45:49.000000000 +0100
@@ -389,6 +389,12 @@
                 case TitleHelper::Z_AXIS_TITLE:
                     aRet=String(SchResId(STR_OBJECT_TITLE_Z_AXIS));
                     break;
+                case TitleHelper::SECONDARY_X_AXIS_TITLE:
+                    aRet=String(SchResId(STR_OBJECT_TITLE_SECONDARY_X_AXIS));
+                    break;
+                case TitleHelper::SECONDARY_Y_AXIS_TITLE:
+                    aRet=String(SchResId(STR_OBJECT_TITLE_SECONDARY_Y_AXIS));
+                    break;
                 default:
                     DBG_ERROR("unknown title type");
                     break;
--- chart2/source/controller/dialogs/res_ErrorBar.cxx	2007-07-25 10:34:49.000000000 +0200
+++ chart2/source/controller/dialogs/res_ErrorBar.cxx	2008-01-09 12:54:17.000000000 +0100
@@ -58,23 +58,13 @@
 
 enum StatIndicator
 {
-    INDICATE_NONE,
     INDICATE_BOTH,
     INDICATE_UP,
     INDICATE_DOWN
 };
 
-enum StatTrendLine
-{
-    TRENDLINE_NONE,
-    TRENDLINE_LINE,
-    TRENDLINE_LOG,
-    TRENDLINE_EXP,
-    TRENDLINE_POW
-};
-
-ErrorBarResources::ErrorBarResources( Window* pWindow, const SfxItemSet& rInAttrs )
-    : m_aCbxAverage (pWindow, SchResId (CBX_AVERAGE)),
+ErrorBarResources::ErrorBarResources( Window* pWindow, const SfxItemSet& rInAttrs,
+                                      tErrorBarType eType /* = ERROR_BAR_Y */ ) :
     m_aFlErrorCategory (pWindow, SchResId (FL_ERROR)),
     m_aRbtNone (pWindow, SchResId (RBT_NONE)),
     m_aRbtVariant (pWindow, SchResId (RBT_VARIANT)),
@@ -82,25 +72,22 @@
     m_aRbtPercent (pWindow, SchResId (RBT_PERCENT)),
     m_aRbtBigError (pWindow, SchResId (RBT_BIGERROR)),
     m_aRbtConst (pWindow, SchResId (RBT_CONST)),
+//     m_aRbtRange (pWindow, SchResId (RBT_RANGE)),
     m_aMtrFldPercent (pWindow, SchResId (MTR_FLD_PERCENT)),
     m_aMtrFldBigError (pWindow, SchResId (MTR_FLD_BIGERROR)),
     m_aFTConstPlus (pWindow, SchResId (FT_PERCENT_PLUS)),
     m_aMtrFldConstPlus (pWindow, SchResId (MTR_FLD_PLUS)),
     m_aFTConstMinus (pWindow, SchResId (FT_PERCENT_MINUS)),
     m_aMtrFldConstMinus (pWindow, SchResId (MTR_FLD_MINUS)),
-    m_aFTIndicate (pWindow, SchResId (FT_INDICATE)),
+    m_aFLIndicate (pWindow, SchResId (FL_INDICATE)),
     m_aIndicatorSet (pWindow, SchResId (CT_INDICATE)),
-    m_aFTTrendLine (pWindow, SchResId (FT_REGRESS)),
-    m_aTrendLineSet (pWindow, SchResId (CT_REGRESS)),
-    m_bEnableTrendLine( false ),
     m_eErrorKind( CHERROR_NONE ),
     m_eIndicate( CHINDICATE_BOTH ),
-    m_eTrendLineType( CHREGRESS_NONE ),
     m_bErrorKindUnique( true ),
     m_bIndicatorUnique( true ),
-    m_bTrendLineUnique( true ),
     m_bPlusUnique( true ),
-    m_bMinusUnique( true )
+    m_bMinusUnique( true ),
+    m_eErrorBarType( eType )
 {
     m_aRbtNone.SetClickHdl(LINK(this, ErrorBarResources, RBtnClick));
     m_aRbtVariant.SetClickHdl(LINK(this, ErrorBarResources, RBtnClick));
@@ -117,12 +104,6 @@
     m_aIndicatorSet.SetExtraSpacing(2);
     m_aIndicatorSet.SetSelectHdl(LINK(this, ErrorBarResources, SelectIndicate));
 
-    m_aTrendLineSet.SetStyle (m_aIndicatorSet.GetStyle () /*| WB_ITEMBORDER | WB_DOUBLEBORDER*/ | WB_NAMEFIELD /*| WB_VSCROLL*/ );
-    m_aTrendLineSet.SetColCount(5);
-    m_aTrendLineSet.SetLineCount(1);
-    m_aTrendLineSet.SetExtraSpacing(2);
-    m_aTrendLineSet.SetSelectHdl(LINK(this, ErrorBarResources, SelectTrendLine));
-
     Reset( rInAttrs );
 }
 
@@ -130,9 +111,13 @@
 {
 }
 
-void ErrorBarResources::EnableTrendLine( bool bEnable )
+void ErrorBarResources::SetErrorBarType( tErrorBarType eNewType )
 {
-    m_bEnableTrendLine = bEnable;
+    if( m_eErrorBarType != eNewType )
+    {
+        m_eErrorBarType = eNewType;
+        FillValueSets();
+    }
 }
 
 void ErrorBarResources::SetAxisMinorStepWidthForErrorBarDecimals( double fMinorStepWidth )
@@ -158,8 +143,9 @@
 	m_aMtrFldConstMinus.Enable (pBtn == &m_aRbtConst);
     m_aFTConstPlus.Enable (pBtn == &m_aRbtConst);
     m_aFTConstMinus.Enable (pBtn == &m_aRbtConst);
+
     m_aIndicatorSet.Show (pBtn != &m_aRbtNone);
-    m_aFTIndicate.Show (pBtn != &m_aRbtNone);
+//     m_aFLIndicate.Show (pBtn != &m_aRbtNone);
 
 	if (pBtn == &m_aRbtPercent) m_eErrorKind = CHERROR_PERCENT;
     else if (pBtn == &m_aRbtBigError) m_eErrorKind = CHERROR_BIGERROR;
@@ -168,8 +154,6 @@
     else if (pBtn == &m_aRbtVariant) m_eErrorKind = CHERROR_VARIANT;
     else if (pBtn == &m_aRbtSigma) m_eErrorKind = CHERROR_SIGMA;
 
-    m_bErrorKindUnique = true;
-
     if( pBtn != &m_aRbtNone )
     {
         if( m_eIndicate == CHINDICATE_NONE )
@@ -179,7 +163,9 @@
             m_aIndicatorSet.SelectItem(INDICATE_BOTH + 1);
         }
     }
-    
+
+    m_bErrorKindUnique = true;
+
 	return 0;
 }
 
@@ -189,9 +175,9 @@
 
 	switch (eSelection - 1)
 	{
-		case INDICATE_NONE :
-			m_eIndicate = CHINDICATE_NONE;
-			break;
+// 		case INDICATE_NONE :
+// 			m_eIndicate = CHINDICATE_NONE;
+// 			break;
 
 		case INDICATE_BOTH :
 			m_eIndicate = CHINDICATE_BOTH;
@@ -207,70 +193,20 @@
 	}
 
 	m_aIndicatorSet.SelectItem( static_cast< sal_uInt16 >(eSelection));
-	m_aIndicatorSet.Show ();
-    m_aFTIndicate.Show();
+	m_aIndicatorSet.Show();
+//     m_aFLIndicate.Show();
 
     m_bIndicatorUnique = true;
 
 	return 0;
 }
 
-IMPL_LINK( ErrorBarResources, SelectTrendLine, void *, EMPTYARG )
-{
-	StatTrendLine eSelection = (StatTrendLine) m_aTrendLineSet.GetSelectItemId();
-
-    switch (eSelection - 1)
-	{
-		case TRENDLINE_NONE :
-			m_eTrendLineType = CHREGRESS_NONE;
-			break;
-
-		case TRENDLINE_LINE :
-			m_eTrendLineType = CHREGRESS_LINEAR;
-			break;
-
-		case TRENDLINE_LOG :
-			m_eTrendLineType = CHREGRESS_LOG;
-			break;
-
-		case TRENDLINE_EXP :
-			m_eTrendLineType = CHREGRESS_EXP;
-			break;
-
-		case TRENDLINE_POW :
-			m_eTrendLineType = CHREGRESS_POWER;
-			break;
-	}
-
-	m_aTrendLineSet.SelectItem( static_cast< sal_uInt16 >(eSelection));
-	m_aTrendLineSet.Show ();
-    m_aFTTrendLine.Show ();
-    m_bTrendLineUnique = true;
-
-    return 0;
-}
-
 void ErrorBarResources::Reset(const SfxItemSet& rInAttrs)
 {
 	const SfxPoolItem *pPoolItem = NULL;
     SfxItemState aState = SFX_ITEM_UNKNOWN;
 
-	aState = rInAttrs.GetItemState( SCHATTR_STAT_AVERAGE, TRUE, &pPoolItem );
-    if( aState == SFX_ITEM_DONTCARE )
-    {
-        m_aCbxAverage.EnableTriState( TRUE );
-        m_aCbxAverage.SetState( STATE_DONTKNOW );
-    }
-    else
-    {
-        m_aCbxAverage.EnableTriState( FALSE );
-        if( aState == SFX_ITEM_SET )
-            m_aCbxAverage.Check( static_cast< const SfxBoolItem * >( pPoolItem )->GetValue());
-    }
-
-    //-----
-
-	m_eErrorKind = CHERROR_NONE;
+ 	m_eErrorKind = CHERROR_NONE;
     aState = rInAttrs.GetItemState( SCHATTR_STAT_KIND_ERROR, TRUE, &pPoolItem );
     m_bErrorKindUnique = ( aState != SFX_ITEM_DONTCARE );
 
@@ -297,7 +233,7 @@
     }
 
     m_aIndicatorSet.Show(m_eErrorKind != CHERROR_NONE);
-    m_aFTIndicate.Show(m_eErrorKind != CHERROR_NONE);
+//     m_aFLIndicate.Show(m_eErrorKind != CHERROR_NONE);
 
     //-----
 
@@ -347,7 +283,8 @@
         switch( m_eIndicate )
         {
             case CHINDICATE_NONE :
-                m_aIndicatorSet.SelectItem(INDICATE_NONE + 1);
+                // no longer used
+                OSL_ENSURE( false, "CHINDICATE_NONE no longer supported" );
                 break;
             case CHINDICATE_BOTH :
                 m_aIndicatorSet.SelectItem(INDICATE_BOTH + 1);
@@ -362,60 +299,15 @@
     }
     else
         m_aIndicatorSet.SetNoSelection();
-
-    //----- Trend Lines
-
-    if( m_bEnableTrendLine )
-    {
-        m_aFTTrendLine.Show ();
-        m_aTrendLineSet.Show ();
-    }
-    else
-    {
-        m_aTrendLineSet.Hide ();
-        m_aFTTrendLine.Hide ();
-    }
-	
-	aState = rInAttrs.GetItemState( SCHATTR_STAT_REGRESSTYPE, TRUE, &pPoolItem );
-    m_bTrendLineUnique = ( aState != SFX_ITEM_DONTCARE );
-    if( aState == SFX_ITEM_SET )
-        m_eTrendLineType = ((const SvxChartRegressItem * ) pPoolItem)->GetValue();
-
-    if( m_bTrendLineUnique )
-    {
-        switch( m_eTrendLineType )
-        {
-            case CHREGRESS_NONE :
-                m_aTrendLineSet.SelectItem(TRENDLINE_NONE + 1);
-                break;
-            case CHREGRESS_LINEAR :
-                m_aTrendLineSet.SelectItem(TRENDLINE_LINE + 1);
-                break;
-            case CHREGRESS_LOG :
-                m_aTrendLineSet.SelectItem(TRENDLINE_LOG + 1);
-                break;
-            case CHREGRESS_EXP :
-                m_aTrendLineSet.SelectItem(TRENDLINE_EXP + 1);
-                break;
-            case CHREGRESS_POWER :
-                m_aTrendLineSet.SelectItem(TRENDLINE_POW + 1);
-                break;
-        }
-    }
 }
 
 BOOL ErrorBarResources::FillItemSet(SfxItemSet& rOutAttrs) const
 {
-    if( m_aCbxAverage.GetState() != STATE_DONTKNOW )
-        rOutAttrs.Put( SfxBoolItem( SCHATTR_STAT_AVERAGE, m_aCbxAverage.IsChecked() ));
     if( m_bErrorKindUnique )
         rOutAttrs.Put( SvxChartKindErrorItem( m_eErrorKind, SCHATTR_STAT_KIND_ERROR ));
     if( m_bIndicatorUnique )
         rOutAttrs.Put( SvxChartIndicateItem( m_eIndicate, SCHATTR_STAT_INDICATE ));
 
-    if( m_bEnableTrendLine && m_bTrendLineUnique )
-        rOutAttrs.Put( SvxChartRegressItem( m_eTrendLineType, SCHATTR_STAT_REGRESSTYPE ));
-	
     if( m_bErrorKindUnique )
     {
         switch( m_eErrorKind )
@@ -446,47 +338,51 @@
 
 void ErrorBarResources::FillValueSets()
 {
-    bool bIsHighContrast = ( true && m_aRbtNone.GetDisplayBackground().GetColor().IsDark() );
+    bool bIsHighContrast = ( true && m_aRbtConst.GetDisplayBackground().GetColor().IsDark() );
 
     if( m_aIndicatorSet.GetItemCount() == 0 )
     {
-        m_aIndicatorSet.InsertItem( INDICATE_NONE + 1, SELECT_BITMAP( BMP_INDICATE_NONE ),
-                         String(SchResId(STR_INDICATE_NONE)));
-        m_aIndicatorSet.InsertItem( INDICATE_BOTH + 1, SELECT_BITMAP( BMP_INDICATE_BOTH ),
-                         String(SchResId(STR_INDICATE_BOTH)));
-        m_aIndicatorSet.InsertItem( INDICATE_DOWN + 1, SELECT_BITMAP( BMP_INDICATE_DOWN ),
-                         String(SchResId(STR_INDICATE_DOWN)));
-        m_aIndicatorSet.InsertItem( INDICATE_UP + 1, SELECT_BITMAP( BMP_INDICATE_UP ),
-                         String(SchResId(STR_INDICATE_UP)));
-    }
-    else
-    {
-        m_aIndicatorSet.SetItemImage( INDICATE_NONE + 1, SELECT_BITMAP( BMP_INDICATE_NONE ));
-        m_aIndicatorSet.SetItemImage( INDICATE_BOTH + 1, SELECT_BITMAP( BMP_INDICATE_BOTH ));
-        m_aIndicatorSet.SetItemImage( INDICATE_DOWN + 1, SELECT_BITMAP( BMP_INDICATE_DOWN ));
-        m_aIndicatorSet.SetItemImage( INDICATE_UP + 1, SELECT_BITMAP( BMP_INDICATE_UP ));
-    }
-
-    if( m_aTrendLineSet.GetItemCount() == 0 )
-    {
-        m_aTrendLineSet.InsertItem( TRENDLINE_NONE + 1, SELECT_BITMAP( BMP_REGRESSION_NONE ),
-                                String(SchResId(STR_REGRESSION_NONE)));
-        m_aTrendLineSet.InsertItem( TRENDLINE_LINE + 1, SELECT_BITMAP( BMP_REGRESSION_LINEAR ),
-                                String(SchResId(STR_REGRESSION_LINEAR)));
-        m_aTrendLineSet.InsertItem( TRENDLINE_LOG + 1, SELECT_BITMAP( BMP_REGRESSION_LOG ),
-                                String(SchResId(STR_REGRESSION_LOG)));
-        m_aTrendLineSet.InsertItem( TRENDLINE_EXP + 1, SELECT_BITMAP( BMP_REGRESSION_EXP ),
-                                String(SchResId(STR_REGRESSION_EXP)));
-        m_aTrendLineSet.InsertItem( TRENDLINE_POW + 1, SELECT_BITMAP( BMP_REGRESSION_POWER ),
-                                String(SchResId(STR_REGRESSION_POWER)));
+        if( m_eErrorBarType == ERROR_BAR_Y )
+        {
+            m_aIndicatorSet.InsertItem( INDICATE_BOTH + 1, SELECT_BITMAP( BMP_INDICATE_BOTH_VERTI ),
+                                        String(SchResId(STR_INDICATE_BOTH)));
+            m_aIndicatorSet.InsertItem( INDICATE_DOWN + 1, SELECT_BITMAP( BMP_INDICATE_DOWN ),
+                                        String(SchResId(STR_INDICATE_DOWN)));
+            m_aIndicatorSet.InsertItem( INDICATE_UP + 1, SELECT_BITMAP( BMP_INDICATE_UP ),
+                                        String(SchResId(STR_INDICATE_UP)));
+        }
+        else if( m_eErrorBarType == ERROR_BAR_X )
+        {
+            m_aIndicatorSet.InsertItem( INDICATE_BOTH + 1, SELECT_BITMAP( BMP_INDICATE_BOTH_HORI ),
+                                        String(SchResId(STR_INDICATE_BOTH)));
+            m_aIndicatorSet.InsertItem( INDICATE_DOWN + 1, SELECT_BITMAP( BMP_INDICATE_LEFT ),
+                                        String(SchResId(STR_INDICATE_DOWN)));
+            m_aIndicatorSet.InsertItem( INDICATE_UP + 1, SELECT_BITMAP( BMP_INDICATE_RIGHT ),
+                                        String(SchResId(STR_INDICATE_UP)));
+        }
+        else
+        {
+            OSL_ENSURE( false,  "error bar type not handled" );
+        }
     }
     else
     {
-        m_aTrendLineSet.SetItemImage( TRENDLINE_NONE + 1, SELECT_BITMAP( BMP_REGRESSION_NONE ));
-        m_aTrendLineSet.SetItemImage( TRENDLINE_LINE + 1, SELECT_BITMAP( BMP_REGRESSION_LINEAR ));
-        m_aTrendLineSet.SetItemImage( TRENDLINE_LOG + 1, SELECT_BITMAP( BMP_REGRESSION_LOG ));
-        m_aTrendLineSet.SetItemImage( TRENDLINE_EXP + 1, SELECT_BITMAP( BMP_REGRESSION_EXP ));
-        m_aTrendLineSet.SetItemImage( TRENDLINE_POW + 1, SELECT_BITMAP( BMP_REGRESSION_POWER ));
+        if( m_eErrorBarType == ERROR_BAR_Y )
+        {
+            m_aIndicatorSet.SetItemImage( INDICATE_BOTH + 1, SELECT_BITMAP( BMP_INDICATE_BOTH_VERTI ));
+            m_aIndicatorSet.SetItemImage( INDICATE_DOWN + 1, SELECT_BITMAP( BMP_INDICATE_DOWN ));
+            m_aIndicatorSet.SetItemImage( INDICATE_UP + 1, SELECT_BITMAP( BMP_INDICATE_UP ));
+        }
+        else if( m_eErrorBarType == ERROR_BAR_X )
+        {
+            m_aIndicatorSet.SetItemImage( INDICATE_BOTH + 1, SELECT_BITMAP( BMP_INDICATE_BOTH_HORI ));
+            m_aIndicatorSet.SetItemImage( INDICATE_DOWN + 1, SELECT_BITMAP( BMP_INDICATE_LEFT ));
+            m_aIndicatorSet.SetItemImage( INDICATE_UP + 1, SELECT_BITMAP( BMP_INDICATE_RIGHT ));
+        }
+        else
+        {
+            OSL_ENSURE( false,  "error bar type not handled" );
+        }
     }
 }
 
--- chart2/source/controller/dialogs/res_ErrorBar.hxx	2007-07-25 10:34:59.000000000 +0200
+++ chart2/source/controller/dialogs/res_ErrorBar.hxx	1970-01-01 01:00:00.000000000 +0100
@@ -1,123 +0,0 @@
-/*************************************************************************
- *
- *  OpenOffice.org - a multi-platform office productivity suite
- *
- *  $RCSfile: res_ErrorBar.hxx,v $
- *
- *  $Revision: 1.2 $
- *
- *  last change: $Author: rt $ $Date: 2007/07/25 08:34:59 $
- *
- *  The Contents of this file are made available subject to
- *  the terms of GNU Lesser General Public License Version 2.1.
- *
- *
- *    GNU Lesser General Public License Version 2.1
- *    =============================================
- *    Copyright 2005 by Sun Microsystems, Inc.
- *    901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *    This library is free software; you can redistribute it and/or
- *    modify it under the terms of the GNU Lesser General Public
- *    License version 2.1, as published by the Free Software Foundation.
- *
- *    This library is distributed in the hope that it will be useful,
- *    but WITHOUT ANY WARRANTY; without even the implied warranty of
- *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *    Lesser General Public License for more details.
- *
- *    You should have received a copy of the GNU Lesser General Public
- *    License along with this library; if not, write to the Free Software
- *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *    MA  02111-1307  USA
- *
- ************************************************************************/
-#ifndef CHART2_RES_ERRORBAR_HXX
-#define CHART2_RES_ERRORBAR_HXX
-
-// header for class CheckBox
-#ifndef _SV_BUTTON_HXX
-#include <vcl/button.hxx>
-#endif
-// header for class FixedLine
-#ifndef _SV_FIXED_HXX
-#include <vcl/fixed.hxx>
-#endif
-// header for class MetricField
-#ifndef _SV_FIELD_HXX
-#include <vcl/field.hxx>
-#endif
-// header for class ValueSet
-#ifndef _VALUESET_HXX
-#include <svtools/valueset.hxx>
-#endif
-// header for class SfxItemSet
-#ifndef _SFXITEMSET_HXX
-#include <svtools/itemset.hxx>
-#endif
-// header for enum SvxChartKindError
-#include "chartview/ChartSfxItemIds.hxx"
-#ifndef _SVX_CHRTITEM_HXX
-#include <svx/chrtitem.hxx>
-#endif
-
-//.............................................................................
-namespace chart
-{
-//.............................................................................
-
-class ErrorBarResources
-{
-public:
-    ErrorBarResources( Window* pParent, const SfxItemSet& rInAttrs );
-    virtual ~ErrorBarResources();
-
-    void EnableTrendLine( bool bEnable );
-    void SetAxisMinorStepWidthForErrorBarDecimals( double fMinorStepWidth );
-
-    void Reset(const SfxItemSet& rInAttrs);
-    BOOL FillItemSet(SfxItemSet& rOutAttrs) const;
-
-    void FillValueSets();
-    
-private:
-    CheckBox        m_aCbxAverage;
-    FixedLine       m_aFlErrorCategory;
-    RadioButton     m_aRbtNone;
-    RadioButton     m_aRbtVariant;
-    RadioButton     m_aRbtSigma;
-    RadioButton     m_aRbtPercent;
-    RadioButton     m_aRbtBigError;
-    RadioButton     m_aRbtConst;
-    MetricField     m_aMtrFldPercent;
-    MetricField     m_aMtrFldBigError;
-    FixedText       m_aFTConstPlus;
-    MetricField     m_aMtrFldConstPlus;
-    FixedText       m_aFTConstMinus;
-    MetricField     m_aMtrFldConstMinus;
-    FixedText       m_aFTIndicate;
-    ValueSet        m_aIndicatorSet;
-    FixedText       m_aFTTrendLine;
-    ValueSet        m_aTrendLineSet;
-
-    bool                m_bEnableTrendLine;
-    SvxChartKindError   m_eErrorKind;
-    SvxChartIndicate    m_eIndicate;
-    SvxChartRegress     m_eTrendLineType;
-
-    bool                m_bErrorKindUnique;
-    bool                m_bIndicatorUnique;
-    bool                m_bTrendLineUnique;
-    bool                m_bPlusUnique;
-    bool                m_bMinusUnique;
-
-    DECL_LINK(RBtnClick, Button *);
-    DECL_LINK(SelectIndicate, void *);
-    DECL_LINK(SelectTrendLine, void *);
-};
-
-//.............................................................................
-} //namespace chart
-//.............................................................................
-
-#endif
--- chart2/source/controller/dialogs/res_ErrorBar_IDs.hrc	2007-07-25 10:35:09.000000000 +0200
+++ chart2/source/controller/dialogs/res_ErrorBar_IDs.hrc	2007-12-20 17:14:49.000000000 +0100
@@ -33,7 +33,6 @@
  *
  ************************************************************************/
 
-#define CBX_AVERAGE 1
 #define FL_ERROR 1
 #define RBT_NONE 1
 #define RBT_VARIANT 2
@@ -41,13 +40,12 @@
 #define RBT_PERCENT 4
 #define RBT_BIGERROR 5
 #define RBT_CONST 6
+#define RBT_RANGE 7
 #define MTR_FLD_PERCENT 1
 #define MTR_FLD_BIGERROR 2
 #define MTR_FLD_PLUS 3
 #define MTR_FLD_MINUS 4
 #define FT_PERCENT_PLUS 1
 #define FT_PERCENT_MINUS 2
-#define FT_INDICATE 3
-#define FT_REGRESS 4
+#define FL_INDICATE 3
 #define CT_INDICATE 1
-#define CT_REGRESS 2
--- chart2/source/controller/dialogs/res_ErrorBar_tmpl.hrc	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/res_ErrorBar_tmpl.hrc	2008-01-09 17:36:14.000000000 +0100
@@ -0,0 +1,204 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: res_ErrorBar_tmpl.hrc,v $
+ *
+ *  $Revision: 1.1.2.2 $
+ *
+ *  last change: $Author: bm $ $Date: 2008/01/09 16:36:14 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#ifndef _CHART2_RESOURCE_ERRORBARS_HXX
+#define _CHART2_RESOURCE_ERRORBARS_HXX
+
+#include "res_ErrorBar_IDs.hrc"
+
+#define RESOURCE_ERRORBARS(availablewidth) \
+FixedLine FL_ERROR \
+{ \
+	Pos = MAP_APPFONT ( 6 , 6  ) ; \
+	Size = MAP_APPFONT ( 140 , 8 ) ; \
+	Text [ en-US ] = "Error category" ; \
+}; \
+RadioButton RBT_NONE \
+{ \
+    HelpID = HID_SCH_STATISTIK_NO_ERROR; \
+	Pos = MAP_APPFONT ( 12 , 20  ) ; \
+	Size = MAP_APPFONT ( 75 , 10 ) ; \
+	Text [ en-US ] = "~No function" ; \
+	TabStop = TRUE ; \
+}; \
+RadioButton RBT_VARIANT \
+{ \
+    HelpID = HID_SCH_STATISTIK_VARIANT; \
+	Pos = MAP_APPFONT ( 12 , 36  ) ; \
+	Size = MAP_APPFONT ( 75 , 10 ) ; \
+	Text [ en-US ] = "~Variance" ; \
+	TabStop = TRUE ; \
+}; \
+RadioButton RBT_SIGMA \
+{ \
+    HelpID = HID_SCH_STATISTIK_SIGMA; \
+	Pos = MAP_APPFONT ( 12 , 52  ) ; \
+	Size = MAP_APPFONT ( 75 , 10 ) ; \
+	Text [ en-US ] = "~Standard deviation" ; \
+	TabStop = TRUE ; \
+}; \
+RadioButton RBT_PERCENT \
+{ \
+    HelpID = HID_SCH_STATISTIK_PERCENT; \
+	Pos = MAP_APPFONT ( 12 , 68  ) ; \
+	Size = MAP_APPFONT ( 75 , 10 ) ; \
+	Text [ en-US ] = "~Percentage" ; \
+	TabStop = TRUE ; \
+}; \
+RadioButton RBT_BIGERROR \
+{ \
+    HelpID = HID_SCH_STATISTIK_BIGERROR; \
+	Pos = MAP_APPFONT ( 12 , 84  ) ; \
+	Size = MAP_APPFONT ( 75 , 10 ) ; \
+	Text [ en-US ] = "~Error margin" ; \
+	TabStop = TRUE ; \
+}; \
+RadioButton RBT_CONST \
+{ \
+    HelpID = HID_SCH_STATISTIK_CONSTERROR; \
+	Pos = MAP_APPFONT ( 12 , 100  ) ; \
+	Size = MAP_APPFONT ( 75 , 10 ) ; \
+	Text [ en-US ] = "~Constant value" ; \
+	TabStop = TRUE ; \
+}; \
+MetricField MTR_FLD_PERCENT \
+{ \
+    HelpID = HID_SCH_STATISTIK_PERCENT_VALUE; \
+	Border = TRUE ; \
+	Pos = MAP_APPFONT ( 100 , 67  ) ; \
+	Size = MAP_APPFONT ( 40 , 12 ) ; \
+	TabStop = TRUE ; \
+	Repeat = TRUE ; \
+	Spin = TRUE ; \
+	Minimum = 0 ; \
+	Maximum = 10000 ; \
+	StrictFormat = TRUE ; \
+	Unit = FUNIT_CUSTOM ; \
+	CustomUnitText = " %" ; \
+	First = 100 ; \
+	Last = 10000 ; \
+	SpinSize = 100 ; \
+	DecimalDigits = 2 ; \
+}; \
+MetricField MTR_FLD_BIGERROR \
+{ \
+    HelpID = HID_SCH_STATISTIK_BIGERROR_VALUE; \
+	Border = TRUE ; \
+	Pos = MAP_APPFONT ( 100 , 83  ) ; \
+	Size = MAP_APPFONT ( 40 , 12 ) ; \
+	TabStop = TRUE ; \
+	Repeat = TRUE ; \
+	Spin = TRUE ; \
+	Minimum = 0 ; \
+	Maximum = 10000 ; \
+	StrictFormat = TRUE ; \
+	Unit = FUNIT_CUSTOM ; \
+	CustomUnitText  = " %" ; \
+	First = 100 ; \
+	Last = 10000 ; \
+	SpinSize = 100 ; \
+	DecimalDigits = 2 ; \
+}; \
+FixedText FT_PERCENT_PLUS \
+{ \
+	Pos = MAP_APPFONT ( 92 , 101  ) ; \
+	Size = MAP_APPFONT ( 8 , 8 ) ; \
+	Text [ en-US ] = "+" ; \
+}; \
+MetricField MTR_FLD_PLUS \
+{ \
+    HelpID = HID_SCH_STATISTIK_PLUS_VALUE; \
+	Border = TRUE ; \
+	Pos = MAP_APPFONT ( 100 , 99  ) ; \
+	Size = MAP_APPFONT ( 40 , 12 ) ; \
+	TabStop = TRUE ; \
+	Repeat = TRUE ; \
+	Spin = TRUE ; \
+	Minimum = 0 ; \
+	Maximum = 100000000 ; \
+	StrictFormat = TRUE ; \
+	Unit = FUNIT_CUSTOM ; \
+	First = 0 ; \
+	Last = 100000000 ; \
+	SpinSize = 1 ; \
+	DecimalDigits = 3 ; \
+}; \
+FixedText FT_PERCENT_MINUS \
+{ \
+    Pos = MAP_APPFONT ( 92 , 117  ) ; \
+	Size = MAP_APPFONT ( 8 , 8 ) ; \
+	Text [ en-US ] = "-"; \
+}; \
+MetricField MTR_FLD_MINUS \
+{ \
+    HelpID = HID_SCH_STATISTIK_MINUS_VALUE; \
+	Border = TRUE ; \
+	Pos = MAP_APPFONT ( 100 , 115  ) ; \
+	Size = MAP_APPFONT ( 40 , 12 ) ; \
+	TabStop = TRUE ; \
+	Repeat = TRUE ; \
+	Spin = TRUE ; \
+	Minimum = 0 ; \
+	Maximum = 100000000 ; \
+	StrictFormat = TRUE ; \
+	Unit = FUNIT_CUSTOM ; \
+	First = 0 ; \
+	Last = 100000000 ; \
+	SpinSize = 1 ; \
+	DecimalDigits = 3 ; \
+}; \
+FixedLine FL_INDICATE \
+{ \
+	Pos = MAP_APPFONT ( 150 , 6  ) ; \
+	Size = MAP_APPFONT ( availablewidth - 150 , 8 ) ; \
+	Text [ en-US ] = "Error ~indicator" ; \
+}; \
+Control CT_INDICATE \
+{ \
+    HelpId = HID_SCH_CT_INDICATE ; \
+	Border = TRUE ; \
+	Pos = MAP_APPFONT ( 150 , 20  ) ; \
+	Size = MAP_APPFONT ( 76 , 36 ) ; \
+	TabStop = TRUE ; \
+};
+
+// RadioButton RBT_RANGE \
+// { \
+// 	Pos = MAP_APPFONT ( 12 , 116  ) ; \
+// 	Size = MAP_APPFONT ( 75 , 10 ) ; \
+// 	Text [ en-US ] = "~Range" ; \
+// 	TabStop = TRUE ; \
+// }; \
+
+#endif
--- chart2/source/controller/dialogs/res_LegendPosition_tmpl.hrc	2007-05-22 19:40:19.000000000 +0200
+++ chart2/source/controller/dialogs/res_LegendPosition_tmpl.hrc	2007-12-18 15:53:34.000000000 +0100
@@ -53,7 +53,7 @@
 { \
     HelpID = HID_SCH_LEGEND_POS_LEFT ; \
 	Pos = MAP_APPFONT ( xpos , ypos  ) ; \
-	Size = MAP_APPFONT ( 55 , 10 ) ; \
+	Size = MAP_APPFONT ( 75 , 10 ) ; \
 	Text [ en-US ] = "~Left" ; \
 	TabStop = TRUE ; \
 }; \
@@ -61,7 +61,7 @@
 { \
     HelpID = HID_SCH_LEGEND_POS_RIGHT ; \
 	Pos = MAP_APPFONT ( xpos , ypos+14  ) ; \
-	Size = MAP_APPFONT ( 55 , 10 ) ; \
+	Size = MAP_APPFONT ( 75 , 10 ) ; \
 	Text [ en-US ] = "~Right" ; \
 	TabStop = TRUE ; \
 }; \
@@ -69,7 +69,7 @@
 { \
     HelpID = HID_SCH_LEGEND_POS_TOP ; \
 	Pos = MAP_APPFONT ( xpos , ypos+28  ) ; \
-	Size = MAP_APPFONT ( 55 , 10 ) ; \
+	Size = MAP_APPFONT ( 75 , 10 ) ; \
 	Text [ en-US ] = "~Top" ; \
 	TabStop = TRUE ; \
 }; \
@@ -77,7 +77,7 @@
 { \
     HelpID = HID_SCH_LEGEND_POS_BOTTOM ; \
 	Pos = MAP_APPFONT ( xpos , ypos+42  ) ; \
-	Size = MAP_APPFONT ( 55 , 10 ) ; \
+	Size = MAP_APPFONT ( 75 , 10 ) ; \
 	Text [ en-US ] = "~Bottom" ; \
 	TabStop = TRUE ; \
 };
--- chart2/source/controller/dialogs/ResourceIds.hrc	2007-11-23 12:45:55.000000000 +0100
+++ chart2/source/controller/dialogs/ResourceIds.hrc	2008-01-14 17:10:06.000000000 +0100
@@ -50,21 +50,22 @@
 #define DLG_AXIS_OR_GRID    839
 #define DLG_DATA_DESCR      836
 #define DLG_LEGEND          835
-#define DLG_DATA_STAT       840
 #define DLG_TITLE           834
 #define DLG_3D_VIEW         752
 #define DLG_OBJECT_PROPERTIES 903
 #define DLG_SPLINE_PROPERTIES 904
+#define DLG_DATA_TRENDLINE  841
+#define DLG_DATA_YERRORBAR  842
 
 //-----------------------------------------------------------------------------
 //TabPage Ids:
 #define TP_LEGEND_POS   900
 #define TP_DATA_DESCR   901
 #define TP_ALIGNMENT    902
-#define TP_STAT         905
 //#define TP_SYMBOL     906
 #define TP_LAYOUT       907
 #define TP_OPTIONS      908
+#define TP_POLAROPTIONS 909
 #define TP_AXIS_LABEL	920
 #define TP_SCALE_Y		903
 #define TP_CHARTTYPE    910
@@ -77,7 +78,8 @@
 #define TP_3D_SCENEAPPEARANCE   916
 #define TP_3D_SCENEILLUMINATION 917
 
-#define TP_REGRESSION_OPTIONS 918
+#define TP_TRENDLINE    918
+#define TP_YERRORBAR    919
 
 //-----------------------------------------------------------------------------
 //listbox Ids:
--- chart2/source/controller/dialogs/res_Statistic_tmpl.hrc	2007-07-25 10:35:21.000000000 +0200
+++ chart2/source/controller/dialogs/res_Statistic_tmpl.hrc	1970-01-01 01:00:00.000000000 +0100
@@ -1,220 +0,0 @@
-/*************************************************************************
- *
- *  OpenOffice.org - a multi-platform office productivity suite
- *
- *  $RCSfile: res_Statistic_tmpl.hrc,v $
- *
- *  $Revision: 1.7 $
- *
- *  last change: $Author: rt $ $Date: 2007/07/25 08:35:21 $
- *
- *  The Contents of this file are made available subject to
- *  the terms of GNU Lesser General Public License Version 2.1.
- *
- *
- *    GNU Lesser General Public License Version 2.1
- *    =============================================
- *    Copyright 2005 by Sun Microsystems, Inc.
- *    901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *    This library is free software; you can redistribute it and/or
- *    modify it under the terms of the GNU Lesser General Public
- *    License version 2.1, as published by the Free Software Foundation.
- *
- *    This library is distributed in the hope that it will be useful,
- *    but WITHOUT ANY WARRANTY; without even the implied warranty of
- *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *    Lesser General Public License for more details.
- *
- *    You should have received a copy of the GNU Lesser General Public
- *    License along with this library; if not, write to the Free Software
- *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *    MA  02111-1307  USA
- *
- ************************************************************************/
-#ifndef _CHART2_RESOURCE_STATISTIC_HXX
-#define _CHART2_RESOURCE_STATISTIC_HXX
-
-#include "res_ErrorBar_IDs.hrc"
-
-#define RESOURCE_STATISTIC( imagelistsyposition, linelength ) \
-CheckBox CBX_AVERAGE \
-{ \
-    HelpID = HID_SCH_STATISTIK_MEANVALUE; \
-	Pos = MAP_APPFONT ( 6 , 6  ) ; \
-	Size = MAP_APPFONT ( 60 , 12 ) ; \
-	Text [ en-US ] = "~Mean value" ; \
-	TabStop = TRUE ; \
-}; \
-FixedLine FL_ERROR \
-{ \
-	Pos = MAP_APPFONT ( 6 , 22  ) ; \
-	Size = MAP_APPFONT ( linelength , 8 ) ; \
-	Text [ en-US ] = "Error category" ; \
-}; \
-RadioButton RBT_NONE \
-{ \
-    HelpID = HID_SCH_STATISTIK_NO_ERROR; \
-	Pos = MAP_APPFONT ( 12 , 33  ) ; \
-	Size = MAP_APPFONT ( 75 , 10 ) ; \
-	Text [ en-US ] = "~No function" ; \
-	TabStop = TRUE ; \
-}; \
-RadioButton RBT_VARIANT \
-{ \
-    HelpID = HID_SCH_STATISTIK_VARIANT; \
-	Pos = MAP_APPFONT ( 12 , 49  ) ; \
-	Size = MAP_APPFONT ( 75 , 10 ) ; \
-	Text [ en-US ] = "~Variance" ; \
-	TabStop = TRUE ; \
-}; \
-RadioButton RBT_SIGMA \
-{ \
-    HelpID = HID_SCH_STATISTIK_SIGMA; \
-	Pos = MAP_APPFONT ( 12 , 65  ) ; \
-	Size = MAP_APPFONT ( 75 , 10 ) ; \
-	Text [ en-US ] = "~Standard deviation" ; \
-	TabStop = TRUE ; \
-}; \
-RadioButton RBT_PERCENT \
-{ \
-    HelpID = HID_SCH_STATISTIK_PERCENT; \
-	Pos = MAP_APPFONT ( 12 , 81  ) ; \
-	Size = MAP_APPFONT ( 75 , 10 ) ; \
-	Text [ en-US ] = "~Percentage" ; \
-	TabStop = TRUE ; \
-}; \
-RadioButton RBT_BIGERROR \
-{ \
-    HelpID = HID_SCH_STATISTIK_BIGERROR; \
-	Pos = MAP_APPFONT ( 12 , 97  ) ; \
-	Size = MAP_APPFONT ( 75 , 10 ) ; \
-	Text [ en-US ] = "~Error margin" ; \
-	TabStop = TRUE ; \
-}; \
-RadioButton RBT_CONST \
-{ \
-    HelpID = HID_SCH_STATISTIK_CONSTERROR; \
-	Pos = MAP_APPFONT ( 12 , 113  ) ; \
-	Size = MAP_APPFONT ( 75 , 10 ) ; \
-	Text [ en-US ] = "~Constant value" ; \
-	TabStop = TRUE ; \
-}; \
-MetricField MTR_FLD_PERCENT \
-{ \
-    HelpID = HID_SCH_STATISTIK_PERCENT_VALUE; \
-	Border = TRUE ; \
-	Pos = MAP_APPFONT ( 100 , 79  ) ; \
-	Size = MAP_APPFONT ( 40 , 12 ) ; \
-	TabStop = TRUE ; \
-	Repeat = TRUE ; \
-	Spin = TRUE ; \
-	Minimum = 0 ; \
-	Maximum = 10000 ; \
-	StrictFormat = TRUE ; \
-	Unit = FUNIT_CUSTOM ; \
-	CustomUnitText = " %" ; \
-	First = 100 ; \
-	Last = 10000 ; \
-	SpinSize = 100 ; \
-	DecimalDigits = 2 ; \
-}; \
-MetricField MTR_FLD_BIGERROR \
-{ \
-    HelpID = HID_SCH_STATISTIK_BIGERROR_VALUE; \
-	Border = TRUE ; \
-	Pos = MAP_APPFONT ( 100 , 95  ) ; \
-	Size = MAP_APPFONT ( 40 , 12 ) ; \
-	TabStop = TRUE ; \
-	Repeat = TRUE ; \
-	Spin = TRUE ; \
-	Minimum = 0 ; \
-	Maximum = 10000 ; \
-	StrictFormat = TRUE ; \
-	Unit = FUNIT_CUSTOM ; \
-	CustomUnitText  = " %" ; \
-	First = 100 ; \
-	Last = 10000 ; \
-	SpinSize = 100 ; \
-	DecimalDigits = 2 ; \
-}; \
-FixedText FT_PERCENT_PLUS \
-{ \
-	Pos = MAP_APPFONT ( 89 , 113  ) ; \
-	Size = MAP_APPFONT ( 8 , 8 ) ; \
-	Text [ en-US ] = "+" ; \
-}; \
-MetricField MTR_FLD_PLUS \
-{ \
-    HelpID = HID_SCH_STATISTIK_PLUS_VALUE; \
-	Border = TRUE ; \
-	Pos = MAP_APPFONT ( 100 , 111  ) ; \
-	Size = MAP_APPFONT ( 40 , 12 ) ; \
-	TabStop = TRUE ; \
-	Repeat = TRUE ; \
-	Spin = TRUE ; \
-	Minimum = 0 ; \
-	Maximum = 100000000 ; \
-	StrictFormat = TRUE ; \
-	Unit = FUNIT_CUSTOM ; \
-	First = 0 ; \
-	Last = 100000000 ; \
-	SpinSize = 1 ; \
-	DecimalDigits = 3 ; \
-}; \
-FixedText FT_PERCENT_MINUS \
-{ \
-    Pos = MAP_APPFONT ( 89 , 129  ) ; \
-	Size = MAP_APPFONT ( 8 , 8 ) ; \
-	Text [ en-US ] = "-"; \
-}; \
-MetricField MTR_FLD_MINUS \
-{ \
-    HelpID = HID_SCH_STATISTIK_MINUS_VALUE; \
-	Border = TRUE ; \
-	Pos = MAP_APPFONT ( 100 , 127  ) ; \
-	Size = MAP_APPFONT ( 40 , 12 ) ; \
-	TabStop = TRUE ; \
-	Repeat = TRUE ; \
-	Spin = TRUE ; \
-	Minimum = 0 ; \
-	Maximum = 100000000 ; \
-	StrictFormat = TRUE ; \
-	Unit = FUNIT_CUSTOM ; \
-	First = 0 ; \
-	Last = 100000000 ; \
-	SpinSize = 1 ; \
-	DecimalDigits = 3 ; \
-}; \
-FixedText FT_INDICATE \
-{ \
-	Pos = MAP_APPFONT ( 152 , imagelistsyposition  ) ; \
-	Size = MAP_APPFONT ( 70 , 10 ) ; \
-	Text [ en-US ] = "Error ~indicator" ; \
-}; \
-Control CT_INDICATE \
-{ \
-    HelpId = HID_SCH_CT_INDICATE ; \
-	Border = TRUE ; \
-	Pos = MAP_APPFONT ( 152 , imagelistsyposition+12  ) ; \
-	Size = MAP_APPFONT ( 94 , 36 ) ; \
-	TabStop = TRUE ; \
-}; \
-FixedText FT_REGRESS \
-{ \
-	Pos = MAP_APPFONT ( 152 , imagelistsyposition+12+56  ) ; \
-	Size = MAP_APPFONT ( 70 , 10 ) ; \
-	Text [ en-US ] = "~Regression curves" ; \
-}; \
-Control CT_REGRESS \
-{ \
-	HelpId = HID_SCH_CT_REGRESS ; \
-	Border = TRUE ; \
-	Pos = MAP_APPFONT ( 152 , imagelistsyposition+12+56+12  ) ; \
-	Size = MAP_APPFONT ( 94 , 36 ) ; \
-	TabStop = TRUE ; \
-};
-
-//	Size = MAP_APPFONT ( 94 , 50 ) ;                                  \
-
-#endif
--- chart2/source/controller/dialogs/res_Titles.cxx	2007-05-22 19:40:53.000000000 +0200
+++ chart2/source/controller/dialogs/res_Titles.cxx	2008-01-14 16:49:47.000000000 +0100
@@ -41,23 +41,91 @@
 #include "ResId.hxx"
 #include "TitleDialogData.hxx"
 
+ #ifndef _SVT_CONTROLDIMS_HRC_
+ #include <svtools/controldims.hrc>
+ #endif
+
 //.............................................................................
 namespace chart
 {
 //.............................................................................
 
-TitleResources::TitleResources( Window* pWindow )
+TitleResources::TitleResources( Window* pWindow, bool bShowSecondaryAxesTitle )
     : m_aFT_Main(pWindow, SchResId(FT_MAINTITLE))
 	, m_aEd_Main(pWindow, SchResId(ED_MAINTITLE))
 	, m_aFT_Sub(pWindow, SchResId(FT_SUBTITLE))
 	, m_aEd_Sub(pWindow, SchResId(ED_SUBTITLE))
+    , m_aFL_Axes(pWindow, SchResId(FL_AXES))
 	, m_aFT_XAxis(pWindow, SchResId(FT_TITLE_X_AXIS))
 	, m_aEd_XAxis(pWindow, SchResId(ED_X_AXIS))
 	, m_aFT_YAxis(pWindow, SchResId(FT_TITLE_Y_AXIS))
 	, m_aEd_YAxis(pWindow, SchResId(ED_Y_AXIS))
 	, m_aFT_ZAxis(pWindow, SchResId(FT_TITLE_Z_AXIS))
 	, m_aEd_ZAxis(pWindow, SchResId(ED_Z_AXIS))
-{
+    , m_aFL_SecondaryAxes(pWindow, SchResId(FL_SECONDARY_AXES))
+    , m_aFT_SecondaryXAxis(pWindow, SchResId(FT_TITLE_SECONDARY_X_AXIS))
+    , m_aEd_SecondaryXAxis(pWindow, SchResId(ED_SECONDARY_X_AXIS))
+    , m_aFT_SecondaryYAxis(pWindow, SchResId(FT_TITLE_SECONDARY_Y_AXIS))
+    , m_aEd_SecondaryYAxis(pWindow, SchResId(ED_SECONDARY_Y_AXIS))
+{
+     long nMaxTextWidth = ::std::max( m_aFT_Main.CalcMinimumSize().Width(),m_aFT_Sub.CalcMinimumSize().Width() ) ;
+     nMaxTextWidth = ::std::max( nMaxTextWidth, m_aFT_XAxis.CalcMinimumSize().Width() ) ;
+     nMaxTextWidth = ::std::max( nMaxTextWidth, m_aFT_YAxis.CalcMinimumSize().Width() ) ;
+     nMaxTextWidth = ::std::max( nMaxTextWidth, m_aFT_ZAxis.CalcMinimumSize().Width() ) ;
+     if( bShowSecondaryAxesTitle )
+     {
+         nMaxTextWidth = ::std::max( nMaxTextWidth, m_aFT_SecondaryXAxis.CalcMinimumSize().Width() ) ;
+         nMaxTextWidth = ::std::max( nMaxTextWidth, m_aFT_SecondaryYAxis.CalcMinimumSize().Width() ) ;
+     }
+     
+     Size aControlDistance( m_aFT_Main.LogicToPixel( Size(RSC_SP_CTRL_DESC_X,RSC_SP_CTRL_GROUP_Y), MapMode(MAP_APPFONT) ) );
+     long nEditFieldXPos = m_aFT_Main.GetPosPixel().X() + nMaxTextWidth + aControlDistance.Width();
+     long nEditFieldWidth = m_aEd_Main.GetPosPixel().X() + m_aEd_Main.GetSizePixel().Width() - nEditFieldXPos;
+ 
+     if( nEditFieldWidth > 10 )
+     {
+         Size aFTSize( m_aFT_Main.GetSizePixel() );
+         aFTSize.Width() = nMaxTextWidth;
+         m_aFT_Main.SetSizePixel(aFTSize);
+ 	     m_aFT_Sub.SetSizePixel(aFTSize);
+         m_aFT_XAxis.SetSizePixel(aFTSize);
+         m_aFT_YAxis.SetSizePixel(aFTSize);
+         m_aFT_ZAxis.SetSizePixel(aFTSize);
+         if( bShowSecondaryAxesTitle )
+         {
+             m_aFT_SecondaryXAxis.SetSizePixel(aFTSize);
+             m_aFT_SecondaryYAxis.SetSizePixel(aFTSize);
+         }
+ 
+         m_aEd_Main.SetPosPixel( Point( nEditFieldXPos, m_aEd_Main.GetPosPixel().Y() ) );
+         m_aEd_Sub.SetPosPixel( Point( nEditFieldXPos, m_aEd_Sub.GetPosPixel().Y() ) );
+         m_aEd_XAxis.SetPosPixel( Point( nEditFieldXPos, m_aEd_XAxis.GetPosPixel().Y() ) );
+         m_aEd_YAxis.SetPosPixel( Point( nEditFieldXPos, m_aEd_YAxis.GetPosPixel().Y() ) );
+         m_aEd_ZAxis.SetPosPixel( Point( nEditFieldXPos, m_aEd_ZAxis.GetPosPixel().Y() ) );
+         if(bShowSecondaryAxesTitle)
+         {
+             m_aEd_SecondaryXAxis.SetPosPixel( Point( nEditFieldXPos, m_aEd_SecondaryXAxis.GetPosPixel().Y() ) );
+             m_aEd_SecondaryYAxis.SetPosPixel( Point( nEditFieldXPos, m_aEd_SecondaryYAxis.GetPosPixel().Y() ) );
+         }
+ 
+         Size aEditSize( m_aEd_Main.GetSizePixel() );
+         aEditSize.Width() = nEditFieldWidth;
+         m_aEd_Main.SetSizePixel( aEditSize );
+         m_aEd_Sub.SetSizePixel( aEditSize );
+         m_aEd_XAxis.SetSizePixel( aEditSize );
+         m_aEd_YAxis.SetSizePixel( aEditSize );
+         m_aEd_ZAxis.SetSizePixel( aEditSize );
+         if(bShowSecondaryAxesTitle)
+         {
+             m_aEd_SecondaryXAxis.SetSizePixel( aEditSize );
+             m_aEd_SecondaryYAxis.SetSizePixel( aEditSize );
+         }
+     }
+ 
+     m_aFT_SecondaryXAxis.Show( bShowSecondaryAxesTitle );
+     m_aEd_SecondaryXAxis.Show( bShowSecondaryAxesTitle );
+     m_aFT_SecondaryYAxis.Show( bShowSecondaryAxesTitle );
+     m_aEd_SecondaryYAxis.Show( bShowSecondaryAxesTitle );
 }
 
 TitleResources::~TitleResources()
@@ -82,6 +150,12 @@
 
     m_aEd_ZAxis.EnableUpdateData( nTimeout );
     m_aEd_ZAxis.SetUpdateDataHdl( rLink );
+
+    m_aEd_SecondaryXAxis.EnableUpdateData( nTimeout );
+    m_aEd_SecondaryXAxis.SetUpdateDataHdl( rLink );
+
+    m_aEd_SecondaryYAxis.EnableUpdateData( nTimeout );
+    m_aEd_SecondaryYAxis.SetUpdateDataHdl( rLink );
 }
 
 bool TitleResources::IsModified()
@@ -90,7 +164,9 @@
         || m_aEd_Sub.IsModified()
         || m_aEd_XAxis.IsModified()
         || m_aEd_YAxis.IsModified()
-        || m_aEd_ZAxis.IsModified();
+        || m_aEd_ZAxis.IsModified()
+        || m_aEd_SecondaryXAxis.IsModified()
+        || m_aEd_SecondaryYAxis.IsModified();
 }
 
 void TitleResources::ClearModifyFlag()
@@ -100,6 +176,8 @@
     m_aEd_XAxis.ClearModifyFlag();
     m_aEd_YAxis.ClearModifyFlag();
     m_aEd_ZAxis.ClearModifyFlag();
+    m_aEd_SecondaryXAxis.ClearModifyFlag();
+    m_aEd_SecondaryYAxis.ClearModifyFlag();
 }
 
 void TitleResources::writeToResources( const TitleDialogData& rInput )
@@ -109,18 +187,24 @@
     m_aFT_XAxis.Enable( rInput.aPossibilityList[2] );
     m_aFT_YAxis.Enable( rInput.aPossibilityList[3] );
     m_aFT_ZAxis.Enable( rInput.aPossibilityList[4] );
+    m_aFT_SecondaryXAxis.Enable( rInput.aPossibilityList[5] );
+    m_aFT_SecondaryYAxis.Enable( rInput.aPossibilityList[6] );
 
     m_aEd_Main.Enable( rInput.aPossibilityList[0] );
     m_aEd_Sub.Enable( rInput.aPossibilityList[1] );
     m_aEd_XAxis.Enable( rInput.aPossibilityList[2] );
     m_aEd_YAxis.Enable( rInput.aPossibilityList[3] );
     m_aEd_ZAxis.Enable( rInput.aPossibilityList[4] );
+    m_aEd_SecondaryXAxis.Enable( rInput.aPossibilityList[5] );
+    m_aEd_SecondaryYAxis.Enable( rInput.aPossibilityList[6] );
 
     m_aEd_Main.SetText(rInput.aTextList[0]);
     m_aEd_Sub.SetText(rInput.aTextList[1]);
     m_aEd_XAxis.SetText(rInput.aTextList[2]);
     m_aEd_YAxis.SetText(rInput.aTextList[3]);
     m_aEd_ZAxis.SetText(rInput.aTextList[4]);
+    m_aEd_SecondaryXAxis.SetText(rInput.aTextList[5]);
+    m_aEd_SecondaryYAxis.SetText(rInput.aTextList[6]);
 }
 
 void TitleResources::readFromResources( TitleDialogData& rOutput )
@@ -130,12 +214,16 @@
     rOutput.aExistenceList[2] = static_cast<sal_Bool>(m_aEd_XAxis.GetText().Len()!=0);
     rOutput.aExistenceList[3] = static_cast<sal_Bool>(m_aEd_YAxis.GetText().Len()!=0);
     rOutput.aExistenceList[4] = static_cast<sal_Bool>(m_aEd_ZAxis.GetText().Len()!=0);
+    rOutput.aExistenceList[5] = static_cast<sal_Bool>(m_aEd_SecondaryXAxis.GetText().Len()!=0);
+    rOutput.aExistenceList[6] = static_cast<sal_Bool>(m_aEd_SecondaryYAxis.GetText().Len()!=0);
 
     rOutput.aTextList[0] = m_aEd_Main.GetText();
     rOutput.aTextList[1] = m_aEd_Sub.GetText();
     rOutput.aTextList[2] = m_aEd_XAxis.GetText();
     rOutput.aTextList[3] = m_aEd_YAxis.GetText();
     rOutput.aTextList[4] = m_aEd_ZAxis.GetText();
+    rOutput.aTextList[5] = m_aEd_SecondaryXAxis.GetText();
+    rOutput.aTextList[6] = m_aEd_SecondaryYAxis.GetText();
 }
 
 //.............................................................................
--- chart2/source/controller/dialogs/res_Titles.hrc	2007-05-22 19:41:03.000000000 +0200
+++ chart2/source/controller/dialogs/res_Titles.hrc	2008-01-14 16:48:18.000000000 +0100
@@ -40,10 +40,16 @@
 #define ED_X_AXIS       3
 #define ED_Y_AXIS       4
 #define ED_Z_AXIS       5
+#define ED_SECONDARY_X_AXIS       6
+#define ED_SECONDARY_Y_AXIS       7
 #define FT_MAINTITLE    1
 #define FT_SUBTITLE     2
 #define FT_TITLE_X_AXIS 3
 #define FT_TITLE_Y_AXIS 4
 #define FT_TITLE_Z_AXIS 5
+#define FT_TITLE_SECONDARY_X_AXIS 6
+#define FT_TITLE_SECONDARY_Y_AXIS 7
+#define FL_AXES 1
+#define FL_SECONDARY_AXES 2
 
 #endif
--- chart2/source/controller/dialogs/res_Titles.hxx	2007-05-22 19:41:13.000000000 +0200
+++ chart2/source/controller/dialogs/res_Titles.hxx	2008-01-14 16:49:28.000000000 +0100
@@ -52,7 +52,7 @@
 class TitleResources
 {
 public:
-	TitleResources( Window* pParent );
+	TitleResources( Window* pParent, bool bShowSecondaryAxesTitle );
 	virtual ~TitleResources();
 
     void writeToResources( const TitleDialogData& rInput );
@@ -67,12 +67,20 @@
 	Edit     			m_aEd_Main;
 	FixedText 			m_aFT_Sub;
 	Edit     			m_aEd_Sub;
+
+    FixedLine           m_aFL_Axes;
 	FixedText 			m_aFT_XAxis;
 	Edit     			m_aEd_XAxis;
 	FixedText 			m_aFT_YAxis;
 	Edit     			m_aEd_YAxis;
 	FixedText 			m_aFT_ZAxis;
 	Edit     			m_aEd_ZAxis;
+
+    FixedLine           m_aFL_SecondaryAxes;
+    FixedText           m_aFT_SecondaryXAxis;
+    Edit                m_aEd_SecondaryXAxis;
+    FixedText           m_aFT_SecondaryYAxis;
+    Edit                m_aEd_SecondaryYAxis;
 };
 
 //.............................................................................
--- chart2/source/controller/dialogs/res_Titlesx_tmpl.hrc	2007-08-17 17:07:28.000000000 +0200
+++ chart2/source/controller/dialogs/res_Titlesx_tmpl.hrc	2008-01-14 16:48:53.000000000 +0100
@@ -39,77 +39,119 @@
 #include "HelpIds.hrc"
 
 #define TITLES_HEIGHT 12
+#define indentLabel 3
+#define fixedLinesHeight RSC_CD_FIXEDLINE_HEIGHT
 
-#define TITLES( xpos, ypos, editwidth, namefieldwidth ) \
+#define TITLES( xpos, ypos, availableWidth, indentLabel, fixedLinesHeight ) \
 Edit ED_MAINTITLE \
 { \
     HelpID = HID_SCH_TITLE_MAIN; \
 	Border = TRUE ; \
-    Pos = MAP_APPFONT ( xpos+namefieldwidth+4 , ypos  ) ; \
-	Size = MAP_APPFONT ( editwidth , TITLES_HEIGHT ) ; \
+    Pos = MAP_APPFONT ( xpos+indentLabel+(availableWidth-2*indentLabel-4)/2+4 , ypos  ) ; \
+	Size = MAP_APPFONT ( (availableWidth-2*indentLabel-4)/2 , TITLES_HEIGHT ) ; \
 	TabStop = TRUE ; \
 }; \
 Edit ED_SUBTITLE \
 { \
     HelpID = HID_SCH_TITLE_SUB; \
 	Border = TRUE ; \
-    Pos = MAP_APPFONT ( xpos+namefieldwidth+4 , ypos+TITLES_HEIGHT+4 ) ; \
-	Size = MAP_APPFONT ( editwidth , TITLES_HEIGHT ) ; \
+    Pos = MAP_APPFONT ( xpos+indentLabel+(availableWidth-2*indentLabel-4)/2+4 , ypos+TITLES_HEIGHT+4 ) ; \
+	Size = MAP_APPFONT ( (availableWidth-2*indentLabel-4)/2 , TITLES_HEIGHT ) ; \
 	TabStop = TRUE ; \
 }; \
 Edit ED_X_AXIS \
 { \
     HelpID = HID_SCH_TITLE_X; \
 	Border = TRUE ; \
-    Pos = MAP_APPFONT ( xpos+namefieldwidth+4 , ypos+2*(TITLES_HEIGHT+4)  ) ; \
-	Size = MAP_APPFONT ( editwidth , TITLES_HEIGHT ) ; \
+    Pos = MAP_APPFONT ( xpos+indentLabel+(availableWidth-2*indentLabel-4)/2+4 , ypos+2*(TITLES_HEIGHT+4)+4+(fixedLinesHeight+3)  ) ; \
+	Size = MAP_APPFONT ( (availableWidth-2*indentLabel-4)/2 , TITLES_HEIGHT ) ; \
 	TabStop = TRUE ; \
 }; \
 Edit ED_Y_AXIS \
 { \
     HelpID = HID_SCH_TITLE_Y; \
 	Border = TRUE ; \
-    Pos = MAP_APPFONT ( xpos+namefieldwidth+4 , ypos+3*(TITLES_HEIGHT+4)  ) ; \
-	Size = MAP_APPFONT ( editwidth , TITLES_HEIGHT ) ; \
+    Pos = MAP_APPFONT ( xpos+indentLabel+(availableWidth-2*indentLabel-4)/2+4 , ypos+3*(TITLES_HEIGHT+4)+4+(fixedLinesHeight+3)  ) ; \
+	Size = MAP_APPFONT ( (availableWidth-2*indentLabel-4)/2 , TITLES_HEIGHT ) ; \
 	TabStop = TRUE ; \
 }; \
 Edit ED_Z_AXIS \
 { \
     HelpID = HID_SCH_TITLE_Z; \
 	Border = TRUE ; \
-    Pos = MAP_APPFONT ( xpos+namefieldwidth+4 , ypos+4*(TITLES_HEIGHT+4)  ) ; \
-	Size = MAP_APPFONT ( editwidth , TITLES_HEIGHT ) ; \
+    Pos = MAP_APPFONT ( xpos+indentLabel+(availableWidth-2*indentLabel-4)/2+4 , ypos+4*(TITLES_HEIGHT+4)+4+(fixedLinesHeight+3)  ) ; \
+	Size = MAP_APPFONT ( (availableWidth-2*indentLabel-4)/2 , TITLES_HEIGHT ) ; \
 	TabStop = TRUE ; \
 }; \
+Edit ED_SECONDARY_X_AXIS \
+{ \
+    HelpID = HID_SCH_TITLE_SECONDARY_X; \
+    Border = TRUE ; \
+    Pos = MAP_APPFONT ( xpos+indentLabel+(availableWidth-2*indentLabel-4)/2+4 , ypos+5*(TITLES_HEIGHT+4)+8+2*(fixedLinesHeight+3)  ) ; \
+    Size = MAP_APPFONT ( (availableWidth-2*indentLabel-4)/2 , TITLES_HEIGHT ) ; \
+    TabStop = TRUE ; \
+}; \
+Edit ED_SECONDARY_Y_AXIS \
+{ \
+    HelpID = HID_SCH_TITLE_SECONDARY_Y; \
+    Border = TRUE ; \
+    Pos = MAP_APPFONT ( xpos+indentLabel+(availableWidth-2*indentLabel-4)/2+4 , ypos+6*(TITLES_HEIGHT+4)+8+2*(fixedLinesHeight+3)  ) ; \
+    Size = MAP_APPFONT ( (availableWidth-2*indentLabel-4)/2 , TITLES_HEIGHT ) ; \
+    TabStop = TRUE ; \
+}; \
 FixedText FT_MAINTITLE \
 { \
-	Pos = MAP_APPFONT ( xpos , ypos+2  ) ; \
-    Size = MAP_APPFONT ( namefieldwidth , TITLES_HEIGHT ) ; \
+	Pos = MAP_APPFONT ( xpos+indentLabel , ypos+2  ) ; \
+    Size = MAP_APPFONT ( (availableWidth-2*indentLabel-4)/2 , TITLES_HEIGHT ) ; \
 	Text [ en-US ] = "~Title" ; \
 }; \
 FixedText FT_SUBTITLE \
 { \
-	Pos = MAP_APPFONT ( xpos , ypos+2+TITLES_HEIGHT+4  ) ; \
-    Size = MAP_APPFONT ( namefieldwidth , TITLES_HEIGHT ) ; \
+	Pos = MAP_APPFONT ( xpos+indentLabel , ypos+2+TITLES_HEIGHT+4  ) ; \
+    Size = MAP_APPFONT ( (availableWidth-2*indentLabel-4)/2 , TITLES_HEIGHT ) ; \
 	Text [ en-US ] = "~Subtitle" ; \
 }; \
+FixedLine FL_AXES \
+{ \
+    Pos = MAP_APPFONT( xpos ,ypos+2+2*(TITLES_HEIGHT+4)+0  ); \
+    Size = MAP_APPFONT( availableWidth ,fixedLinesHeight ); \
+    Text[ en-US ] = "Axes"; \
+}; \
 FixedText FT_TITLE_X_AXIS \
 { \
-	Pos = MAP_APPFONT ( xpos , ypos+2+2*(TITLES_HEIGHT+4)  ) ; \
-    Size = MAP_APPFONT ( namefieldwidth , TITLES_HEIGHT ) ; \
+	Pos = MAP_APPFONT ( xpos+indentLabel , ypos+2+2*(TITLES_HEIGHT+4)+4+(fixedLinesHeight+3)  ) ; \
+    Size = MAP_APPFONT ( (availableWidth-2*indentLabel-4)/2 , TITLES_HEIGHT ) ; \
 	Text [ en-US ] = "~X axis" ; \
 }; \
 FixedText FT_TITLE_Y_AXIS \
 { \
-	Pos = MAP_APPFONT ( xpos , ypos+2+3*(TITLES_HEIGHT+4)  ) ; \
-    Size = MAP_APPFONT ( namefieldwidth , TITLES_HEIGHT ) ; \
+	Pos = MAP_APPFONT ( xpos+indentLabel , ypos+2+3*(TITLES_HEIGHT+4)+4+(fixedLinesHeight+3)  ) ; \
+    Size = MAP_APPFONT ( (availableWidth-2*indentLabel-4)/2 , TITLES_HEIGHT ) ; \
 	Text [ en-US ] = "~Y axis" ; \
 }; \
 FixedText FT_TITLE_Z_AXIS \
 { \
-	Pos = MAP_APPFONT ( xpos , ypos+2+4*(TITLES_HEIGHT+4)  ) ; \
-    Size = MAP_APPFONT ( namefieldwidth , TITLES_HEIGHT ) ; \
+	Pos = MAP_APPFONT ( xpos+indentLabel , ypos+2+4*(TITLES_HEIGHT+4)+4+(fixedLinesHeight+3)  ) ; \
+    Size = MAP_APPFONT ( (availableWidth-2*indentLabel-4)/2 , TITLES_HEIGHT ) ; \
 	Text [ en-US ] = "~Z axis" ; \
+}; \
+FixedLine FL_SECONDARY_AXES \
+{ \
+    Pos = MAP_APPFONT( xpos ,ypos+2+5*(TITLES_HEIGHT+4)+3+(fixedLinesHeight+3)  ); \
+    Size = MAP_APPFONT( availableWidth ,fixedLinesHeight ); \
+    Text[ en-US ] = "Secondary Axes"; \
+}; \
+FixedText FT_TITLE_SECONDARY_X_AXIS \
+{ \
+    Pos = MAP_APPFONT ( xpos+indentLabel , ypos+2+5*(TITLES_HEIGHT+4)+8+2*(fixedLinesHeight+3)  ) ; \
+    Size = MAP_APPFONT ( (availableWidth-2*indentLabel-4)/2 , TITLES_HEIGHT ) ; \
+    Text [ en-US ] = "X ~axis" ; \
+}; \
+FixedText FT_TITLE_SECONDARY_Y_AXIS \
+{ \
+    Pos = MAP_APPFONT ( xpos+indentLabel , ypos+2+6*(TITLES_HEIGHT+4)+8+2*(fixedLinesHeight+3)  ) ; \
+    Size = MAP_APPFONT ( (availableWidth-2*indentLabel-4)/2 , TITLES_HEIGHT ) ; \
+    Text [ en-US ] = "Y ax~is" ; \
 };
 
 #endif
--- chart2/source/controller/dialogs/res_Trendline.cxx	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/res_Trendline.cxx	2008-01-14 13:27:44.000000000 +0100
@@ -0,0 +1,306 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: res_Trendline.cxx,v $
+ *
+ *  $Revision: 1.1.2.4 $
+ *
+ *  last change: $Author: bm $ $Date: 2008/01/14 12:27:44 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+// MARKER(update_precomp.py): autogen include statement, do not remove
+#include "precompiled_chart2.hxx"
+
+#include "dlg_InsertTrendline.hrc"
+#include "res_Trendline.hxx"
+#include "res_Trendline_IDs.hrc"
+#include "ResId.hxx"
+#include "Strings.hrc"
+#include "Bitmaps.hrc"
+#include "Bitmaps_HC.hrc"
+#include "chartview/ChartSfxItemIds.hxx"
+
+#include <vector>
+#include <algorithm>
+
+// macro for selecting a normal or high contrast bitmap the stack variable
+// bIsHighContrast must exist and reflect the correct state
+#define SELECT_BITMAP(name) Bitmap( SchResId( bIsHighContrast ? name ## _HC : name ))
+
+namespace
+{
+void lcl_InterpolateFixedBitmap( FixedBitmap & rBitmap )
+{
+    Bitmap aBmp( rBitmap.GetBitmap() );
+    Size aSize = rBitmap.GetSizePixel();
+    aBmp.Scale( aSize, BMP_SCALE_INTERPOLATE );
+    rBitmap.SetBitmap( aBmp );
+}
+
+template< class T >
+    long lcl_getRightEdge( T & rControl )
+{
+    return rControl.CalcMinimumSize().Width() + rControl.GetPosPixel().X() - rControl.GetParent()->GetPosPixel().X();
+}
+
+template< class T >
+    void lcl_AdjustControlSize( T & rControl )
+{
+    Size aSize( rControl.GetSizePixel());
+    aSize.setWidth( rControl.CalcMinimumSize().Width());
+    rControl.SetSizePixel( aSize );
+}
+
+void lcl_AdjustControlSize( Control & rControl, long nRightEdge )
+{
+    Size aSize( rControl.GetSizePixel());
+    Point aPosition( rControl.GetPosPixel());
+    aSize.setWidth( nRightEdge - aPosition.getX());
+    rControl.SetSizePixel( aSize );
+}
+
+} // anonymous namespace
+
+namespace chart
+{
+
+enum StatTrendLine
+{
+    TRENDLINE_NONE,
+    TRENDLINE_LINE,
+    TRENDLINE_LOG,
+    TRENDLINE_EXP,
+    TRENDLINE_POW
+};
+
+TrendlineResources::TrendlineResources( Window * pParent, const SfxItemSet& rInAttrs, bool bNoneAvailable ) :
+        m_aFLType( pParent, SchResId( FL_TYPE )),
+
+        m_aRBNone( pParent, SchResId( RB_NONE )),
+        m_aRBLinear( pParent, SchResId( RB_LINEAR )),
+        m_aRBLogarithmic( pParent, SchResId( RB_LOGARITHMIC )),
+        m_aRBExponential( pParent, SchResId( RB_EXPONENTIAL )),
+        m_aRBPower( pParent, SchResId( RB_POWER )),
+
+        m_aFBNone( pParent, SchResId( FB_NONE )),
+        m_aFBLinear( pParent, SchResId( FB_LINEAR )),
+        m_aFBLogarithmic( pParent, SchResId( FB_LOGARITHMIC )),
+        m_aFBExponential( pParent, SchResId( FB_EXPONENTIAL )),
+        m_aFBPower( pParent, SchResId( FB_POWER )),
+
+        m_aFLEquation( pParent, SchResId( FL_EQUATION )),
+        m_aCBShowEquation( pParent, SchResId( CB_SHOW_EQUATION )),
+        m_aCBShowCorrelationCoeff( pParent, SchResId( CB_SHOW_CORRELATION_COEFF )),
+        m_eTrendLineType( CHREGRESS_NONE ),
+        m_bNoneAvailable( bNoneAvailable ),
+        m_bTrendLineUnique( true )
+{
+    FillValueSets();
+
+    lcl_InterpolateFixedBitmap( m_aFBLinear );
+    lcl_InterpolateFixedBitmap( m_aFBLogarithmic );
+    lcl_InterpolateFixedBitmap( m_aFBExponential );
+    lcl_InterpolateFixedBitmap( m_aFBPower );
+
+    if( m_bNoneAvailable )
+    {
+        m_aRBNone.SetClickHdl( LINK(this, TrendlineResources, SelectTrendLine ));
+        lcl_InterpolateFixedBitmap( m_aFBNone );
+    }
+    else
+        m_aRBNone.Hide();
+
+    m_aRBLinear.SetClickHdl( LINK(this, TrendlineResources, SelectTrendLine ));
+    m_aRBLogarithmic.SetClickHdl( LINK(this, TrendlineResources, SelectTrendLine ));
+    m_aRBExponential.SetClickHdl( LINK(this, TrendlineResources, SelectTrendLine ));
+    m_aRBPower.SetClickHdl( LINK(this, TrendlineResources, SelectTrendLine ));
+
+    Reset( rInAttrs );
+    UpdateControlStates();
+}
+
+TrendlineResources::~TrendlineResources()
+{}
+
+long TrendlineResources::adjustControlSizes()
+{
+    // calculate right edge
+    ::std::vector< long > aControlRightEdges;
+    aControlRightEdges.push_back( lcl_getRightEdge( m_aRBNone ));
+    aControlRightEdges.push_back( lcl_getRightEdge( m_aRBLinear ));
+    aControlRightEdges.push_back( lcl_getRightEdge( m_aRBLogarithmic ));
+    aControlRightEdges.push_back( lcl_getRightEdge( m_aRBExponential ));
+    aControlRightEdges.push_back( lcl_getRightEdge( m_aRBPower ));
+    aControlRightEdges.push_back( lcl_getRightEdge( m_aCBShowEquation ));
+    aControlRightEdges.push_back( lcl_getRightEdge( m_aCBShowCorrelationCoeff ));
+
+    lcl_AdjustControlSize( m_aRBNone );
+    lcl_AdjustControlSize( m_aRBLinear );
+    lcl_AdjustControlSize( m_aRBLogarithmic );
+    lcl_AdjustControlSize( m_aRBExponential );
+    lcl_AdjustControlSize( m_aRBPower );
+    lcl_AdjustControlSize( m_aCBShowEquation );
+    lcl_AdjustControlSize( m_aCBShowCorrelationCoeff );
+
+    // Note: FixedLine has no CalcMinimumSize, workaround: use a FixedText
+    FixedText aDummyTextCtrl( m_aFLType.GetParent());
+    aDummyTextCtrl.SetText( m_aFLType.GetText());
+    aControlRightEdges.push_back( lcl_getRightEdge( aDummyTextCtrl ));
+    aDummyTextCtrl.SetText( m_aFLEquation.GetText());
+    aControlRightEdges.push_back( lcl_getRightEdge( aDummyTextCtrl ));
+
+    long nRightEdgeOfControls = *(::std::max_element( aControlRightEdges.begin(), aControlRightEdges.end()));
+    // leave some more space after the longest text
+    nRightEdgeOfControls += m_aFLType.LogicToPixel( Size( 6, 0 ), MapMode( MAP_APPFONT )).getWidth();
+
+    lcl_AdjustControlSize( m_aFLType, nRightEdgeOfControls );
+    lcl_AdjustControlSize( m_aFLEquation, nRightEdgeOfControls );
+
+    return nRightEdgeOfControls;
+}
+
+IMPL_LINK( TrendlineResources, SelectTrendLine, RadioButton *, pRadioButton )
+{
+    if( pRadioButton == &m_aRBLinear )
+        m_eTrendLineType = CHREGRESS_LINEAR;
+    else if( pRadioButton == &m_aRBLogarithmic )
+        m_eTrendLineType = CHREGRESS_LOG;
+    else if( pRadioButton == &m_aRBExponential )
+        m_eTrendLineType = CHREGRESS_EXP;
+    else if( pRadioButton == &m_aRBPower )
+        m_eTrendLineType = CHREGRESS_POWER;
+    else if( pRadioButton == &m_aRBNone )
+    {
+        OSL_ASSERT( m_bNoneAvailable );
+        m_eTrendLineType = CHREGRESS_NONE;
+    }
+    m_bTrendLineUnique = true;
+
+    UpdateControlStates();
+
+    return 0;
+}
+
+void TrendlineResources::Reset( const SfxItemSet& rInAttrs )
+{
+	const SfxPoolItem *pPoolItem = NULL;
+    SfxItemState aState = SFX_ITEM_UNKNOWN;
+
+	aState = rInAttrs.GetItemState( SCHATTR_STAT_REGRESSTYPE, TRUE, &pPoolItem );
+    m_bTrendLineUnique = ( aState != SFX_ITEM_DONTCARE );
+    if( aState == SFX_ITEM_SET )
+    {
+        const SvxChartRegressItem * pItem = dynamic_cast< const SvxChartRegressItem * >( pPoolItem );
+        if( pItem )
+            m_eTrendLineType = pItem->GetValue();
+    }
+
+    aState = rInAttrs.GetItemState( SCHATTR_REGRESSION_SHOW_EQUATION, TRUE, &pPoolItem );
+    if( aState == SFX_ITEM_DONTCARE )
+    {
+        m_aCBShowEquation.EnableTriState( TRUE );
+        m_aCBShowEquation.SetState( STATE_DONTKNOW );
+    }
+    else
+    {
+        m_aCBShowEquation.EnableTriState( FALSE );
+        if( aState == SFX_ITEM_SET )
+            m_aCBShowEquation.Check( static_cast< const SfxBoolItem * >( pPoolItem )->GetValue());
+    }
+
+    aState = rInAttrs.GetItemState( SCHATTR_REGRESSION_SHOW_COEFF, TRUE, &pPoolItem );
+    if( aState == SFX_ITEM_DONTCARE )
+    {
+        m_aCBShowCorrelationCoeff.EnableTriState( TRUE );
+        m_aCBShowCorrelationCoeff.SetState( STATE_DONTKNOW );
+    }
+    else
+    {
+        m_aCBShowCorrelationCoeff.EnableTriState( FALSE );
+        if( aState == SFX_ITEM_SET )
+            m_aCBShowCorrelationCoeff.Check( static_cast< const SfxBoolItem * >( pPoolItem )->GetValue());
+    }
+
+    if( m_bTrendLineUnique )
+    {
+        switch( m_eTrendLineType )
+        {
+            case CHREGRESS_LINEAR :
+                m_aRBLinear.Check();
+                break;
+            case CHREGRESS_LOG :
+                m_aRBLogarithmic.Check();
+                break;
+            case CHREGRESS_EXP :
+                m_aRBExponential.Check();
+                break;
+            case CHREGRESS_POWER :
+                m_aRBPower.Check();
+                break;
+            case CHREGRESS_NONE:
+                OSL_ASSERT( m_bNoneAvailable );
+                m_aRBNone.Check();
+                break;
+        }
+    }
+}
+
+BOOL TrendlineResources::FillItemSet(SfxItemSet& rOutAttrs) const
+{
+    if( m_bTrendLineUnique )
+        rOutAttrs.Put( SvxChartRegressItem( m_eTrendLineType, SCHATTR_STAT_REGRESSTYPE ));
+    if( m_aCBShowEquation.GetState() != STATE_DONTKNOW )
+        rOutAttrs.Put( SfxBoolItem( SCHATTR_REGRESSION_SHOW_EQUATION, m_aCBShowEquation.IsChecked() ));
+    if( m_aCBShowCorrelationCoeff.GetState() != STATE_DONTKNOW )
+        rOutAttrs.Put( SfxBoolItem( SCHATTR_REGRESSION_SHOW_COEFF, m_aCBShowCorrelationCoeff.IsChecked() ));
+	return TRUE;
+}
+
+void TrendlineResources::FillValueSets()
+{
+    bool bIsHighContrast = ( true && m_aFLType.GetDisplayBackground().GetColor().IsDark() );
+
+    if( m_bNoneAvailable )
+        m_aFBNone.SetBitmap( SELECT_BITMAP( BMP_REGRESSION_NONE ));
+    m_aFBLinear.SetBitmap( SELECT_BITMAP( BMP_REGRESSION_LINEAR ));
+    m_aFBLogarithmic.SetBitmap( SELECT_BITMAP( BMP_REGRESSION_LOG ));
+    m_aFBExponential.SetBitmap( SELECT_BITMAP( BMP_REGRESSION_EXP ));
+    m_aFBPower.SetBitmap( SELECT_BITMAP( BMP_REGRESSION_POWER ));
+}
+
+void TrendlineResources::UpdateControlStates()
+{
+    if( m_bNoneAvailable )
+    {
+        bool bEnableEquationControls = !m_bTrendLineUnique || (m_eTrendLineType != CHREGRESS_NONE);
+        m_aCBShowEquation.Enable( bEnableEquationControls );
+        m_aCBShowCorrelationCoeff.Enable( bEnableEquationControls );
+    }
+}
+
+} //  namespace chart
--- chart2/source/controller/dialogs/res_Trendline.hxx	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/res_Trendline.hxx	2008-01-14 13:15:55.000000000 +0100
@@ -0,0 +1,91 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: res_Trendline.hxx,v $
+ *
+ *  $Revision: 1.1.2.3 $
+ *
+ *  last change: $Author: bm $ $Date: 2008/01/14 12:15:55 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#ifndef CHART2_RES_TRENDLINE_HXX
+#define CHART2_RES_TRENDLINE_HXX
+
+#include <vcl/window.hxx>
+#include <vcl/button.hxx>
+#include <vcl/fixed.hxx>
+#include <svtools/valueset.hxx>
+#include <svtools/itemset.hxx>
+#include <svx/chrtitem.hxx>
+
+namespace chart
+{
+
+class TrendlineResources
+{
+public:
+    TrendlineResources( Window* pParent, const SfxItemSet& rInAttrs, bool bNoneAvailable );
+    virtual ~TrendlineResources();
+
+    void Reset(const SfxItemSet& rInAttrs);
+    BOOL FillItemSet(SfxItemSet& rOutAttrs) const;
+
+    void FillValueSets();
+
+    long adjustControlSizes();
+
+private:
+    FixedLine m_aFLType;
+    RadioButton m_aRBNone;
+    RadioButton m_aRBLinear;
+    RadioButton m_aRBLogarithmic;
+    RadioButton m_aRBExponential;
+    RadioButton m_aRBPower;
+
+    FixedBitmap m_aFBNone;
+    FixedBitmap m_aFBLinear;
+    FixedBitmap m_aFBLogarithmic;
+    FixedBitmap m_aFBExponential;
+    FixedBitmap m_aFBPower;
+
+    FixedLine m_aFLEquation;
+    CheckBox m_aCBShowEquation;
+    CheckBox m_aCBShowCorrelationCoeff;
+
+    SvxChartRegress     m_eTrendLineType;
+
+    bool                m_bNoneAvailable;
+    bool                m_bTrendLineUnique;
+
+    void UpdateControlStates();
+    DECL_LINK( SelectTrendLine, RadioButton * );
+};
+
+} //  namespace chart
+
+// CHART2_RES_TRENDLINE_HXX
+#endif
--- chart2/source/controller/dialogs/res_Trendline_IDs.hrc	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/res_Trendline_IDs.hrc	2008-01-11 16:58:42.000000000 +0100
@@ -0,0 +1,52 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: res_Trendline_IDs.hrc,v $
+ *
+ *  $Revision: 1.1.2.2 $
+ *
+ *  last change: $Author: bm $ $Date: 2008/01/11 15:58:42 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#define FL_TYPE 1
+#define FL_EQUATION 2
+
+#define FB_NONE 1
+#define FB_LINEAR 2
+#define FB_LOGARITHMIC 3
+#define FB_EXPONENTIAL 4
+#define FB_POWER 5
+
+#define RB_NONE 1
+#define RB_LINEAR 2
+#define RB_LOGARITHMIC 3
+#define RB_EXPONENTIAL 4
+#define RB_POWER 5
+
+#define CB_SHOW_EQUATION 1
+#define CB_SHOW_CORRELATION_COEFF 2
--- chart2/source/controller/dialogs/res_Trendline_tmpl.hrc	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/res_Trendline_tmpl.hrc	2008-01-15 10:25:42.000000000 +0100
@@ -0,0 +1,151 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: res_Trendline_tmpl.hrc,v $
+ *
+ *  $Revision: 1.1.2.5 $
+ *
+ *  last change: $Author: bm $ $Date: 2008/01/15 09:25:42 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#ifndef _CHART2_RESOURCE_TRENDLINE_HXX
+#define _CHART2_RESOURCE_TRENDLINE_HXX
+
+#include "res_Trendline_IDs.hrc"
+#include "HelpIds.hrc"
+
+#define RESOURCE_TRENDLINE(availablewidth, yoffset) \
+FixedLine FL_TYPE \
+{ \
+    Pos = MAP_APPFONT( 6 ,6  ); \
+    Size = MAP_APPFONT( availablewidth - 12 ,8 ); \
+    Text[ en-US ] = "Regression Type"; \
+}; \
+RadioButton RB_NONE \
+{ \
+    HelpId = HID_SCH_TRENDLINE_RB_NONE; \
+    Pos = MAP_APPFONT( 29, 22  ); \
+    Size = MAP_APPFONT( 100, 10 ); \
+    Text[ en-US ] = "~None"; \
+}; \
+RadioButton RB_LINEAR \
+{ \
+    HelpId = HID_SCH_TRENDLINE_RB_LINEAR; \
+    Pos = MAP_APPFONT( 29, 22 + yoffset ); \
+    Size = MAP_APPFONT( 100, 10 ); \
+    Text[ en-US ] = "~Linear"; \
+}; \
+RadioButton RB_LOGARITHMIC \
+{ \
+    HelpId = HID_SCH_TRENDLINE_RB_LOGARITHMIC; \
+    Pos = MAP_APPFONT( 29, 44  + yoffset ); \
+    Size = MAP_APPFONT( 100, 10 ); \
+    Text[ en-US ] = "L~ogarithmic"; \
+}; \
+RadioButton RB_EXPONENTIAL \
+{ \
+    HelpId = HID_SCH_TRENDLINE_RB_EXPONENTIAL; \
+    Pos = MAP_APPFONT( 29, 66 + yoffset  ); \
+    Size = MAP_APPFONT( 100, 10 ); \
+    Text[ en-US ] = "E~xponential"; \
+}; \
+RadioButton RB_POWER \
+{ \
+    HelpId = HID_SCH_TRENDLINE_RB_POWER; \
+    Pos = MAP_APPFONT( 29, 88 + yoffset ); \
+    Size = MAP_APPFONT( 100, 10 ); \
+    Text[ en-US ] = "~Power"; \
+}; \
+FixedBitmap FB_NONE \
+{ \
+    OutputSize = TRUE ; \
+    Scale = TRUE; \
+    Border = FALSE; \
+    Pos = MAP_APPFONT( 10, 18 ); \
+    Size = MAP_APPFONT( 16, 17 ); \
+    Fixed = Bitmap { File = "regno.png" ; }; \
+}; \
+FixedBitmap FB_LINEAR \
+{ \
+    OutputSize = TRUE ; \
+    Scale = TRUE; \
+    Border = FALSE; \
+    Pos = MAP_APPFONT( 10, 18 + yoffset ); \
+    Size = MAP_APPFONT( 16, 17 ); \
+    Fixed = Bitmap { File = "reglin.png" ; }; \
+}; \
+FixedBitmap FB_LOGARITHMIC \
+{ \
+    OutputSize = TRUE ; \
+    Scale = TRUE; \
+    Border = FALSE; \
+    Pos = MAP_APPFONT( 10, 40 + yoffset ); \
+    Size = MAP_APPFONT( 16, 17 ); \
+    Fixed = Bitmap { File = "reglog.png" ; }; \
+}; \
+FixedBitmap FB_EXPONENTIAL \
+{ \
+    OutputSize = TRUE ; \
+    Scale = TRUE; \
+    Border = FALSE; \
+    Pos = MAP_APPFONT( 10, 62 + yoffset ); \
+    Size = MAP_APPFONT( 16, 17 ); \
+    Fixed = Bitmap { File = "regexp.png" ; }; \
+}; \
+FixedBitmap FB_POWER \
+{ \
+    OutputSize = TRUE ; \
+    Scale = TRUE; \
+    Border = FALSE; \
+    Pos = MAP_APPFONT( 10, 84 + yoffset ); \
+    Size = MAP_APPFONT( 16, 17 ); \
+    Fixed = Bitmap { File = "regpow.png" ; }; \
+}; \
+FixedLine FL_EQUATION \
+{ \
+    Pos = MAP_APPFONT( 6, 108 + yoffset ); \
+    Size = MAP_APPFONT( availablewidth - 12, 8 ); \
+    Text[ en-US ] = "Equation"; \
+}; \
+CheckBox CB_SHOW_EQUATION \
+{ \
+    HelpId = HID_SCH_TRENDLINE_SHOW_EQUATION; \
+    Pos = MAP_APPFONT( 10, 120 + yoffset ); \
+    Size = MAP_APPFONT( availablewidth - 20, 10 ); \
+    TabStop = TRUE; \
+    Text[ en-US ] = "Show ~equation"; \
+}; \
+CheckBox CB_SHOW_CORRELATION_COEFF \
+{ \
+    HelpId = HID_SCH_TRENDLINE_SHOW_R_SQUARED; \
+    Pos = MAP_APPFONT( 10, 134 + yoffset ); \
+    Size = MAP_APPFONT( availablewidth - 20, 10 ); \
+    TabStop = TRUE; \
+    Text[ en-US ] = "Show ~correlation coefficient (R²)"; \
+};
+
+#endif
--- chart2/source/controller/dialogs/Strings_ChartTypes.src	2007-05-22 19:30:34.000000000 +0200
+++ chart2/source/controller/dialogs/Strings_ChartTypes.src	2008-01-11 15:11:40.000000000 +0100
@@ -137,7 +137,7 @@
 };
 String STR_PERCENT
 {
-	Text [ en-US ] = "Percent stacked" ;
+	Text [ en-US ] = "Percent Stacked" ;
 };
 
 String STR_DEEP
--- chart2/source/controller/dialogs/Strings.src	2007-11-23 12:46:16.000000000 +0100
+++ chart2/source/controller/dialogs/Strings.src	2008-01-15 16:45:28.000000000 +0100
@@ -100,37 +100,47 @@
 };
 
 String STR_PAGE_NUMBERS
-{	
+{
 	Text [ en-US ] = "Numbers" ;
 };
 
 String STR_PAGE_POSITION
-{	
+{
 	Text [ en-US ] = "Position" ;
 };
 
 String STR_PAGE_LAYOUT
-{	
+{
 	Text [ en-US ] = "Layout";
 };
 
 String STR_PAGE_OPTIONS
-{	
+{
 	Text [ en-US ] = "Options";
 };
 
 String STR_PAGE_SCALE
-{	
+{
 	Text [ en-US ] = "Scale" ;
 };
 
-String STR_PAGE_STATISTICS
+// String STR_PAGE_STATISTICS
+// {
+// 	Text [ en-US ] = "Statistics" ;
+// };
+
+String STR_PAGE_TRENDLINE_TYPE
+{
+    Text[ en-US ] = "Type";
+};
+
+String STR_PAGE_YERROR_BARS
 {
-	Text [ en-US ] = "Statistics" ;
+    Text[ en-US ] = "Y Error Bars";
 };
 
 String STR_PAGE_ALIGNMENT
-{	
+{
 	Text [ en-US ] = "Alignment" ;
 };
 
@@ -148,11 +158,7 @@
 };
 String STR_OBJECT_AVERAGE_LINE_WITH_PARAMETERS
 {
-    Text [ en-US ] = "Average value line with value %AVERAGE_VALUE and standard deviation %STD_DEVIATION";
-};
-String STR_PAGE_REGRESSION_OPTIONS
-{
-	Text [ en-US ] = "Equation";
+    Text [ en-US ] = "Mean value line with value %AVERAGE_VALUE and standard deviation %STD_DEVIATION";
 };
 
 String STR_OBJECT_AXIS
@@ -242,6 +248,14 @@
 {
 	Text [ en-US ] = "Z Axis Title" ;
 };
+String STR_OBJECT_TITLE_SECONDARY_X_AXIS
+{
+    Text [ en-US ] = "Secondary X Axis Title" ;
+};
+String STR_OBJECT_TITLE_SECONDARY_Y_AXIS
+{
+    Text [ en-US ] = "Secondary Y Axis Title" ;
+};
 String STR_OBJECT_LABEL
 {
 	Text [ en-US ] = "Label" ;
@@ -271,18 +285,21 @@
 {
 	Text [ en-US ] = "Data Series" ;
 };
-
 String STR_OBJECT_CURVE
 {
-	Text [ en-US ] = "Regression Curve";
+	Text [ en-US ] = "Trend Line";
+};
+String STR_OBJECT_CURVES
+{
+	Text [ en-US ] = "Trend Lines";
 };
 String STR_OBJECT_CURVE_WITH_PARAMETERS
 {
-    Text [ en-US ] = "Regression curve %FORMULA with accuracy R² = %RSQUARED";
+    Text [ en-US ] = "Trend line %FORMULA with accuracy R² = %RSQUARED";
 };
 String STR_OBJECT_AVERAGE_LINE
 {
-	Text [ en-US ] = "Average Value Line";
+	Text [ en-US ] = "Mean Value Line";
 };
 String STR_OBJECT_CURVE_EQUATION
 {
@@ -326,7 +343,7 @@
 //-----------------------------------------------------------------------------
 
 String STR_TIP_SELECT_RANGE
-{  
+{
 	Text [ en-US ] = "Select data range" ;
 };
 
@@ -508,5 +525,10 @@
 	Text [ en-US ] = "Select Range for data labels" ;
 };
 
+String STR_DATA_EDITOR_INCORRECT_INPUT
+{
+	Text [ en-US ] = "Your last input is incorrect.\nIgnore this change and close the dialog?" ;
+};
+
 //-----------------------------------------------------------------------------
 //-----------------------------------------------------------------------------
--- chart2/source/controller/dialogs/Strings_Statistic.src	2007-05-22 19:30:58.000000000 +0200
+++ chart2/source/controller/dialogs/Strings_Statistic.src	2008-01-11 15:12:03.000000000 +0100
@@ -35,21 +35,17 @@
 #include "Strings.hrc"
 
 //SchStatisticTabPage and SchDataStatisticsDlg
-String STR_INDICATE_NONE
-{
-	Text [ en-US ] = "No Indicators" ;
-};
 String STR_INDICATE_BOTH
 {
-	Text [ en-US ] = "Indicators Top and Bottom" ;
+	Text [ en-US ] = "Negative and Positive" ;
 };
 String STR_INDICATE_DOWN
 {
-	Text [ en-US ] = "Lower Indicator" ;
+	Text [ en-US ] = "Negative" ;
 };
 String STR_INDICATE_UP
 {
-	Text [ en-US ] = "Upper Indicator" ;
+	Text [ en-US ] = "Positive" ;
 };
 
 //------------------------------------------------------------------------
@@ -61,11 +57,11 @@
 };
 String STR_REGRESSION_LINEAR
 {
-	Text [ en-US ] = "Linear regression" ;
+	Text [ en-US ] = "Linear Regression" ;
 };
 String STR_REGRESSION_LOG
 {
-	Text [ en-US ] = "Logarithm regression" ;
+	Text [ en-US ] = "Logarithmic Regression" ;
 };
 String STR_REGRESSION_EXP
 {
@@ -73,7 +69,7 @@
 };
 String STR_REGRESSION_POWER
 {
-	Text [ en-US ] = "Power regression" ;
+	Text [ en-US ] = "Power Regression" ;
 };
 
 String STR_STATISTICS_IN_LEGEND
--- chart2/source/controller/dialogs/TitleDialogData.cxx	2007-05-22 19:31:30.000000000 +0200
+++ chart2/source/controller/dialogs/TitleDialogData.cxx	2007-11-20 18:11:12.000000000 +0100
@@ -49,15 +49,15 @@
 using namespace ::com::sun::star::chart2;
 
 TitleDialogData::TitleDialogData( ::std::auto_ptr< ReferenceSizeProvider > apRefSizeProvider )
-        : aPossibilityList(5)
-        , aExistenceList(5)
-        , aTextList(5)
+        : aPossibilityList(7)
+        , aExistenceList(7)
+        , aTextList(7)
         , apReferenceSizeProvider( apRefSizeProvider )
 {
     sal_Int32 nN = 0;
-    for(nN=5;nN--;)
+    for(nN=7;nN--;)
         aPossibilityList[nN]=sal_True;
-    for(nN=5;nN--;)
+    for(nN=7;nN--;)
         aExistenceList[nN]=sal_False;
 }
 
@@ -71,6 +71,8 @@
     this->aPossibilityList[2]=aAxisPossibilityList[0];//x axis title
     this->aPossibilityList[3]=aAxisPossibilityList[1];//y axis title
     this->aPossibilityList[4]=aAxisPossibilityList[2];//z axis title
+    this->aPossibilityList[5]=aAxisPossibilityList[3];//secondary x axis title
+    this->aPossibilityList[6]=aAxisPossibilityList[4];//secondary y axis title
 
     //find out which title exsist and get their text
     //main title:
--- chart2/source/controller/dialogs/tp_AxisLabel.src	2007-09-05 19:38:45.000000000 +0200
+++ chart2/source/controller/dialogs/tp_AxisLabel.src	2007-12-18 15:55:50.000000000 +0100
@@ -44,7 +44,7 @@
 	CheckBox CB_AXIS_LABEL_SCHOW_DESCR
 	{
 		Pos	= MAP_APPFONT ( 6 , 6  ) ;
-		Size	= MAP_APPFONT ( 104 , 12 ) ;
+		Size	= MAP_APPFONT ( 248 , 12 ) ;
 
 		Text [ en-US ] = "Sho~w labels";
 	};
@@ -67,7 +67,7 @@
         {
             HelpId  = HID_SCH_ALIGNMENT_STACKED ;
             Pos     = MAP_APPFONT ( 139 , 105  ) ;
-            Size    = MAP_APPFONT ( 109 , 10 ) ;
+            Size    = MAP_APPFONT ( 115 , 10 ) ;
             TabStop = TRUE ;
 // DR: TODO - after OOo 2.0 - enable localized strings
 //            Text [ de ] = "~Senkrecht gestapelt";
@@ -76,7 +76,7 @@
 		FixedText FT_AXIS_LABEL_DEGREES
 		{
             Pos = MAP_APPFONT ( 93 , 122  ) ;
-            Size = MAP_APPFONT ( 35 , 8 ) ;
+            Size = MAP_APPFONT ( 60 , 8 ) ;
 
 			Text [ en-US ] = "~Degrees" ;
 	};
@@ -124,7 +124,7 @@
 		CheckBox CB_AXIS_LABEL_TEXTOVERLAP
 		{
 			Pos = MAP_APPFONT ( 139 , 33  ) ;
-			Size = MAP_APPFONT ( 76 , 10 ) ;
+			Size = MAP_APPFONT ( 115 , 10 ) ;
 			TabStop	= TRUE ;
 
 			Text [ en-US ] = "O~verlap" ;
@@ -132,7 +132,7 @@
 		CheckBox CB_AXIS_LABEL_TEXTBREAK
 		{
 			Pos = MAP_APPFONT ( 139 , 47  ) ;
-			Size = MAP_APPFONT ( 76 , 10 ) ;
+			Size = MAP_APPFONT ( 115 , 10 ) ;
 			TabStop	= TRUE ;
 
 			Text [ en-US ] = "~Break" ;
@@ -149,7 +149,7 @@
 		RadioButton RB_AXIS_LABEL_SIDEBYSIDE
 		{
 			Pos = MAP_APPFONT ( 12 , 33  ) ;
-			Size = MAP_APPFONT ( 98 , 10 ) ;
+			Size = MAP_APPFONT ( 112 , 10 ) ;
 			TabStop = TRUE ;
 
 			Text [ en-US ] = "~Tile" ;
@@ -157,7 +157,7 @@
 		RadioButton RB_AXIS_LABEL_UPDOWN
 		{
 			Pos = MAP_APPFONT ( 12 , 47  ) ;
-			Size = MAP_APPFONT ( 98 , 10 ) ;
+			Size = MAP_APPFONT ( 112 , 10 ) ;
 			TabStop = TRUE ;
 
 			Text [ en-US ] = "St~agger odd" ;
@@ -165,7 +165,7 @@
 		RadioButton RB_AXIS_LABEL_DOWNUP
 		{
 			Pos = MAP_APPFONT ( 12 , 61  ) ;
-			Size = MAP_APPFONT ( 98 , 10 ) ;
+			Size = MAP_APPFONT ( 112 , 10 ) ;
 			TabStop = TRUE ;
 
 			Text [ en-US ] = "Stagger ~even" ;
@@ -173,7 +173,7 @@
 		RadioButton RB_AXIS_LABEL_AUTOORDER
 		{
 			Pos = MAP_APPFONT ( 12 , 75  ) ;
-			Size = MAP_APPFONT ( 98 , 10 ) ;
+			Size = MAP_APPFONT ( 112 , 10 ) ;
 			TabStop = TRUE ;
 
 			Text [ en-US ] = "A~utomatic" ;
@@ -215,3 +215,5 @@
 
 
 
+
+
--- chart2/source/controller/dialogs/tp_ErrorBars.cxx	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/tp_ErrorBars.cxx	2007-12-20 17:18:32.000000000 +0100
@@ -0,0 +1,95 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: tp_ErrorBars.cxx,v $
+ *
+ *  $Revision: 1.1.2.1 $
+ *
+ *  last change: $Author: bm $ $Date: 2007/12/20 16:18:32 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+// MARKER(update_precomp.py): autogen include statement, do not remove
+#include "precompiled_chart2.hxx"
+
+#include "tp_ErrorBars.hxx"
+#include "ResId.hxx"
+#include "TabPages.hrc"
+
+//.............................................................................
+namespace chart
+{
+//.............................................................................
+
+ErrorBarsTabPage::ErrorBarsTabPage( Window* pParent, const SfxItemSet& rInAttrs ) :
+        SfxTabPage( pParent, SchResId( TP_YERRORBAR ), rInAttrs ),
+        m_aErrorBarResources( this, rInAttrs )
+{
+    FreeResource();
+}
+
+ErrorBarsTabPage::~ErrorBarsTabPage()
+{
+}
+
+SfxTabPage* ErrorBarsTabPage::Create(
+    Window* pParent, const SfxItemSet& rOutAttrs )
+{
+    return new ErrorBarsTabPage( pParent, rOutAttrs );
+}
+
+BOOL ErrorBarsTabPage::FillItemSet( SfxItemSet& rOutAttrs )
+{
+    return m_aErrorBarResources.FillItemSet( rOutAttrs );
+}
+
+void ErrorBarsTabPage::Reset( const SfxItemSet& rInAttrs )
+{
+    m_aErrorBarResources.Reset( rInAttrs );
+}
+
+void ErrorBarsTabPage::DataChanged( const DataChangedEvent& rDCEvt )
+{
+    SfxTabPage::DataChanged( rDCEvt );
+
+    if ( (rDCEvt.GetType() == DATACHANGED_SETTINGS) && (rDCEvt.GetFlags() & SETTINGS_STYLE) )
+        m_aErrorBarResources.FillValueSets();
+}
+
+void ErrorBarsTabPage::SetAxisMinorStepWidthForErrorBarDecimals( double fMinorStepWidth )
+{
+    m_aErrorBarResources.SetAxisMinorStepWidthForErrorBarDecimals( fMinorStepWidth );
+}
+
+void ErrorBarsTabPage::SetErrorBarType( ErrorBarResources::tErrorBarType eNewType )
+{
+    m_aErrorBarResources.SetErrorBarType( eNewType );
+}
+
+//.............................................................................
+} //namespace chart
+//.............................................................................
--- chart2/source/controller/dialogs/tp_ErrorBars.hxx	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/tp_ErrorBars.hxx	2007-12-20 17:18:32.000000000 +0100
@@ -0,0 +1,70 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: tp_ErrorBars.hxx,v $
+ *
+ *  $Revision: 1.1.2.1 $
+ *
+ *  last change: $Author: bm $ $Date: 2007/12/20 16:18:32 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#ifndef _CHART2_TP_ERRORBARS_HXX
+#define _CHART2_TP_ERRORBARS_HXX
+
+#include "res_ErrorBar.hxx"
+
+#include <sfx2/tabdlg.hxx>
+
+//.............................................................................
+namespace chart
+{
+//.............................................................................
+
+class ErrorBarsTabPage : public SfxTabPage
+{
+public:
+    ErrorBarsTabPage ( Window* pParent, const SfxItemSet& rInAttrs );
+    virtual ~ErrorBarsTabPage ();
+
+    void SetAxisMinorStepWidthForErrorBarDecimals( double fMinorStepWidth );
+    void SetErrorBarType( ErrorBarResources::tErrorBarType eNewType );
+
+    static SfxTabPage* Create( Window* pParent, const SfxItemSet& rInAttrs );
+    virtual BOOL FillItemSet( SfxItemSet& rOutAttrs );
+    virtual void Reset( const SfxItemSet& rInAttrs );
+
+    virtual void DataChanged( const DataChangedEvent& rDCEvt );
+
+private:
+    ErrorBarResources   m_aErrorBarResources;
+};
+
+//.............................................................................
+} //namespace chart
+//.............................................................................
+
+#endif
--- chart2/source/controller/dialogs/tp_ErrorBars.src	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/tp_ErrorBars.src	2007-12-20 17:18:32.000000000 +0100
@@ -0,0 +1,46 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: tp_ErrorBars.src,v $
+ *
+ *  $Revision: 1.1.2.1 $
+ *
+ *  last change: $Author: bm $ $Date: 2007/12/20 16:18:32 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#include "HelpIds.hrc"
+#include "TabPages.hrc"
+#include "res_ErrorBar.hrc"
+
+TabPage TP_YERRORBAR
+{
+	Hide = TRUE ;
+// 	HelpID = HID_SCH_STAT ;
+	SVLook = TRUE ;
+	Size = MAP_APPFONT ( 260 , 185 ) ;
+	RESOURCE_ERRORBARS( 260 - 12 )
+};
--- chart2/source/controller/dialogs/tp_PolarOptions.cxx	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/tp_PolarOptions.cxx	2008-01-15 20:19:15.000000000 +0100
@@ -0,0 +1,120 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: tp_PolarOptions.cxx,v $
+ *
+ *  $Revision: 1.1.2.4 $
+ *
+ *  last change: $Author: iha $ $Date: 2008/01/15 19:19:15 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#include "precompiled_chart2.hxx"
+#include "tp_PolarOptions.hxx"
+#include "tp_PolarOptions.hrc"
+#include "ResId.hxx"
+#include "TabPages.hrc"
+#include "chartview/ChartSfxItemIds.hxx"
+#include "NoWarningThisInCTOR.hxx"
+
+#include <svtools/eitem.hxx>
+#include <svtools/intitem.hxx>
+#include <svtools/controldims.hrc>
+
+//.............................................................................
+namespace chart
+{
+//.............................................................................
+
+PolarOptionsTabPage::PolarOptionsTabPage( Window* pWindow,const SfxItemSet& rInAttrs ) :
+    SfxTabPage( pWindow, SchResId(TP_POLAROPTIONS), rInAttrs ),
+    m_aCB_Clockwise( this, SchResId( CB_CLOCKWISE ) ),
+    m_aFL_StartingAngle( this, SchResId( FL_STARTING_ANGLE ) ),
+    m_aAngleDial( this, SchResId( CT_ANGLE_DIAL ) ),
+    m_aFT_Degrees( this, SchResId( FT_ROTATION_DEGREES ) ),
+    m_aNF_StartingAngle( this, SchResId( NF_STARTING_ANGLE ) )
+{
+    FreeResource();
+
+    m_aAngleDial.SetLinkedField( &m_aNF_StartingAngle );
+}
+
+PolarOptionsTabPage::~PolarOptionsTabPage()
+{
+}
+
+SfxTabPage* PolarOptionsTabPage::Create( Window* pWindow,const SfxItemSet& rOutAttrs )
+{
+    return new PolarOptionsTabPage( pWindow, rOutAttrs );
+}
+
+BOOL PolarOptionsTabPage::FillItemSet( SfxItemSet& rOutAttrs )
+{
+    if( m_aAngleDial.IsVisible() )
+    {
+        rOutAttrs.Put(SfxInt32Item(SCHATTR_STARTING_ANGLE,
+            static_cast< sal_Int32 >(m_aAngleDial.GetRotation()/100)));
+    }
+
+    if( m_aCB_Clockwise.IsVisible() )
+        rOutAttrs.Put(SfxInt32Item(SCHATTR_CLOCKWISE,m_aCB_Clockwise.IsChecked()));
+
+    return TRUE;
+}
+
+void PolarOptionsTabPage::Reset(const SfxItemSet& rInAttrs)
+{
+    const SfxPoolItem *pPoolItem = NULL;
+
+    long nTmp;
+    if (rInAttrs.GetItemState(SCHATTR_STARTING_ANGLE, TRUE, &pPoolItem) == SFX_ITEM_SET)
+    {
+        nTmp = (long)((const SfxInt32Item*)pPoolItem)->GetValue();
+
+        m_aAngleDial.SetRotation( nTmp*100 );
+    }
+    else
+    {
+        m_aFL_StartingAngle.Show(FALSE);
+        m_aAngleDial.Show(FALSE);
+        m_aNF_StartingAngle.Show(FALSE);
+        m_aFT_Degrees.Show(FALSE);
+    }
+    if (rInAttrs.GetItemState(SCHATTR_CLOCKWISE, TRUE, &pPoolItem) == SFX_ITEM_SET)
+    {
+        BOOL bCheck = static_cast< const SfxBoolItem * >( pPoolItem )->GetValue();
+        m_aCB_Clockwise.Check(bCheck);
+    }
+    else
+    {
+        m_aCB_Clockwise.Show(FALSE);
+    }
+}
+
+//.............................................................................
+} //namespace chart
+//.............................................................................
--- chart2/source/controller/dialogs/tp_PolarOptions.hrc	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/tp_PolarOptions.hrc	2008-01-10 11:04:17.000000000 +0100
@@ -0,0 +1,44 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: tp_PolarOptions.hrc,v $
+ *
+ *  $Revision: 1.1.2.3 $
+ *
+ *  last change: $Author: iha $ $Date: 2008/01/10 10:04:17 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#define CB_CLOCKWISE 1
+
+#define FL_STARTING_ANGLE 1
+
+#define CT_ANGLE_DIAL 1
+
+#define NF_STARTING_ANGLE 1
+
+#define FT_ROTATION_DEGREES 1
--- chart2/source/controller/dialogs/tp_PolarOptions.hxx	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/tp_PolarOptions.hxx	2008-01-10 11:06:12.000000000 +0100
@@ -0,0 +1,72 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: tp_PolarOptions.hxx,v $
+ *
+ *  $Revision: 1.1.2.3 $
+ *
+ *  last change: $Author: iha $ $Date: 2008/01/10 10:06:12 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#ifndef _CHART2_TP_POLAROPTIONS_HXX
+#define _CHART2_TP_POLAROPTIONS_HXX
+
+#include <sfx2/tabdlg.hxx>
+#include <vcl/fixed.hxx>
+#include <vcl/button.hxx>
+#include <vcl/field.hxx>
+#include <svx/dialcontrol.hxx>
+
+//.............................................................................
+namespace chart
+{
+//.............................................................................
+
+class PolarOptionsTabPage : public SfxTabPage
+{
+
+public:
+    PolarOptionsTabPage(Window* pParent, const SfxItemSet& rInAttrs );
+    virtual ~PolarOptionsTabPage();
+
+    static SfxTabPage* Create(Window* pParent, const SfxItemSet& rInAttrs);
+    virtual BOOL FillItemSet(SfxItemSet& rOutAttrs);
+    virtual void Reset(const SfxItemSet& rInAttrs);
+	
+private:
+    CheckBox         m_aCB_Clockwise;
+    FixedLine        m_aFL_StartingAngle;
+    svx::DialControl m_aAngleDial;
+    FixedText        m_aFT_Degrees;
+    NumericField     m_aNF_StartingAngle;
+};
+
+//.............................................................................
+} //namespace chart
+//.............................................................................
+
+#endif
--- chart2/source/controller/dialogs/tp_PolarOptions.src	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/tp_PolarOptions.src	2008-01-10 11:05:02.000000000 +0100
@@ -0,0 +1,83 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: tp_PolarOptions.src,v $
+ *
+ *  $Revision: 1.1.2.3 $
+ *
+ *  last change: $Author: iha $ $Date: 2008/01/10 10:05:02 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#include "TabPages.hrc"
+#include "tp_PolarOptions.hrc"
+#include "HelpIds.hrc"
+
+TabPage TP_POLAROPTIONS
+{
+	Hide = TRUE ;
+	SVLook = TRUE ;
+	Size = MAP_APPFONT ( 260 , 185 ) ;
+
+    CheckBox CB_CLOCKWISE
+    {
+        Pos = MAP_APPFONT ( 12 , 8  );
+        Size = MAP_APPFONT ( 248 , 10 );
+        TabStop = TRUE;
+        Text [ en-US ] = "~Clockwise direction";
+    };
+    FixedLine FL_STARTING_ANGLE
+    {
+        Pos = MAP_APPFONT ( 12 , 21  ) ;
+        Size = MAP_APPFONT ( 242 , 12 ) ;
+        Text [ en-US ] = "Starting angle" ;
+    };
+    Control CT_ANGLE_DIAL
+    {
+        HelpId	= HID_SCH_STARTING_ANGLE_DIAL ;
+        Pos     = MAP_APPFONT ( 12 , 38  ) ;
+        Size    = MAP_APPFONT ( 43 , 43 ) ;
+    };
+    FixedText FT_ROTATION_DEGREES
+    {
+        Pos = MAP_APPFONT ( 93 , 55  ) ;
+        Size = MAP_APPFONT ( 166 , 8 ) ;
+        Text [ en-US ] = "~Degrees" ;
+    };
+    NumericField NF_STARTING_ANGLE
+    {
+        Pos = MAP_APPFONT ( 61 , 53 ) ;
+        Size = MAP_APPFONT ( 28 , 12 ) ;
+        Border = TRUE ;
+        TabStop = TRUE ;
+        Repeat = TRUE ;
+        Spin = TRUE ;
+        Minimum = 0 ;
+        Maximum = 359 ;
+        SpinSize = 5 ;
+    };
+};
--- chart2/source/controller/dialogs/tp_RegressionOptions.cxx	2007-11-23 12:49:20.000000000 +0100
+++ chart2/source/controller/dialogs/tp_RegressionOptions.cxx	1970-01-01 01:00:00.000000000 +0100
@@ -1,109 +0,0 @@
-/*************************************************************************
- *
- *  OpenOffice.org - a multi-platform office productivity suite
- *
- *  $RCSfile: tp_RegressionOptions.cxx,v $
- *
- *  $Revision: 1.2 $
- *
- *  last change: $Author: ihi $ $Date: 2007/11/23 11:49:20 $
- *
- *  The Contents of this file are made available subject to
- *  the terms of GNU Lesser General Public License Version 2.1.
- *
- *
- *    GNU Lesser General Public License Version 2.1
- *    =============================================
- *    Copyright 2005 by Sun Microsystems, Inc.
- *    901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *    This library is free software; you can redistribute it and/or
- *    modify it under the terms of the GNU Lesser General Public
- *    License version 2.1, as published by the Free Software Foundation.
- *
- *    This library is distributed in the hope that it will be useful,
- *    but WITHOUT ANY WARRANTY; without even the implied warranty of
- *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *    Lesser General Public License for more details.
- *
- *    You should have received a copy of the GNU Lesser General Public
- *    License along with this library; if not, write to the Free Software
- *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *    MA  02111-1307  USA
- *
- ************************************************************************/
-
-// MARKER(update_precomp.py): autogen include statement, do not remove
-#include "precompiled_chart2.hxx"
-
-#include "tp_RegressionOptions.hxx"
-#include "tp_RegressionOptions.hrc"
-#include "ResId.hxx"
-#include "chartview/ChartSfxItemIds.hxx"
-
-// for SfxBoolItem
-#include <svtools/eitem.hxx>
-
-namespace chart
-{
-
-RegressionOptionsTabPage::RegressionOptionsTabPage(
-    Window* pWindow, const SfxItemSet& rInAttrs ) :
-        SfxTabPage( pWindow, SchResId( TP_REGRESSION_OPTIONS ), rInAttrs ),
-        m_aCbxEquation( this, SchResId( CBX_SHOW_EQUATION )),
-        m_aCbxCorrelationCoeff( this, SchResId( CBX_SHOW_CORRELATION_COEFF ))
-//         m_aFlSeparator( this, SchResId( FL_SEPARATOR )),
-//         m_aRbtNewline( this, SchResId( RBT_SEP_NEWLINE  )),
-//         m_aRbtSemicolon( this, SchResId( RBT_SEP_SEMICOLON )),
-//         m_aRbtComma( this, SchResId( RBT_SEP_COMMA )),
-//         m_aRbtSlash( this, SchResId( RBT_SEP_SLASH ))
-{
-    FreeResource();
-
-    m_aCbxEquation.SetToggleHdl( LINK( this, RegressionOptionsTabPage, DisplayOptionChecked ));
-    m_aCbxCorrelationCoeff.SetToggleHdl( LINK( this, RegressionOptionsTabPage, DisplayOptionChecked ));
-
-//     m_aRbtNewline.Check();
-}
-
-RegressionOptionsTabPage::~RegressionOptionsTabPage()
-{}
-
-SfxTabPage* RegressionOptionsTabPage::Create( Window* pWindow,const SfxItemSet& rOutAttrs )
-{
-	return new RegressionOptionsTabPage( pWindow, rOutAttrs );
-}
-
-BOOL RegressionOptionsTabPage::FillItemSet( SfxItemSet& rOutAttrs )
-{
-    rOutAttrs.Put( SfxBoolItem( SCHATTR_REGRESSION_SHOW_EQUATION, m_aCbxEquation.IsChecked()));
-    rOutAttrs.Put( SfxBoolItem( SCHATTR_REGRESSION_SHOW_COEFF, m_aCbxCorrelationCoeff.IsChecked()));
-    return TRUE;
-}
-
-void RegressionOptionsTabPage::Reset( const SfxItemSet& rInAttrs )
-{
-    const SfxBoolItem * pItem = dynamic_cast< const SfxBoolItem * >( rInAttrs.GetItem( SCHATTR_REGRESSION_SHOW_EQUATION ));
-    if( pItem )
-        m_aCbxEquation.Check( pItem->GetValue());
-
-    pItem = dynamic_cast< const SfxBoolItem * >( rInAttrs.GetItem( SCHATTR_REGRESSION_SHOW_COEFF ));
-    if( pItem )
-        m_aCbxCorrelationCoeff.Check( pItem->GetValue());
-
-    DisplayOptionChecked( 0 );
-}
-
-IMPL_LINK( RegressionOptionsTabPage, DisplayOptionChecked, CheckBox *, EMPTYARG )
-{
-//     bool bEnableSeparators = ( m_aCbxEquation.IsChecked() && m_aCbxCorrelationCoeff.IsChecked());
-
-//     m_aRbtNewline.Enable( bEnableSeparators );
-//     m_aRbtSemicolon.Enable( bEnableSeparators );
-//     m_aRbtComma.Enable( bEnableSeparators );
-//     m_aRbtSlash.Enable( bEnableSeparators );
-
-    return 0;
-}
-
-} //  namespace chart
--- chart2/source/controller/dialogs/tp_RegressionOptions.hrc	2007-11-23 12:49:39.000000000 +0100
+++ chart2/source/controller/dialogs/tp_RegressionOptions.hrc	1970-01-01 01:00:00.000000000 +0100
@@ -1,44 +0,0 @@
-/*************************************************************************
- *
- *  OpenOffice.org - a multi-platform office productivity suite
- *
- *  $RCSfile: tp_RegressionOptions.hrc,v $
- *
- *  $Revision: 1.2 $
- *
- *  last change: $Author: ihi $ $Date: 2007/11/23 11:49:39 $
- *
- *  The Contents of this file are made available subject to
- *  the terms of GNU Lesser General Public License Version 2.1.
- *
- *
- *    GNU Lesser General Public License Version 2.1
- *    =============================================
- *    Copyright 2005 by Sun Microsystems, Inc.
- *    901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *    This library is free software; you can redistribute it and/or
- *    modify it under the terms of the GNU Lesser General Public
- *    License version 2.1, as published by the Free Software Foundation.
- *
- *    This library is distributed in the hope that it will be useful,
- *    but WITHOUT ANY WARRANTY; without even the implied warranty of
- *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *    Lesser General Public License for more details.
- *
- *    You should have received a copy of the GNU Lesser General Public
- *    License along with this library; if not, write to the Free Software
- *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *    MA  02111-1307  USA
- *
- ************************************************************************/
-#ifndef CHART_REGRESSION_OPTIONS_HRC
-#define CHART_REGRESSION_OPTIONS_HRC
-
-#include "ResourceIds.hrc"
-
-#define CBX_SHOW_EQUATION            1
-#define CBX_SHOW_CORRELATION_COEFF   2
-
-// CHART_REGRESSION_OPTIONS_HRC
-#endif
--- chart2/source/controller/dialogs/tp_RegressionOptions.hxx	2007-11-23 12:49:56.000000000 +0100
+++ chart2/source/controller/dialogs/tp_RegressionOptions.hxx	1970-01-01 01:00:00.000000000 +0100
@@ -1,74 +0,0 @@
-/*************************************************************************
- *
- *  OpenOffice.org - a multi-platform office productivity suite
- *
- *  $RCSfile: tp_RegressionOptions.hxx,v $
- *
- *  $Revision: 1.2 $
- *
- *  last change: $Author: ihi $ $Date: 2007/11/23 11:49:56 $
- *
- *  The Contents of this file are made available subject to
- *  the terms of GNU Lesser General Public License Version 2.1.
- *
- *
- *    GNU Lesser General Public License Version 2.1
- *    =============================================
- *    Copyright 2005 by Sun Microsystems, Inc.
- *    901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *    This library is free software; you can redistribute it and/or
- *    modify it under the terms of the GNU Lesser General Public
- *    License version 2.1, as published by the Free Software Foundation.
- *
- *    This library is distributed in the hope that it will be useful,
- *    but WITHOUT ANY WARRANTY; without even the implied warranty of
- *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *    Lesser General Public License for more details.
- *
- *    You should have received a copy of the GNU Lesser General Public
- *    License along with this library; if not, write to the Free Software
- *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *    MA  02111-1307  USA
- *
- ************************************************************************/
-#ifndef CHART2_TP_REGRESSIONOPTIONS_HXX
-#define CHART2_TP_REGRESSIONOPTIONS_HXX
-
-// SfxTabPage
-#include <sfx2/tabdlg.hxx>
-// CheckBox / RadioButton
-#include <vcl/button.hxx>
-// FixedLine
-#include <vcl/fixed.hxx>
-
-namespace chart
-{
-
-class RegressionOptionsTabPage : public SfxTabPage
-{
-public:
-    RegressionOptionsTabPage( Window* pWindow, const SfxItemSet& rInAttrs );
-	virtual ~RegressionOptionsTabPage();
-
-	static SfxTabPage* Create( Window* pParent, const SfxItemSet& rInAttrs );
-
-	virtual BOOL FillItemSet( SfxItemSet& rOutAttrs );
-	virtual void Reset( const SfxItemSet& rInAttrs );
-
-    DECL_LINK( DisplayOptionChecked, CheckBox* );
-
-private:
-    CheckBox    m_aCbxEquation;
-    CheckBox    m_aCbxCorrelationCoeff;
-//     FixedLine   m_aFlSeparator;
-//     RadioButton m_aRbtNewline;
-//     RadioButton m_aRbtSemicolon;
-//     RadioButton m_aRbtComma;
-//     RadioButton m_aRbtSlash;
-};
-
-} //  namespace chart
-
-// CHART2_TP_REGRESSIONOPTIONS_HXX
-#endif
--- chart2/source/controller/dialogs/tp_RegressionOptions.src	2007-11-23 12:50:10.000000000 +0100
+++ chart2/source/controller/dialogs/tp_RegressionOptions.src	1970-01-01 01:00:00.000000000 +0100
@@ -1,57 +0,0 @@
-/*************************************************************************
- *
- *  OpenOffice.org - a multi-platform office productivity suite
- *
- *  $RCSfile: tp_RegressionOptions.src,v $
- *
- *  $Revision: 1.2 $
- *
- *  last change: $Author: ihi $ $Date: 2007/11/23 11:50:10 $
- *
- *  The Contents of this file are made available subject to
- *  the terms of GNU Lesser General Public License Version 2.1.
- *
- *
- *    GNU Lesser General Public License Version 2.1
- *    =============================================
- *    Copyright 2005 by Sun Microsystems, Inc.
- *    901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *    This library is free software; you can redistribute it and/or
- *    modify it under the terms of the GNU Lesser General Public
- *    License version 2.1, as published by the Free Software Foundation.
- *
- *    This library is distributed in the hope that it will be useful,
- *    but WITHOUT ANY WARRANTY; without even the implied warranty of
- *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *    Lesser General Public License for more details.
- *
- *    You should have received a copy of the GNU Lesser General Public
- *    License along with this library; if not, write to the Free Software
- *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *    MA  02111-1307  USA
- *
- ************************************************************************/
-#include "tp_RegressionOptions.hrc"
-#include "HelpIds.hrc"
-
-TabPage TP_REGRESSION_OPTIONS
-{
-    Size = MAP_APPFONT ( 260, 185 );
-
-    CheckBox CBX_SHOW_EQUATION
-    {
-        Pos = MAP_APPFONT ( 5 , 10  );
-        Size = MAP_APPFONT ( 250 , 10 );
-        TabStop = TRUE;
-        Text[ en-US ] = "Show ~equation";
-    };
-
-    CheckBox CBX_SHOW_CORRELATION_COEFF
-    {
-        Pos = MAP_APPFONT ( 5 , 24 );
-        Size = MAP_APPFONT ( 250 , 10 );
-        TabStop = TRUE;
-        Text[ en-US ] = "Show ~correlation coefficient (R²)";
-    };
-};
--- chart2/source/controller/dialogs/tp_SeriesStatistic.cxx	2007-07-25 10:37:56.000000000 +0200
+++ chart2/source/controller/dialogs/tp_SeriesStatistic.cxx	1970-01-01 01:00:00.000000000 +0100
@@ -1,94 +0,0 @@
-/*************************************************************************
- *
- *  OpenOffice.org - a multi-platform office productivity suite
- *
- *  $RCSfile: tp_SeriesStatistic.cxx,v $
- *
- *  $Revision: 1.11 $
- *
- *  last change: $Author: rt $ $Date: 2007/07/25 08:37:56 $
- *
- *  The Contents of this file are made available subject to
- *  the terms of GNU Lesser General Public License Version 2.1.
- *
- *
- *    GNU Lesser General Public License Version 2.1
- *    =============================================
- *    Copyright 2005 by Sun Microsystems, Inc.
- *    901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *    This library is free software; you can redistribute it and/or
- *    modify it under the terms of the GNU Lesser General Public
- *    License version 2.1, as published by the Free Software Foundation.
- *
- *    This library is distributed in the hope that it will be useful,
- *    but WITHOUT ANY WARRANTY; without even the implied warranty of
- *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *    Lesser General Public License for more details.
- *
- *    You should have received a copy of the GNU Lesser General Public
- *    License along with this library; if not, write to the Free Software
- *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *    MA  02111-1307  USA
- *
- ************************************************************************/
-
-// MARKER(update_precomp.py): autogen include statement, do not remove
-#include "precompiled_chart2.hxx"
-
-#include "tp_SeriesStatistic.hxx"
-#include "ResId.hxx"
-#include "TabPages.hrc"
-
-//.............................................................................
-namespace chart
-{
-//.............................................................................
-
-SchStatisticTabPage::SchStatisticTabPage( Window* pWindow, const SfxItemSet& rInAttrs )
-    : SfxTabPage(pWindow, SchResId(TP_STAT), rInAttrs),
-    m_aErrorBarResources( this,rInAttrs )
-{
-    FreeResource();
-}
-
-SchStatisticTabPage::~SchStatisticTabPage()
-{
-}
-
-SfxTabPage* SchStatisticTabPage::Create(Window* pWindow,
-										const SfxItemSet& rOutAttrs)
-{
-    return new SchStatisticTabPage(pWindow, rOutAttrs);
-}
-
-BOOL SchStatisticTabPage::FillItemSet(SfxItemSet& rOutAttrs)
-{
-    return m_aErrorBarResources.FillItemSet(rOutAttrs);
-}
-
-void SchStatisticTabPage::Reset(const SfxItemSet& rInAttrs)
-{
-    m_aErrorBarResources.Reset(rInAttrs);
-}
-
-void SchStatisticTabPage::DataChanged( const DataChangedEvent& rDCEvt )
-{
-    SfxTabPage::DataChanged( rDCEvt );
-
-    if ( (rDCEvt.GetType() == DATACHANGED_SETTINGS) && (rDCEvt.GetFlags() & SETTINGS_STYLE) )
-        m_aErrorBarResources.FillValueSets();
-}
-
-void SchStatisticTabPage::EnableTrendLine( bool bEnable )
-{
-    m_aErrorBarResources.EnableTrendLine( bEnable );
-}
-
-void SchStatisticTabPage::SetAxisMinorStepWidthForErrorBarDecimals( double fMinorStepWidth )
-{
-    m_aErrorBarResources.SetAxisMinorStepWidthForErrorBarDecimals( fMinorStepWidth );
-}
-//.............................................................................
-} //namespace chart
-//.............................................................................
--- chart2/source/controller/dialogs/tp_SeriesStatistic.hxx	2007-07-25 10:38:10.000000000 +0200
+++ chart2/source/controller/dialogs/tp_SeriesStatistic.hxx	1970-01-01 01:00:00.000000000 +0100
@@ -1,73 +0,0 @@
-/*************************************************************************
- *
- *  OpenOffice.org - a multi-platform office productivity suite
- *
- *  $RCSfile: tp_SeriesStatistic.hxx,v $
- *
- *  $Revision: 1.8 $
- *
- *  last change: $Author: rt $ $Date: 2007/07/25 08:38:10 $
- *
- *  The Contents of this file are made available subject to
- *  the terms of GNU Lesser General Public License Version 2.1.
- *
- *
- *    GNU Lesser General Public License Version 2.1
- *    =============================================
- *    Copyright 2005 by Sun Microsystems, Inc.
- *    901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *    This library is free software; you can redistribute it and/or
- *    modify it under the terms of the GNU Lesser General Public
- *    License version 2.1, as published by the Free Software Foundation.
- *
- *    This library is distributed in the hope that it will be useful,
- *    but WITHOUT ANY WARRANTY; without even the implied warranty of
- *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *    Lesser General Public License for more details.
- *
- *    You should have received a copy of the GNU Lesser General Public
- *    License along with this library; if not, write to the Free Software
- *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *    MA  02111-1307  USA
- *
- ************************************************************************/
-#ifndef _CHART2_TP_SERIESSTATISTIC_HXX
-#define _CHART2_TP_SERIESSTATISTIC_HXX
-
-#include "res_ErrorBar.hxx"
-
-// header for SfxTabPage
-#ifndef _SFXTABDLG_HXX
-#include <sfx2/tabdlg.hxx>
-#endif
-
-//.............................................................................
-namespace chart
-{
-//.............................................................................
-
-class SchStatisticTabPage : public SfxTabPage
-{
-public:
-    SchStatisticTabPage (Window* pParent, const SfxItemSet& rInAttrs);
-    virtual ~SchStatisticTabPage ();
-
-    void EnableTrendLine( bool bEnable );
-    void SetAxisMinorStepWidthForErrorBarDecimals( double fMinorStepWidth );
-
-    static SfxTabPage* Create(Window* pParent, const SfxItemSet& rInAttrs);
-    virtual BOOL FillItemSet(SfxItemSet& rOutAttrs);
-    virtual void Reset(const SfxItemSet& rInAttrs);
-
-    virtual void	DataChanged( const DataChangedEvent& rDCEvt );
-
-private:
-    ErrorBarResources   m_aErrorBarResources;
-};
-
-//.............................................................................
-} //namespace chart
-//.............................................................................
-
-#endif
--- chart2/source/controller/dialogs/tp_SeriesStatistic.src	2005-09-08 02:17:57.000000000 +0200
+++ chart2/source/controller/dialogs/tp_SeriesStatistic.src	1970-01-01 01:00:00.000000000 +0100
@@ -1,46 +0,0 @@
-/*************************************************************************
- *
- *  OpenOffice.org - a multi-platform office productivity suite
- *
- *  $RCSfile: tp_SeriesStatistic.src,v $
- *
- *  $Revision: 1.2 $
- *
- *  last change: $Author: rt $ $Date: 2005/09/08 00:17:57 $
- *
- *  The Contents of this file are made available subject to
- *  the terms of GNU Lesser General Public License Version 2.1.
- *
- *
- *    GNU Lesser General Public License Version 2.1
- *    =============================================
- *    Copyright 2005 by Sun Microsystems, Inc.
- *    901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *    This library is free software; you can redistribute it and/or
- *    modify it under the terms of the GNU Lesser General Public
- *    License version 2.1, as published by the Free Software Foundation.
- *
- *    This library is distributed in the hope that it will be useful,
- *    but WITHOUT ANY WARRANTY; without even the implied warranty of
- *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *    Lesser General Public License for more details.
- *
- *    You should have received a copy of the GNU Lesser General Public
- *    License along with this library; if not, write to the Free Software
- *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *    MA  02111-1307  USA
- *
- ************************************************************************/
-#include "HelpIds.hrc"
-#include "TabPages.hrc"
-#include "res_Statistic.hrc"
-
-TabPage TP_STAT
-{
-	Hide = TRUE ;
-	HelpID = HID_SCH_STAT ;
-	SVLook = TRUE ;
-	Size = MAP_APPFONT ( 260 , 185 ) ;
-	RESOURCE_STATISTIC( 31, 248 )
-};
--- chart2/source/controller/dialogs/tp_TitleRotation.src	2007-08-30 15:41:59.000000000 +0200
+++ chart2/source/controller/dialogs/tp_TitleRotation.src	2007-12-18 15:57:04.000000000 +0100
@@ -52,14 +52,14 @@
     {
         HelpId = HID_SCH_ALIGNMENT_STACKED ;
         Pos = MAP_APPFONT ( 139 , 14  ) ;
-        Size = MAP_APPFONT ( 109 , 10 ) ;
+        Size = MAP_APPFONT ( 116 , 10 ) ;
         TabStop = TRUE ;
         Text [ en-US ] = "Ve~rtically stacked";
     };
 	FixedText FT_DEGREES
 	{
         Pos = MAP_APPFONT ( 93 , 32  ) ;
-		Size = MAP_APPFONT ( 32 , 8 ) ;
+		Size = MAP_APPFONT ( 162 , 8 ) ;
 		Text [ en-US ] = "~Degrees" ;
 	};
 	NumericField NF_ORIENT
@@ -83,3 +83,4 @@
 		Text [ en-US ] = "Text direction" ;
 	};
 };
+
--- chart2/source/controller/dialogs/tp_Trendline.cxx	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/tp_Trendline.cxx	2008-01-11 16:58:42.000000000 +0100
@@ -0,0 +1,85 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: tp_Trendline.cxx,v $
+ *
+ *  $Revision: 1.1.2.2 $
+ *
+ *  last change: $Author: bm $ $Date: 2008/01/11 15:58:42 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+// MARKER(update_precomp.py): autogen include statement, do not remove
+#include "precompiled_chart2.hxx"
+
+#include "tp_Trendline.hxx"
+#include "ResId.hxx"
+#include "TabPages.hrc"
+
+//.............................................................................
+namespace chart
+{
+//.............................................................................
+
+TrendlineTabPage::TrendlineTabPage( Window* pParent, const SfxItemSet& rInAttrs ) :
+        SfxTabPage( pParent, SchResId( TP_TRENDLINE ), rInAttrs ),
+        m_aTrendlineResources( this, rInAttrs, false )
+{
+    FreeResource();
+}
+
+TrendlineTabPage::~TrendlineTabPage()
+{
+}
+
+SfxTabPage* TrendlineTabPage::Create(
+    Window* pParent, const SfxItemSet& rOutAttrs )
+{
+    return new TrendlineTabPage( pParent, rOutAttrs );
+}
+
+BOOL TrendlineTabPage::FillItemSet( SfxItemSet& rOutAttrs )
+{
+    return m_aTrendlineResources.FillItemSet( rOutAttrs );
+}
+
+void TrendlineTabPage::Reset( const SfxItemSet& rInAttrs )
+{
+    m_aTrendlineResources.Reset( rInAttrs );
+}
+
+void TrendlineTabPage::DataChanged( const DataChangedEvent& rDCEvt )
+{
+    SfxTabPage::DataChanged( rDCEvt );
+
+    if ( (rDCEvt.GetType() == DATACHANGED_SETTINGS) && (rDCEvt.GetFlags() & SETTINGS_STYLE) )
+        m_aTrendlineResources.FillValueSets();
+}
+
+//.............................................................................
+} //namespace chart
+//.............................................................................
--- chart2/source/controller/dialogs/tp_Trendline.hxx	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/tp_Trendline.hxx	2007-12-20 17:18:43.000000000 +0100
@@ -0,0 +1,67 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: tp_Trendline.hxx,v $
+ *
+ *  $Revision: 1.1.2.1 $
+ *
+ *  last change: $Author: bm $ $Date: 2007/12/20 16:18:43 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#ifndef _CHART2_TP_TRENDLINE_HXX
+#define _CHART2_TP_TRENDLINE_HXX
+
+#include "res_Trendline.hxx"
+
+#include <sfx2/tabdlg.hxx>
+
+//.............................................................................
+namespace chart
+{
+//.............................................................................
+
+class TrendlineTabPage : public SfxTabPage
+{
+public:
+    TrendlineTabPage ( Window* pParent, const SfxItemSet& rInAttrs );
+    virtual ~TrendlineTabPage ();
+
+    static SfxTabPage* Create( Window* pParent, const SfxItemSet& rInAttrs );
+    virtual BOOL FillItemSet( SfxItemSet& rOutAttrs );
+    virtual void Reset( const SfxItemSet& rInAttrs );
+
+    virtual void DataChanged( const DataChangedEvent& rDCEvt );
+
+private:
+    TrendlineResources   m_aTrendlineResources;
+};
+
+//.............................................................................
+} //namespace chart
+//.............................................................................
+
+#endif
--- chart2/source/controller/dialogs/tp_Trendline.src	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/dialogs/tp_Trendline.src	2008-01-11 16:58:42.000000000 +0100
@@ -0,0 +1,46 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: tp_Trendline.src,v $
+ *
+ *  $Revision: 1.1.2.2 $
+ *
+ *  last change: $Author: bm $ $Date: 2008/01/11 15:58:42 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#include "HelpIds.hrc"
+#include "TabPages.hrc"
+#include "res_Trendline.hrc"
+
+TabPage TP_TRENDLINE
+{
+	Hide = TRUE ;
+// 	HelpID = HID_SCH_STAT ;
+	SVLook = TRUE ;
+	Size = MAP_APPFONT ( 260 , 185 ) ;
+	RESOURCE_TRENDLINE( 260 - 12, 0 )
+};
--- chart2/source/controller/dialogs/tp_Wizard_TitlesAndObjects.cxx	2007-07-25 10:38:49.000000000 +0200
+++ chart2/source/controller/dialogs/tp_Wizard_TitlesAndObjects.cxx	2007-11-20 18:12:15.000000000 +0100
@@ -64,7 +64,7 @@
         : OWizardPage( pParent, SchResId(TP_WIZARD_TITLEANDOBJECTS) )
         , m_aFT_TitleDescription( this, SchResId( FT_TITLEDESCRIPTION ) )
         , m_aFL_Vertical( this, SchResId( FL_VERTICAL ) )
-        , m_apTitleResources( new TitleResources(this) )
+        , m_apTitleResources( new TitleResources(this,false) )
         , m_apLegendPositionResources( new LegendPositionResources(this,xContext) )
         , m_aFL_Grids( this, SchResId( FL_GRIDS ) )
         , m_aCB_Grid_X( this, SchResId( CB_X_SECONDARY ) )
--- chart2/source/controller/dialogs/tp_Wizard_TitlesAndObjects.src	2007-08-17 17:07:40.000000000 +0200
+++ chart2/source/controller/dialogs/tp_Wizard_TitlesAndObjects.src	2008-01-14 16:51:31.000000000 +0100
@@ -45,27 +45,24 @@
 #endif
 
 #define MASKCOLOR MaskColor = Color { Red = 0xC000 ; Green = 0xC000 ; Blue = 0xC000 ; }
-#define WIZ_FIRST_COLUMNWIDTH 30
-#define WIZ_SECOND_COLUMNWIDTH 100
-#define WIZ_TITLESEDIT_WIDTH (WIZ_SECOND_COLUMNWIDTH-6)
+#define WIZ_TITLES_WIDTH 130
 
 #define WIZ_POSX1      6
 #define WIZ_POSX1_A   (WIZ_POSX1)
-#define WIZ_POSX1_B   (WIZ_POSX1_A+WIZ_FIRST_COLUMNWIDTH+4)
-#define WIZ_POSX_VERTICAL   (WIZ_POSX1_B+WIZ_SECOND_COLUMNWIDTH+2)
+#define WIZ_POSX_VERTICAL   (WIZ_POSX1+WIZ_TITLES_WIDTH+6)
 #define WIZ_POSX2       (WIZ_POSX_VERTICAL+RSC_CD_FIXEDLINE_WIDTH+2)
 #define WIZ_POSX2_A     (WIZ_POSX2)
 #define WIZ_POSX2_B     (WIZ_POSX2_A+9)
 
 #define WIZ_SECOND_FIXEDLINE_WIDTH (CHART_WIZARD_PAGEWIDTH-10-(WIZ_POSX2))
 #define WIZ_COMPLETE_FIXEDLINE_WIDTH (CHART_WIZARD_PAGEWIDTH-10-(WIZ_POSX1))
-#define WIZ_VERTICAL_FIXEDLINE_HEIGHT ( 86 )
+#define WIZ_VERTICAL_FIXEDLINE_HEIGHT ( 88 )
 
 #define WIZ_POSY1    8
 #define WIZ_POSY1_A (WIZ_POSY1  + RSC_CD_FIXEDTEXT_HEIGHT +5)
 #define WIZ_POSY1_B (WIZ_POSY1_A+ RSC_CD_FIXEDTEXT_HEIGHT +7)
 
-#define WIZ_POSY2 105
+#define WIZ_POSY2 110
 #define WIZ_POSY_GRID (WIZ_POSY2+RSC_CD_FIXEDTEXT_HEIGHT+6)
 
 TabPage TP_WIZARD_TITLEANDOBJECTS
@@ -87,7 +84,7 @@
 		Vert = TRUE ;
 	};
 
-	TITLES(WIZ_POSX1_A,WIZ_POSY1_A,WIZ_TITLESEDIT_WIDTH,WIZ_FIRST_COLUMNWIDTH)
+	TITLES(WIZ_POSX1_A,WIZ_POSY1_A,WIZ_TITLES_WIDTH,0,0)
 	RESOURCE_LEGENDDISPLAY( WIZ_POSX2_A, WIZ_POSY1_A )
 	RESOURCE_LEGENDPOSITION( WIZ_POSX2_B, WIZ_POSY1_B )
 
--- chart2/source/controller/inc/dlg_DataEditor.hxx	2007-05-22 19:58:22.000000000 +0200
+++ chart2/source/controller/inc/dlg_DataEditor.hxx	2007-12-10 12:39:22.000000000 +0100
@@ -86,7 +86,7 @@
 	virtual BOOL Close();
 
     void SetReadOnly( bool bReadOnly );
-    void ApplyChangesToModel();
+    bool ApplyChangesToModel();
 
 private:
     bool                            m_bReadOnly;
--- chart2/source/controller/inc/dlg_InsertErrorBars.hxx	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/inc/dlg_InsertErrorBars.hxx	2007-12-20 17:19:49.000000000 +0100
@@ -0,0 +1,85 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: dlg_InsertErrorBars.hxx,v $
+ *
+ *  $Revision: 1.1.2.1 $
+ *
+ *  last change: $Author: bm $ $Date: 2007/12/20 16:19:49 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#ifndef _CHART2_DLG_INSERT_ERRORBARS_HXX
+#define _CHART2_DLG_INSERT_ERRORBARS_HXX
+
+#include <vcl/dialog.hxx>
+#include <vcl/button.hxx>
+#include <svtools/itemset.hxx>
+#include <memory>
+#include <com/sun/star/frame/XModel.hpp>
+
+#include "res_ErrorBar.hxx"
+
+//.............................................................................
+namespace chart
+{
+//.............................................................................
+
+class InsertErrorBarsDialog : public ModalDialog
+{
+public:
+    InsertErrorBarsDialog( Window* pParent, const SfxItemSet& rMyAttrs,
+                           ErrorBarResources::tErrorBarType eType = ErrorBarResources::ERROR_BAR_Y );
+    virtual ~InsertErrorBarsDialog();
+
+    void SetAxisMinorStepWidthForErrorBarDecimals( double fMinorStepWidth );
+
+    static double getAxisMinorStepWidthForErrorBarDecimals(
+        const ::com::sun::star::uno::Reference<
+            ::com::sun::star::frame::XModel >& xChartModel,
+        const ::com::sun::star::uno::Reference<
+            ::com::sun::star::uno::XInterface >& xChartView,
+        const ::rtl::OUString& rSelectedObjectCID );
+
+    void FillItemSet( SfxItemSet& rOutAttrs );
+    virtual void DataChanged( const DataChangedEvent& rDCEvt );
+
+private:
+    void Reset();
+    const SfxItemSet & rInAttrs;
+
+    OKButton          aBtnOK;
+    CancelButton      aBtnCancel;
+    HelpButton        aBtnHelp;
+
+    ::std::auto_ptr< ErrorBarResources >    m_apErrorBarResources;
+};
+
+//.............................................................................
+} //namespace chart
+//.............................................................................
+
+#endif
--- chart2/source/controller/inc/dlg_InsertStatistic.hxx	2007-07-25 10:39:49.000000000 +0200
+++ chart2/source/controller/inc/dlg_InsertStatistic.hxx	1970-01-01 01:00:00.000000000 +0100
@@ -1,98 +0,0 @@
-/*************************************************************************
- *
- *  OpenOffice.org - a multi-platform office productivity suite
- *
- *  $RCSfile: dlg_InsertStatistic.hxx,v $
- *
- *  $Revision: 1.7 $
- *
- *  last change: $Author: rt $ $Date: 2007/07/25 08:39:49 $
- *
- *  The Contents of this file are made available subject to
- *  the terms of GNU Lesser General Public License Version 2.1.
- *
- *
- *    GNU Lesser General Public License Version 2.1
- *    =============================================
- *    Copyright 2005 by Sun Microsystems, Inc.
- *    901 San Antonio Road, Palo Alto, CA 94303, USA
- *
- *    This library is free software; you can redistribute it and/or
- *    modify it under the terms of the GNU Lesser General Public
- *    License version 2.1, as published by the Free Software Foundation.
- *
- *    This library is distributed in the hope that it will be useful,
- *    but WITHOUT ANY WARRANTY; without even the implied warranty of
- *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
- *    Lesser General Public License for more details.
- *
- *    You should have received a copy of the GNU Lesser General Public
- *    License along with this library; if not, write to the Free Software
- *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
- *    MA  02111-1307  USA
- *
- ************************************************************************/
-#ifndef _CHART2_DLG_INSERT_STATISTIC_GRID_HXX
-#define _CHART2_DLG_INSERT_STATISTIC_GRID_HXX
-
-// header for class ModalDialog
-#ifndef _SV_DIALOG_HXX
-#include <vcl/dialog.hxx>
-#endif
-// header for buttons
-#ifndef _SV_BUTTON_HXX
-#include <vcl/button.hxx>
-#endif
-// header for class SfxItemSet
-#ifndef _SFXITEMSET_HXX
-#include <svtools/itemset.hxx>
-#endif
-//for auto_ptr
-#include <memory>
-
-#ifndef _COM_SUN_STAR_FRAME_XMODEL_HPP_
-#include <com/sun/star/frame/XModel.hpp>
-#endif
-
-//.............................................................................
-namespace chart
-{
-//.............................................................................
-
-class ErrorBarResources;
-class SchDataStatisticsDlg : public ModalDialog
-{
-public:
-    SchDataStatisticsDlg(Window* pParent, const SfxItemSet &rMyAttrs);
-    virtual ~SchDataStatisticsDlg ();
-
-    void EnableTrendLine( bool bEnable );
-    void SetAxisMinorStepWidthForErrorBarDecimals( double fMinorStepWidth );
-
-    static double getAxisMinorStepWidthForErrorBarDecimals(
-        const ::com::sun::star::uno::Reference<
-            ::com::sun::star::frame::XModel >& xChartModel,
-        const ::com::sun::star::uno::Reference<
-            ::com::sun::star::uno::XInterface >& xChartView,
-        const ::rtl::OUString& rSelectedObjectCID );
-
-    void FillItemSet(SfxItemSet &rOutAttrs);
-    virtual void	DataChanged( const DataChangedEvent& rDCEvt );
-
-private:
-    void Reset();
-    const SfxItemSet    &rInAttrs;
-
-    OKButton			aBtnOK;
-    CancelButton		aBtnCancel;
-    HelpButton			aBtnHelp;
-
-    ::std::auto_ptr< ErrorBarResources >    m_apErrorBarResources;
-};
-
-//.............................................................................
-} //namespace chart
-//.............................................................................
-
-#endif
-
--- chart2/source/controller/inc/dlg_InsertTrendline.hxx	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/inc/dlg_InsertTrendline.hxx	2008-01-14 13:15:56.000000000 +0100
@@ -0,0 +1,77 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: dlg_InsertTrendline.hxx,v $
+ *
+ *  $Revision: 1.1.2.2 $
+ *
+ *  last change: $Author: bm $ $Date: 2008/01/14 12:15:56 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#ifndef _CHART2_DLG_INSERT_TRENDLINE_HXX
+#define _CHART2_DLG_INSERT_TRENDLINE_HXX
+
+#include <vcl/dialog.hxx>
+#include <vcl/button.hxx>
+#include <svtools/itemset.hxx>
+#include <memory>
+
+//.............................................................................
+namespace chart
+{
+//.............................................................................
+
+class TrendlineResources;
+class InsertTrendlineDialog : public ModalDialog
+{
+public:
+    InsertTrendlineDialog( Window* pParent, const SfxItemSet& rMyAttrs );
+    virtual ~InsertTrendlineDialog();
+
+    void FillItemSet( SfxItemSet& rOutAttrs );
+    virtual void DataChanged( const DataChangedEvent& rDCEvt );
+
+    // sets the size so that all control texts fit. Has to be done after
+    // complete construction of the dialog
+    void adjustSize();
+
+private:
+    void Reset();
+    const SfxItemSet & rInAttrs;
+
+    OKButton          aBtnOK;
+    CancelButton      aBtnCancel;
+    HelpButton        aBtnHelp;
+
+    ::std::auto_ptr< TrendlineResources >    m_apTrendlineResources;
+};
+
+//.............................................................................
+} //namespace chart
+//.............................................................................
+
+#endif
--- chart2/source/controller/inc/dlg_ObjectProperties.hxx	2007-10-22 18:50:38.000000000 +0200
+++ chart2/source/controller/inc/dlg_ObjectProperties.hxx	2008-01-14 18:13:42.000000000 +0100
@@ -75,6 +75,7 @@
 	bool HasScaleProperties() const;
 	bool CanAxisLabelsBeStaggered() const;
     bool HasNumberProperties() const;
+    bool ProvidesStartingAngle() const;
 
 private:
 	rtl::OUString	m_aObjectCID;
@@ -94,6 +95,7 @@
 	bool m_bHasScaleProperties;
 	bool m_bCanAxisLabelsBeStaggered;
     bool m_bHasNumberProperties;
+    bool m_bProvidesStartingAngle;
 };
 
 /*************************************************************************
@@ -120,9 +122,13 @@
     Graphic*		m_pAutoSymbolGraphic;
 
     double          m_fAxisMinorStepWidthForErrorBarDecimals;
+    bool            m_bOKPressed;
 
     virtual void PageCreated(USHORT nId, SfxTabPage& rPage);
 
+    Link m_aOriginalOKClickHdl;
+    DECL_LINK( OKPressed, void * );
+
 public:
 	SchAttribTabDlg(Window* pParent, const SfxItemSet* pAttr,
 					const ObjectPropertiesDialogParameter* pDialogParameter,
@@ -137,6 +143,8 @@
     void setSymbolInformation( SfxItemSet* pSymbolShapeProperties, Graphic* pAutoSymbolGraphic );
 
     void SetAxisMinorStepWidthForErrorBarDecimals( double fMinorStepWidth );
+
+    bool DialogWasClosedWithOK() const;
 };
 
 //.............................................................................
--- chart2/source/controller/inc/HelpIds.hrc	2007-11-23 12:50:44.000000000 +0100
+++ chart2/source/controller/inc/HelpIds.hrc	2008-01-14 18:35:51.000000000 +0100
@@ -36,7 +36,7 @@
 #define CHART_HELPIDS_HRC
 
 #include <svtools/solar.hrc>
-//next is 92
+//next is 102
 
 //see old chart: schhids.h
 
@@ -57,7 +57,7 @@
 #define HID_SCH_CTL_DATA            (HID_SCH_START + 10)
 
 #define HID_SCH_CT_INDICATE         (HID_SCH_START + 11)
-#define HID_SCH_CT_REGRESS          (HID_SCH_START + 12)
+// #define HID_SCH_CT_REGRESS          (HID_SCH_START + 12)
 
 //for chart type dialog:
 #define HID_SCH_CTL_TYPE            (HID_SCH_START + 13)
@@ -152,11 +152,23 @@
 #define HID_SCH_TITLE_X     (HID_SCH_START + 82)
 #define HID_SCH_TITLE_Y     (HID_SCH_START + 83)
 #define HID_SCH_TITLE_Z     (HID_SCH_START + 84)
+#define HID_SCH_TITLE_SECONDARY_X     (HID_SCH_START + 92)
+#define HID_SCH_TITLE_SECONDARY_Y     (HID_SCH_START + 93)
 
 #define HID_SCH_WIZARD_ROADMAP     (HID_SCH_START + 85)
 #define HID_SCH_LEGEND_SHOW        (HID_SCH_START + 86)
 #define HID_SCH_DATA_SERIES_LABEL  (HID_SCH_START + 87)
 
+#define HID_SCH_STARTING_ANGLE_DIAL (HID_SCH_START + 94)
+
+#define HID_SCH_TRENDLINE_RB_NONE         (HID_SCH_START +  95)
+#define HID_SCH_TRENDLINE_RB_LINEAR       (HID_SCH_START +  96)
+#define HID_SCH_TRENDLINE_RB_LOGARITHMIC  (HID_SCH_START +  97)
+#define HID_SCH_TRENDLINE_RB_EXPONENTIAL  (HID_SCH_START +  98)
+#define HID_SCH_TRENDLINE_RB_POWER        (HID_SCH_START +  99)
+#define HID_SCH_TRENDLINE_SHOW_EQUATION   (HID_SCH_START + 100)
+#define HID_SCH_TRENDLINE_SHOW_R_SQUARED  (HID_SCH_START + 101)
+
 // HID_SCH_START should be 63280 (checked 25.Nov 2002)
 
 // 453 == SCH_IF_CHARTVIEWSHELL, da SFX_INTERFACE_LIB kein
--- chart2/source/controller/inc/ItemConverter.hxx	2007-05-22 19:54:02.000000000 +0200
+++ chart2/source/controller/inc/ItemConverter.hxx	2008-01-11 16:58:42.000000000 +0100
@@ -221,6 +221,15 @@
     // ____ ::utl::OEventListenerAdapter ____
     virtual void _disposing( const ::com::sun::star::lang::EventObject& rSource );
 
+protected:
+    /** sets a new property set, that you get with GetPropertySet().  It should
+        not be necessary to use this method.  It is introduced to allow changing
+        the regression type of a regression curve which changes the object
+        identity.
+     */
+    void resetPropertySet( const ::com::sun::star::uno::Reference<
+                           ::com::sun::star::beans::XPropertySet > & xPropSet );
+
 private:
     ::com::sun::star::uno::Reference<
         ::com::sun::star::beans::XPropertySet >     m_xPropertySet;
--- chart2/source/controller/inc/RegressionCurveItemConverter.hxx	2007-11-23 12:50:59.000000000 +0100
+++ chart2/source/controller/inc/RegressionCurveItemConverter.hxx	2008-01-11 16:58:42.000000000 +0100
@@ -37,6 +37,7 @@
 
 #include "ItemConverter.hxx"
 
+#include <com/sun/star/chart2/XRegressionCurveContainer.hpp>
 #include <com/sun/star/lang/XMultiServiceFactory.hpp>
 
 #include <vector>
@@ -56,6 +57,8 @@
     RegressionCurveItemConverter(
         const ::com::sun::star::uno::Reference<
         ::com::sun::star::beans::XPropertySet > & rPropertySet,
+        const ::com::sun::star::uno::Reference<
+            ::com::sun::star::chart2::XRegressionCurveContainer > & xRegCurveCnt,
         SfxItemPool& rItemPool,
         SdrModel& rDrawModel,
         const ::com::sun::star::uno::Reference<
@@ -76,6 +79,8 @@
 
 private:
     ::boost::shared_ptr< ItemConverter >  m_spGraphicConverter;
+    ::com::sun::star::uno::Reference<
+            ::com::sun::star::chart2::XRegressionCurveContainer >  m_xCurveContainer;
 };
 
 } //  namespace wrapper
--- chart2/source/controller/inc/res_ErrorBar.hxx	1970-01-01 01:00:00.000000000 +0100
+++ chart2/source/controller/inc/res_ErrorBar.hxx	2007-12-20 17:19:19.000000000 +0100
@@ -0,0 +1,108 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: res_ErrorBar.hxx,v $
+ *
+ *  $Revision: 1.1.2.1 $
+ *
+ *  last change: $Author: bm $ $Date: 2007/12/20 16:19:19 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#ifndef CHART2_RES_ERRORBAR_HXX
+#define CHART2_RES_ERRORBAR_HXX
+
+#include <vcl/button.hxx>
+#include <vcl/fixed.hxx>
+#include <vcl/field.hxx>
+#include <svtools/valueset.hxx>
+#include <svtools/itemset.hxx>
+#include <svx/chrtitem.hxx>
+#include "chartview/ChartSfxItemIds.hxx"
+
+//.............................................................................
+namespace chart
+{
+//.............................................................................
+
+class ErrorBarResources
+{
+public:
+    enum tErrorBarType
+    {
+        ERROR_BAR_X,
+        ERROR_BAR_Y
+    };
+
+    ErrorBarResources( Window* pParent, const SfxItemSet& rInAttrst, tErrorBarType eType = ERROR_BAR_Y );
+    virtual ~ErrorBarResources();
+
+    void SetAxisMinorStepWidthForErrorBarDecimals( double fMinorStepWidth );
+    void SetErrorBarType( tErrorBarType eNewType );
+
+    void Reset(const SfxItemSet& rInAttrs);
+    BOOL FillItemSet(SfxItemSet& rOutAttrs) const;
+
+    void FillValueSets();
+
+private:
+    FixedLine       m_aFlErrorCategory;
+    RadioButton     m_aRbtNone;
+    RadioButton     m_aRbtVariant;
+    RadioButton     m_aRbtSigma;
+    RadioButton     m_aRbtPercent;
+    RadioButton     m_aRbtBigError;
+    RadioButton     m_aRbtConst;
+//     RadioButton     m_aRbtRange;
+    MetricField     m_aMtrFldPercent;
+    MetricField     m_aMtrFldBigError;
+    FixedText       m_aFTConstPlus;
+    MetricField     m_aMtrFldConstPlus;
+    FixedText       m_aFTConstMinus;
+    MetricField     m_aMtrFldConstMinus;
+    FixedLine       m_aFLIndicate;
+    ValueSet        m_aIndicatorSet;
+
+    SvxChartKindError   m_eErrorKind;
+    SvxChartIndicate    m_eIndicate;
+    SvxChartRegress     m_eTrendLineType;
+
+    bool                m_bErrorKindUnique;
+    bool                m_bIndicatorUnique;
+    bool                m_bPlusUnique;
+    bool                m_bMinusUnique;
+
+    tErrorBarType       m_eErrorBarType;
+
+    DECL_LINK(RBtnClick, Button *);
+    DECL_LINK(SelectIndicate, void *);
+};
+
+//.............................................................................
+} //namespace chart
+//.............................................................................
+
+#endif
--- chart2/source/controller/inc/SeriesOptionsItemConverter.hxx	2007-10-22 18:50:05.000000000 +0200
+++ chart2/source/controller/inc/SeriesOptionsItemConverter.hxx	2008-01-08 13:18:34.000000000 +0100
@@ -44,6 +44,9 @@
 #ifndef _COM_SUN_STAR_UNO_XCOMPONENTCONTEXT_HPP_
 #include <com/sun/star/uno/XComponentContext.hpp>
 #endif
+#ifndef _COM_SUN_STAR_CHART2_XCOORDINATESYSTEM_HPP_
+#include <com/sun/star/chart2/XCoordinateSystem.hpp>
+#endif
 
 namespace chart
 {
@@ -91,6 +94,13 @@
     bool m_bGroupBarsPerAxis;
     bool m_bAllSeriesAttachedToSameAxis;
     sal_Int32 m_nAllSeriesAxisIndex;
+
+    bool m_bSupportingStartingAngle;
+    sal_Int32 m_nStartingAngle;
+
+    bool m_bClockwise;
+    ::com::sun::star::uno::Reference<
+            ::com::sun::star::chart2::XCoordinateSystem > m_xCooSys;
 };
 
 } //  namespace wrapper
--- chart2/source/controller/itemsetwrapper/ItemConverter.cxx	2007-10-22 18:51:22.000000000 +0200
+++ chart2/source/controller/itemsetwrapper/ItemConverter.cxx	2008-01-11 16:58:42.000000000 +0100
@@ -66,8 +66,21 @@
         m_rItemPool( rItemPool ),
         m_bIsValid( true )
 {
-    if( m_xPropertySet.is())
+    resetPropertySet( m_xPropertySet );
+}
+
+ItemConverter::~ItemConverter()
+{
+    stopAllComponentListening();
+}
+
+void ItemConverter::resetPropertySet(
+    const uno::Reference< beans::XPropertySet > & xPropSet )
+{
+    if( xPropSet.is())
     {
+        stopAllComponentListening();
+        m_xPropertySet = xPropSet;
         m_xPropertySetInfo = m_xPropertySet->getPropertySetInfo();
 
         uno::Reference< lang::XComponent > xComp( m_xPropertySet, uno::UNO_QUERY );
@@ -79,11 +92,6 @@
     }
 }
 
-ItemConverter::~ItemConverter()
-{
-    stopAllComponentListening();
-}
-
 SfxItemPool & ItemConverter::GetItemPool() const
 {
     return m_rItemPool;
--- chart2/source/controller/itemsetwrapper/MultipleChartConverters.cxx	2007-11-23 12:51:54.000000000 +0100
+++ chart2/source/controller/itemsetwrapper/MultipleChartConverters.cxx	2007-12-18 14:46:04.000000000 +0100
@@ -190,7 +190,7 @@
     {
         uno::Reference< chart2::XTitle > xTitle( TitleHelper::getTitle( TitleHelper::eTitleType(nTitle), xChartModel ) );
         if(!xTitle.is())
-            return;
+            continue;
         uno::Reference< beans::XPropertySet > xObjectProperties( xTitle, uno::UNO_QUERY);
         ::std::auto_ptr< awt::Size > pSingleRefSize(0);
         if( pRefSize.get())
--- chart2/source/controller/itemsetwrapper/RegressionCurveItemConverter.cxx	2007-11-23 12:52:13.000000000 +0100
+++ chart2/source/controller/itemsetwrapper/RegressionCurveItemConverter.cxx	2008-01-11 16:58:42.000000000 +0100
@@ -35,6 +35,7 @@
 
 // MARKER(update_precomp.py): autogen include statement, do not remove
 #include "precompiled_chart2.hxx"
+#include "RegressionCurveHelper.hxx"
 #include "RegressionCurveItemConverter.hxx"
 #include "SchWhichPairs.hxx"
 #include "macros.hxx"
@@ -45,12 +46,41 @@
 
 // for SfxBoolItem
 #include <svtools/eitem.hxx>
+#include <svx/chrtitem.hxx>
 
 #include <functional>
 #include <algorithm>
 
 using namespace ::com::sun::star;
 
+namespace
+{
+
+::chart::RegressionCurveHelper::tRegressionType lcl_convertRegressionType( SvxChartRegress eRegress )
+{
+    ::chart::RegressionCurveHelper::tRegressionType eType = ::chart::RegressionCurveHelper::REGRESSION_TYPE_NONE;
+    switch( eRegress )
+    {
+        case CHREGRESS_LINEAR:
+            eType = ::chart::RegressionCurveHelper::REGRESSION_TYPE_LINEAR;
+            break;
+        case CHREGRESS_LOG:
+            eType = ::chart::RegressionCurveHelper::REGRESSION_TYPE_LOG;
+            break;
+        case CHREGRESS_EXP:
+            eType = ::chart::RegressionCurveHelper::REGRESSION_TYPE_EXP;
+            break;
+        case CHREGRESS_POWER:
+            eType = ::chart::RegressionCurveHelper::REGRESSION_TYPE_POWER;
+            break;
+        case CHREGRESS_NONE:
+            break;
+    }
+    return eType;
+}
+
+} // anonymous namespace
+
 namespace chart
 {
 namespace wrapper
@@ -58,6 +88,7 @@
 
 RegressionCurveItemConverter::RegressionCurveItemConverter(
     const uno::Reference< beans::XPropertySet > & rPropertySet,
+    const uno::Reference< chart2::XRegressionCurveContainer > & xRegCurveCnt,
     SfxItemPool& rItemPool,
     SdrModel& rDrawModel,
     const uno::Reference< lang::XMultiServiceFactory > & xNamedPropertyContainerFactory ) :
@@ -65,7 +96,8 @@
         m_spGraphicConverter( new GraphicPropertyItemConverter(
                                   rPropertySet, rItemPool, rDrawModel,
                                   xNamedPropertyContainerFactory,
-                                  GraphicPropertyItemConverter::LINE_PROPERTIES ))
+                                  GraphicPropertyItemConverter::LINE_PROPERTIES )),
+        m_xCurveContainer( xRegCurveCnt )
 {}
 
 RegressionCurveItemConverter::~RegressionCurveItemConverter()
@@ -105,13 +137,45 @@
     USHORT nWhichId, const SfxItemSet & rItemSet )
     throw( uno::Exception )
 {
+    uno::Reference< chart2::XRegressionCurve > xCurve( GetPropertySet(), uno::UNO_QUERY );
     bool bChanged = false;
 
     switch( nWhichId )
     {
+        case SCHATTR_STAT_REGRESSTYPE:
+        {
+            OSL_ASSERT( xCurve.is());
+            if( xCurve.is())
+            {
+                SvxChartRegress eRegress = static_cast< SvxChartRegress >(
+                    static_cast< sal_Int32 >( RegressionCurveHelper::getRegressionType( xCurve )));
+                SvxChartRegress eNewRegress = static_cast< const SvxChartRegressItem & >(
+                    rItemSet.Get( nWhichId )).GetValue();
+                if( eRegress != eNewRegress )
+                {
+                    // note that changing the regression type changes the object
+                    // for which this converter was created. Not optimal, but
+                    // currently the only way to handle the type in the
+                    // regression curve properties dialog
+                    RegressionCurveHelper::replaceOrAddCurveAndReduceToOne(
+                        lcl_convertRegressionType( eNewRegress ), m_xCurveContainer,
+                        uno::Reference< uno::XComponentContext >());
+                    uno::Reference< beans::XPropertySet > xNewPropSet(
+                        RegressionCurveHelper::getFirstCurveNotMeanValueLine( m_xCurveContainer ),
+                        uno::UNO_QUERY );
+                    OSL_ASSERT( xNewPropSet.is());
+                    if( xNewPropSet.is())
+                    {
+                        resetPropertySet( xNewPropSet );
+                        bChanged = true;
+                    }
+                }
+            }
+        }
+        break;
+
         case SCHATTR_REGRESSION_SHOW_EQUATION:
         {
-            uno::Reference< chart2::XRegressionCurve > xCurve( GetPropertySet(), uno::UNO_QUERY );
             OSL_ASSERT( xCurve.is());
             if( xCurve.is())
             {
@@ -135,7 +199,6 @@
 
         case SCHATTR_REGRESSION_SHOW_COEFF:
         {
-            uno::Reference< chart2::XRegressionCurve > xCurve( GetPropertySet(), uno::UNO_QUERY );
             OSL_ASSERT( xCurve.is());
             if( xCurve.is())
             {
@@ -165,11 +228,24 @@
     USHORT nWhichId, SfxItemSet & rOutItemSet ) const
     throw( uno::Exception )
 {
+    uno::Reference< chart2::XRegressionCurve > xCurve( GetPropertySet(), uno::UNO_QUERY );
+
     switch( nWhichId )
     {
+        case SCHATTR_STAT_REGRESSTYPE:
+        {
+            OSL_ASSERT( xCurve.is());
+            if( xCurve.is())
+            {
+                SvxChartRegress eRegress = static_cast< SvxChartRegress >(
+                    static_cast< sal_Int32 >( RegressionCurveHelper::getRegressionType( xCurve )));
+                rOutItemSet.Put( SvxChartRegressItem( eRegress, SCHATTR_STAT_REGRESSTYPE ));
+            }
+        }
+        break;
+
         case SCHATTR_REGRESSION_SHOW_EQUATION:
         {
-            uno::Reference< chart2::XRegressionCurve > xCurve( GetPropertySet(), uno::UNO_QUERY );
             OSL_ASSERT( xCurve.is());
             if( xCurve.is())
             {
@@ -187,7 +263,6 @@
 
         case SCHATTR_REGRESSION_SHOW_COEFF:
         {
-            uno::Reference< chart2::XRegressionCurve > xCurve( GetPropertySet(), uno::UNO_QUERY );
             OSL_ASSERT( xCurve.is());
             if( xCurve.is())
             {
--- chart2/source/controller/itemsetwrapper/SchWhichPairs.hxx	2007-11-23 12:52:40.000000000 +0100
+++ chart2/source/controller/itemsetwrapper/SchWhichPairs.hxx	2008-01-11 16:58:42.000000000 +0100
@@ -166,8 +166,9 @@
 #define CHART_SERIES_OPTIONS_WHICHPAIRS \
     SCHATTR_AXIS,SCHATTR_AXIS,						/*    69          sch/schattr.hxx*/	\
     SCHATTR_BAR_OVERLAP,SCHATTR_BAR_CONNECT,         /*    98 - 100 (incl. SCHATTR_GAPWIDTH) */  \
-    SCHATTR_GROUP_BARS_PER_AXIS,SCHATTR_AXIS_FOR_ALL_SERIES \
-
+    SCHATTR_GROUP_BARS_PER_AXIS,SCHATTR_AXIS_FOR_ALL_SERIES, \
+    SCHATTR_STARTING_ANGLE,SCHATTR_STARTING_ANGLE, \
+    SCHATTR_CLOCKWISE,SCHATTR_CLOCKWISE \
 
 const USHORT nSeriesOptionsWhichPairs[] =
 {
@@ -210,6 +211,7 @@
 const USHORT nStatWhichPairs[]=
 {
 	SCHATTR_STAT_START, SCHATTR_STAT_END,			//    45 -    52  sch/schattr.hxx
+    SCHATTR_REGRESSION_START, SCHATTR_REGRESSION_END,
     0
 };
 
@@ -255,6 +257,7 @@
 const USHORT nRegressionCurveWhichPairs[] =
 {
     SCHATTR_REGRESSION_START, SCHATTR_REGRESSION_END, // 108 -   109
+    SCHATTR_STAT_REGRESSTYPE, SCHATTR_STAT_REGRESSTYPE,
 	XATTR_LINE_FIRST, XATTR_LINE_LAST,				//  1000 -  1016  svx/xdef.hxx
     0
 };
--- chart2/source/controller/itemsetwrapper/SeriesOptionsItemConverter.cxx	2007-10-22 18:52:03.000000000 +0200
+++ chart2/source/controller/itemsetwrapper/SeriesOptionsItemConverter.cxx	2008-02-02 16:49:19.000000000 +0100
@@ -94,6 +94,9 @@
         , m_bGroupBarsPerAxis(true)
         , m_bAllSeriesAttachedToSameAxis(true)
         , m_nAllSeriesAxisIndex(-1)
+        , m_bSupportingStartingAngle(false)
+        , m_nStartingAngle(90)
+        , m_bClockwise(false)
 {
     try
     {
@@ -105,6 +108,14 @@
         uno::Reference< beans::XPropertySet > xDiagramProperties( xDiagram, uno::UNO_QUERY );
         uno::Reference< XChartType > xChartType( DiagramHelper::getChartTypeOfSeries( xDiagram , xDataSeries ) );
 
+        m_xCooSys = DataSeriesHelper::getCoordinateSystemOfSeries( xDataSeries, xDiagram );
+        if( m_xCooSys.is() )
+        {
+            uno::Reference< chart2::XAxis > xAxis( AxisHelper::getAxis( 1, 0, m_xCooSys ) );
+            chart2::ScaleData aScale( xAxis->getScaleData() );
+            m_bClockwise = (aScale.Orientation == chart2::AxisOrientation_REVERSE);
+        }
+
         sal_Int32 nDimensionCount = DiagramHelper::getDimension( xDiagram );
         m_bSupportingOverlapAndGapWidthProperties = ChartTypeHelper::isSupportingOverlapAndGapWidthProperties( xChartType, nDimensionCount );
 
@@ -142,6 +153,12 @@
             xDiagramProperties->getPropertyValue( C2U("GroupBarsPerAxis")) >>= m_bGroupBarsPerAxis;
             m_bAllSeriesAttachedToSameAxis = ChartTypeHelper::allSeriesAttachedToSameAxis( xChartType, m_nAllSeriesAxisIndex );
         }
+
+        m_bSupportingStartingAngle = ChartTypeHelper::isSupportingStartingAngle( xChartType );
+        if( m_bSupportingStartingAngle )
+        {
+            xDiagramProperties->getPropertyValue( C2U( "StartingAngle" ) ) >>= m_nStartingAngle;
+        }
     }
     catch( uno::Exception ex )
     {
@@ -221,6 +238,7 @@
                                 m_aBarPositionSequence[nAxisIndex] = rBarPosition;
                                 
                             xChartTypeProps->setPropertyValue( aPropName, uno::makeAny(m_aBarPositionSequence) );
+                            bChanged = true;
                         }
                     }
                 }
@@ -241,6 +259,7 @@
                     bOldConnectBars != m_bConnectBars )
                 {
                     xDiagramProperties->setPropertyValue( C2U("ConnectBars"), uno::makeAny(m_bConnectBars) );
+                    bChanged = true;
                 }
             }
         }
@@ -259,10 +278,44 @@
                     bOldGroupBarsPerAxis != m_bGroupBarsPerAxis )
                 {
                     xDiagramProperties->setPropertyValue( C2U("GroupBarsPerAxis"), uno::makeAny(m_bGroupBarsPerAxis) );
+                    bChanged = true;
                 }
             }
          }
          break;
+
+         case SCHATTR_STARTING_ANGLE:
+         {
+            if( m_bSupportingStartingAngle )
+            {
+                m_nStartingAngle = static_cast< const SfxInt32Item & >( rItemSet.Get( nWhichId )).GetValue();
+                uno::Reference< beans::XPropertySet > xDiagramProperties( ChartModelHelper::findDiagram(m_xChartModel), uno::UNO_QUERY );
+                if( xDiagramProperties.is() )
+                {
+                    xDiagramProperties->setPropertyValue( C2U("StartingAngle"), uno::makeAny(m_nStartingAngle) );
+                    bChanged = true;
+                }
+            }
+        }
+        break;
+
+        case SCHATTR_CLOCKWISE:
+        { 
+            bool bClockwise = (static_cast< const SfxBoolItem & >(
+                     rItemSet.Get( nWhichId )).GetValue() );
+            if( m_xCooSys.is() )
+            {
+                uno::Reference< chart2::XAxis > xAxis( AxisHelper::getAxis( 1, 0, m_xCooSys ) );
+                if( xAxis.is() )
+                {
+                    chart2::ScaleData aScaleData( xAxis->getScaleData() );
+                    aScaleData.Orientation = bClockwise ? chart2::AxisOrientation_REVERSE : chart2::AxisOrientation_MATHEMATICAL;
+                    xAxis->setScaleData( aScaleData );
+                    bChanged = true;
+                }
+            }
+        }
+        break;
     }
     return bChanged;
 }
@@ -309,6 +362,17 @@
                 rOutItemSet.Put( SfxInt32Item(nWhichId, m_nAllSeriesAxisIndex));
             break;
         }
+        case SCHATTR_STARTING_ANGLE:
+        {
+            if( m_bSupportingStartingAngle )
+                rOutItemSet.Put( SfxInt32Item(nWhichId,m_nStartingAngle));
+            break;
+        }
+        case SCHATTR_CLOCKWISE:
+        {
+            rOutItemSet.Put( SfxBoolItem(nWhichId,m_bClockwise) );
+            break;
+        }
         default:
             break;
    }
--- chart2/source/controller/itemsetwrapper/StatisticsItemConverter.cxx	2007-11-23 12:52:56.000000000 +0100
+++ chart2/source/controller/itemsetwrapper/StatisticsItemConverter.cxx	2008-01-11 16:58:42.000000000 +0100
@@ -162,6 +162,37 @@
     }
 }
 
+uno::Reference< beans::XPropertySet > lcl_getEquationProperties(
+    const uno::Reference< beans::XPropertySet > & xSeriesPropSet, const SfxItemSet * pItemSet )
+{
+    bool bEquationExists = true;
+
+    // ensure that a trendline is on
+    if( pItemSet )
+    {
+        SvxChartRegress eRegress = CHREGRESS_NONE;
+        const SfxPoolItem *pPoolItem = NULL;
+        if( pItemSet->GetItemState( SCHATTR_STAT_REGRESSTYPE, TRUE, &pPoolItem ) == SFX_ITEM_SET )
+        {
+            eRegress = static_cast< const SvxChartRegressItem * >( pPoolItem )->GetValue();
+            bEquationExists = ( eRegress != CHREGRESS_NONE );
+        }
+    }
+
+    if( bEquationExists )
+    {
+        uno::Reference< chart2::XRegressionCurveContainer > xRegCnt( xSeriesPropSet, uno::UNO_QUERY );
+        uno::Reference< chart2::XRegressionCurve > xCurve(
+            ::chart::RegressionCurveHelper::getFirstCurveNotMeanValueLine( xRegCnt ));
+        if( xCurve.is())
+        {
+            return xCurve->getEquationProperties();
+        }
+    }
+
+    return uno::Reference< beans::XPropertySet >();
+}
+
 } // anonymous namespace
 
 namespace chart
@@ -388,6 +419,42 @@
         }
         break;
 
+        case SCHATTR_REGRESSION_SHOW_EQUATION:
+        {
+            uno::Reference< beans::XPropertySet > xEqProp( lcl_getEquationProperties( GetPropertySet(), &rItemSet ));
+            if( xEqProp.is())
+            {
+                bool bShowEq = false;
+                xEqProp->getPropertyValue( C2U("ShowEquation")) >>= bShowEq;
+                bool bNewShowEq =
+                    static_cast< const SfxBoolItem & >( rItemSet.Get( nWhichId )).GetValue();
+                if( bShowEq != bNewShowEq )
+                {
+                    xEqProp->setPropertyValue( C2U("ShowEquation"), uno::makeAny( bNewShowEq ));
+                    bChanged = true;
+                }
+            }
+        }
+        break;
+
+        case SCHATTR_REGRESSION_SHOW_COEFF:
+        {
+            uno::Reference< beans::XPropertySet > xEqProp( lcl_getEquationProperties( GetPropertySet(), &rItemSet ));
+            if( xEqProp.is())
+            {
+                bool bShowCoeff = false;
+                xEqProp->getPropertyValue( C2U("ShowCorrelationCoefficient")) >>= bShowCoeff;
+                bool bNewShowCoeff =
+                    static_cast< const SfxBoolItem & >( rItemSet.Get( nWhichId )).GetValue();
+                if( bShowCoeff != bNewShowCoeff )
+                {
+                    xEqProp->setPropertyValue( C2U("ShowCorrelationCoefficient"), uno::makeAny( bNewShowCoeff ));
+                    bChanged = true;
+                }
+            }
+        }
+        break;
+
         case SCHATTR_STAT_INDICATE:
         {
             uno::Reference< beans::XPropertySet > xOldErrorBarProp(
@@ -533,6 +600,34 @@
         }
         break;
 
+        case SCHATTR_REGRESSION_SHOW_EQUATION:
+        {
+            uno::Reference< beans::XPropertySet > xEqProp( lcl_getEquationProperties( GetPropertySet(), 0 ));
+            if( xEqProp.is())
+            {
+                bool bShowEq = false;
+                if( xEqProp->getPropertyValue( C2U("ShowEquation")) >>= bShowEq )
+                    rOutItemSet.Put( SfxBoolItem( nWhichId, bShowEq ));
+            }
+            else
+                rOutItemSet.InvalidateItem( nWhichId );
+        }
+        break;
+
+        case SCHATTR_REGRESSION_SHOW_COEFF:
+        {
+            uno::Reference< beans::XPropertySet > xEqProp( lcl_getEquationProperties( GetPropertySet(), 0 ));
+            if( xEqProp.is())
+            {
+                bool bShowCoeff = false;
+                if( xEqProp->getPropertyValue( C2U("ShowCorrelationCoefficient")) >>= bShowCoeff )
+                    rOutItemSet.Put( SfxBoolItem( nWhichId, bShowCoeff ));
+            }
+            else
+                rOutItemSet.InvalidateItem( nWhichId );
+        }
+        break;
+
         case SCHATTR_STAT_INDICATE:
         {
             uno::Reference< beans::XPropertySet > xErrorBarProp( lcl_GetYErrorBar( GetPropertySet()));
--- chart2/source/controller/main/ChartController.cxx	2008-01-14 14:57:58.000000000 +0100
+++ chart2/source/controller/main/ChartController.cxx	2008-01-18 16:08:56.000000000 +0100
@@ -983,6 +983,8 @@
         || aCommand.equals("XTitle")
         || aCommand.equals("YTitle")
         || aCommand.equals("ZTitle")
+        || aCommand.equals("SecondaryXTitle")
+        || aCommand.equals("SecondaryYTitle")
         || aCommand.equals("AllTitles")
         || aCommand.equals("Legend")
         || aCommand.equals("DiagramAxisX")
@@ -1080,12 +1082,20 @@
         this->executeDispatch_InsertAxis();
     else if( aCommand.equals("InsertGrids"))
         this->executeDispatch_InsertGrid();
-    else if( aCommand.equals("InsertStatistics"))
-        this->executeDispatch_InsertStatistic();
+//     else if( aCommand.equals("InsertStatistics"))
+//         this->executeDispatch_InsertStatistic();
+    else if( aCommand.equals("InsertTrendlines"))
+        this->executeDispatch_InsertTrendlines();
+    else if( aCommand.equals("InsertMeanValues"))
+        this->executeDispatch_InsertMeanValues();
+    else if( aCommand.equals("InsertYErrorbars"))
+        this->executeDispatch_InsertYErrorbars();
     else if( aCommand.equals("InsertSymbol"))
          this->executeDispatch_InsertSpecialCharacter();
     else if( aCommand.equals("InsertTrendline"))
          this->executeDispatch_InsertTrendline();
+    else if( aCommand.equals("InsertMeanValue"))
+        this->executeDispatch_InsertMeanValue();
     else if( aCommand.equals("InsertTrendlineEquation"))
          this->executeDispatch_InsertTrendlineEquation();
     //format objects
@@ -1398,6 +1408,8 @@
         ( C2U("InsertTitle") )        ( C2U("InsertLegend") )         ( C2U("InsertDescription") )
         ( C2U("InsertAxis") )         ( C2U("InsertGrids") )          ( C2U("InsertStatistics") )
         ( C2U("InsertSymbol") )       ( C2U("InsertTrendline") )      ( C2U("InsertTrendlineEquation") )
+        ( C2U("InsertTrendlines") )   ( C2U("InsertMeanValue") )      ( C2U("InsertMeanValues") )
+        ( C2U("InsertYErrorbars") )
         //format objects
 //MENUCHANGE            ( C2U("SelectSourceRanges") )
         ( C2U("DiagramObjects") )     ( C2U("TransformDialog") )
@@ -1405,6 +1417,7 @@
         ( C2U("Forward") )            ( C2U("Backward") )
         ( C2U("MainTitle") )          ( C2U("SubTitle") )
         ( C2U("XTitle") )             ( C2U("YTitle") )               ( C2U("ZTitle") )
+        ( C2U("SecondaryXTitle") )    ( C2U("SecondaryYTitle") )
         ( C2U("AllTitles") )          ( C2U("Legend") )
         ( C2U("DiagramAxisX") )       ( C2U("DiagramAxisY") )         ( C2U("DiagramAxisZ") )
         ( C2U("DiagramAxisA") )       ( C2U("DiagramAxisB") )         ( C2U("DiagramAxisAll") )
--- chart2/source/controller/main/ChartController.hxx	2007-11-23 12:53:39.000000000 +0100
+++ chart2/source/controller/main/ChartController.hxx	2008-01-14 14:46:09.000000000 +0100
@@ -607,7 +607,11 @@
     void SAL_CALL       executeDispatch_InsertDataLabel();
     void SAL_CALL       executeDispatch_InsertAxis();
     void SAL_CALL       executeDispatch_InsertGrid();
-    void SAL_CALL       executeDispatch_InsertStatistic();
+//     void SAL_CALL       executeDispatch_InsertStatistic();
+    void SAL_CALL       executeDispatch_InsertYErrorbars();
+    void SAL_CALL       executeDispatch_InsertTrendlines();
+    void SAL_CALL       executeDispatch_InsertMeanValue();
+    void SAL_CALL       executeDispatch_InsertMeanValues();
     void SAL_CALL       executeDispatch_InsertTrendline();
     void SAL_CALL       executeDispatch_InsertTrendlineEquation();
 
--- chart2/source/controller/main/ChartController_Insert.cxx	2007-11-23 12:53:59.000000000 +0100
+++ chart2/source/controller/main/ChartController_Insert.cxx	2008-01-15 09:19:42.000000000 +0100
@@ -40,25 +40,30 @@
 #include "dlg_InsertAxis_Grid.hxx"
 #include "dlg_InsertDataLabel.hxx"
 #include "dlg_InsertLegend.hxx"
-#include "dlg_InsertStatistic.hxx"
+#include "dlg_InsertTrendline.hxx"
+#include "dlg_InsertErrorBars.hxx"
 #include "dlg_InsertTitle.hxx"
+#include "dlg_ObjectProperties.hxx"
 
 #include "ChartWindow.hxx"
 #include "ChartModelHelper.hxx"
 #include "AxisHelper.hxx"
 #include "TitleHelper.hxx"
+#include "DiagramHelper.hxx"
 #include "ContextHelper.hxx"
 #include "macros.hxx"
 #include "chartview/DrawModelWrapper.hxx"
+#include "chartview/NumberFormatterWrapper.hxx"
+#include "ViewElementListProvider.hxx"
 #include "MultipleChartConverters.hxx"
 #include "ControllerLockGuard.hxx"
 #include "UndoGuard.hxx"
 #include "ResId.hxx"
 #include "Strings.hrc"
 #include "ReferenceSizeProvider.hxx"
-#include "chartview/NumberFormatterWrapper.hxx"
 #include "ObjectIdentifier.hxx"
 #include "RegressionCurveHelper.hxx"
+#include "RegressionCurveItemConverter.hxx"
 
 #include <com/sun/star/chart2/XRegressionCurve.hpp>
 
@@ -85,16 +90,42 @@
 #include <vos/mutex.hxx>
 #endif
 
-//.............................................................................
-namespace chart
-{
-//.............................................................................
 
 using namespace ::com::sun::star;
 using namespace ::com::sun::star::chart2;
 
-//-----------------------------------------------------------------------------
-//-----------------------------------------------------------------------------
+//.............................................................................
+
+namespace
+{
+struct lcl_InsertMeanValueLine
+{
+public:
+    lcl_InsertMeanValueLine( const uno::Reference< uno::XComponentContext > & xContext ) :
+            m_xContext( xContext )
+    {}
+
+    void operator()( const uno::Reference< chart2::XDataSeries > & xSeries )
+    {
+        uno::Reference< chart2::XRegressionCurveContainer > xRegCurveCnt(
+            xSeries, uno::UNO_QUERY );
+        if( xRegCurveCnt.is())
+        {
+            ::chart::RegressionCurveHelper::addMeanValueLine(
+                xRegCurveCnt, m_xContext, uno::Reference< beans::XPropertySet >( xSeries, uno::UNO_QUERY ));
+        }
+    }
+
+private:
+    uno::Reference< uno::XComponentContext > m_xContext;
+};
+
+} // anonymous namespace
+
+//.............................................................................
+namespace chart
+{
+//.............................................................................
 
 void SAL_CALL ChartController::executeDispatch_InsertAxis()
 {
@@ -277,11 +308,72 @@
     }
 }
 
-void SAL_CALL ChartController::executeDispatch_InsertStatistic()
+void SAL_CALL ChartController::executeDispatch_InsertYErrorbars()
+{
+    UndoGuard aUndoGuard(
+        ActionDescriptionProvider::createDescription(
+            ActionDescriptionProvider::INSERT, ::rtl::OUString( String( SchResId( STR_PAGE_YERROR_BARS )))),
+        m_xUndoManager, m_aModel->getModel() );
+
+    try
+    {
+        wrapper::AllSeriesStatisticsConverter aItemConverter(
+            m_aModel->getModel(), m_pDrawModelWrapper->GetItemPool() );
+        SfxItemSet aItemSet = aItemConverter.CreateEmptyItemSet();
+        aItemConverter.FillItemSet( aItemSet );
+
+        //prepare and open dialog
+        ::vos::OGuard aGuard( Application::GetSolarMutex());
+        InsertErrorBarsDialog aDlg( m_pChartWindow, aItemSet);
+        aDlg.SetAxisMinorStepWidthForErrorBarDecimals(
+            InsertErrorBarsDialog::getAxisMinorStepWidthForErrorBarDecimals( m_aModel->getModel(), m_xChartView, rtl::OUString() ) );
+
+        if( aDlg.Execute() == RET_OK )
+        {
+            SfxItemSet aOutItemSet = aItemConverter.CreateEmptyItemSet();
+            aDlg.FillItemSet( aOutItemSet );
+
+            // lock controllers till end of block
+            ControllerLockGuard aCLGuard( m_aModel->getModel());
+            bool bChanged = aItemConverter.ApplyItemSet( aOutItemSet );//model should be changed now
+            if( bChanged )
+                aUndoGuard.commitAction();
+        }
+    }
+    catch( uno::RuntimeException& e)
+    {
+        ASSERT_EXCEPTION( e );
+    }
+}
+
+void SAL_CALL ChartController::executeDispatch_InsertMeanValue()
 {
     UndoGuard aUndoGuard(
         ActionDescriptionProvider::createDescription(
-            ActionDescriptionProvider::INSERT, ::rtl::OUString( String( SchResId( STR_PAGE_STATISTICS )))),
+            ActionDescriptionProvider::INSERT, ::rtl::OUString( String( SchResId( STR_OBJECT_AVERAGE_LINE )))),
+        m_xUndoManager, m_aModel->getModel());
+    lcl_InsertMeanValueLine( m_xCC ).operator()(
+        ObjectIdentifier::getDataSeriesForCID( m_aSelection.getSelectedCID(), m_aModel->getModel()));
+    aUndoGuard.commitAction();
+}
+
+void SAL_CALL ChartController::executeDispatch_InsertMeanValues()
+{
+    ::std::vector< uno::Reference< chart2::XDataSeries > > aSeries(
+        DiagramHelper::getDataSeriesFromDiagram( ChartModelHelper::findDiagram( m_aModel->getModel())));
+    UndoGuard aUndoGuard(
+        ActionDescriptionProvider::createDescription(
+            ActionDescriptionProvider::INSERT, ::rtl::OUString( String( SchResId( STR_OBJECT_AVERAGE_LINE )))),
+        m_xUndoManager, m_aModel->getModel() );
+    ::std::for_each( aSeries.begin(), aSeries.end(), lcl_InsertMeanValueLine( m_xCC ));
+    aUndoGuard.commitAction();
+}
+
+void SAL_CALL ChartController::executeDispatch_InsertTrendlines()
+{
+    UndoGuard aUndoGuard(
+        ActionDescriptionProvider::createDescription(
+            ActionDescriptionProvider::INSERT, ::rtl::OUString( String( SchResId( STR_OBJECT_CURVES )))),
         m_xUndoManager, m_aModel->getModel() );
 
     try
@@ -293,11 +385,8 @@
 
         //prepare and open dialog
         ::vos::OGuard aGuard( Application::GetSolarMutex());
-        SchDataStatisticsDlg aDlg( m_pChartWindow, aItemSet);
-//         aDlg.EnableTrendLine( ChartTypeHelper::isSupportingRegressionProperties( xChartType ));
-        aDlg.EnableTrendLine( true );
-        aDlg.SetAxisMinorStepWidthForErrorBarDecimals( 
-            SchDataStatisticsDlg::getAxisMinorStepWidthForErrorBarDecimals( m_aModel->getModel(), m_xChartView, rtl::OUString() ) );
+        InsertTrendlineDialog aDlg( m_pChartWindow, aItemSet );
+        aDlg.adjustSize();
 
         if( aDlg.Execute() == RET_OK )
         {
@@ -320,17 +409,54 @@
 void SAL_CALL ChartController::executeDispatch_InsertTrendline()
 {
     uno::Reference< chart2::XRegressionCurveContainer > xRegCurveCnt(
-        ObjectIdentifier::getObjectPropertySet( m_aSelection.getSelectedCID(), m_aModel->getModel()), uno::UNO_QUERY );
+        ObjectIdentifier::getDataSeriesForCID( m_aSelection.getSelectedCID(), m_aModel->getModel()), uno::UNO_QUERY );
     if( xRegCurveCnt.is())
     {
-        UndoGuard aUndoGuard(
+        UndoLiveUpdateGuard aUndoGuard(
             ActionDescriptionProvider::createDescription(
                 ActionDescriptionProvider::INSERT, ::rtl::OUString( String( SchResId( STR_OBJECT_CURVE )))),
             m_xUndoManager, m_aModel->getModel() );
 
+        // add a linear curve
         RegressionCurveHelper::addRegressionCurve(
             RegressionCurveHelper::REGRESSION_TYPE_LINEAR, xRegCurveCnt, m_xCC );
-        aUndoGuard.commitAction();
+
+        // get an appropriate item converter
+        uno::Reference< chart2::XRegressionCurve > xCurve(
+            RegressionCurveHelper::getFirstCurveNotMeanValueLine( xRegCurveCnt ));
+        uno::Reference< beans::XPropertySet > xCurveProp( xCurve, uno::UNO_QUERY );
+        if( !xCurveProp.is())
+            return;
+        wrapper::RegressionCurveItemConverter aItemConverter(
+            xCurveProp, xRegCurveCnt, m_pDrawModelWrapper->getSdrModel().GetItemPool(),
+            m_pDrawModelWrapper->getSdrModel(),
+            uno::Reference< lang::XMultiServiceFactory >( m_aModel->getModel(), uno::UNO_QUERY ));
+
+        // open dialog
+        SfxItemSet aItemSet = aItemConverter.CreateEmptyItemSet();
+        aItemConverter.FillItemSet( aItemSet );
+        ObjectPropertiesDialogParameter aDialogParameter = ObjectPropertiesDialogParameter(
+            ObjectIdentifier::createDataCurveCID(
+                ObjectIdentifier::getSeriesParticleFromCID( m_aSelection.getSelectedCID()),
+                RegressionCurveHelper::getRegressionCurveIndex( xRegCurveCnt, xCurve ), false ));
+		aDialogParameter.init( m_aModel->getModel() );
+        ViewElementListProvider aViewElementListProvider( m_pDrawModelWrapper.get());
+        ::vos::OGuard aGuard( Application::GetSolarMutex());
+        SchAttribTabDlg aDlg( m_pChartWindow, &aItemSet, &aDialogParameter, &aViewElementListProvider,
+                              uno::Reference< util::XNumberFormatsSupplier >( m_aModel->getModel(), uno::UNO_QUERY ));
+
+        // note: when a user pressed "OK" but didn't change any settings in the
+        // dialog, the SfxTabDialog returns "Cancel"
+        if( aDlg.Execute() == RET_OK || aDlg.DialogWasClosedWithOK())
+        {
+            const SfxItemSet* pOutItemSet = aDlg.GetOutputItemSet();
+            if( pOutItemSet )
+            {
+                ControllerLockGuard aCLGuard( m_aModel->getModel());
+                aItemConverter.ApplyItemSet( *pOutItemSet );
+            }
+            aUndoGuard.commitAction();
+        }
     }
 }
 
--- chart2/source/controller/main/ChartController_Properties.cxx	2007-11-23 12:54:14.000000000 +0100
+++ chart2/source/controller/main/ChartController_Properties.cxx	2008-01-11 16:58:43.000000000 +0100
@@ -43,7 +43,7 @@
 #include "macros.hxx"
 #include "dlg_ObjectProperties.hxx"
 #include "dlg_View3D.hxx"
-#include "dlg_InsertStatistic.hxx"
+#include "dlg_InsertErrorBars.hxx"
 #include "ViewElementListProvider.hxx"
 #include "DataPointItemConverter.hxx"
 #include "AxisItemConverter.hxx"
@@ -282,11 +282,14 @@
                                         rDrawModel, uno::Reference< lang::XMultiServiceFactory >( xChartModel, uno::UNO_QUERY ),
                                         wrapper::GraphicPropertyItemConverter::LINE_PROPERTIES );
                     break;
+
             case OBJECTTYPE_DATA_CURVE:
                 pItemConverter =  new wrapper::RegressionCurveItemConverter(
-                                        xObjectProperties, rDrawModel.GetItemPool(),
-                                        rDrawModel, uno::Reference< lang::XMultiServiceFactory >( xChartModel, uno::UNO_QUERY ));
-                    break;
+                    xObjectProperties, uno::Reference< chart2::XRegressionCurveContainer >(
+                        ObjectIdentifier::getDataSeriesForCID( aObjectCID, xChartModel ), uno::UNO_QUERY ),
+                    rDrawModel.GetItemPool(), rDrawModel,
+                    uno::Reference< lang::XMultiServiceFactory >( xChartModel, uno::UNO_QUERY ));
+                break;
             case OBJECTTYPE_DATA_CURVE_EQUATION:
             {
                 ::std::auto_ptr< awt::Size > pRefSize;
@@ -364,7 +367,11 @@
         nTitleType = TitleHelper::Y_AXIS_TITLE;
     else if( rDispatchCommand.equals("ZTitle") )
         nTitleType = TitleHelper::Z_AXIS_TITLE;
-    
+    else if( rDispatchCommand.equals("SecondaryXTitle") )
+        nTitleType = TitleHelper::SECONDARY_X_AXIS_TITLE;
+    else if( rDispatchCommand.equals("SecondaryYTitle") )
+        nTitleType = TitleHelper::SECONDARY_Y_AXIS_TITLE;
+  
     uno::Reference< XTitle > xTitle( TitleHelper::getTitle( nTitleType, xChartModel ) );
     return ObjectIdentifier::createClassifiedIdentifierForObject( xTitle, xChartModel );
 }
@@ -484,6 +491,8 @@
         || rDispatchCommand.equals("XTitle")
         || rDispatchCommand.equals("YTitle")
         || rDispatchCommand.equals("ZTitle")
+        || rDispatchCommand.equals("SecondaryXTitle")
+        || rDispatchCommand.equals("SecondaryYTitle")
         || rDispatchCommand.equals("AllTitles")
         )
     {
@@ -635,8 +644,8 @@
         }
         if( aDialogParameter.HasRegressionProperties() )
         {
-            aDlg.SetAxisMinorStepWidthForErrorBarDecimals( 
-                SchDataStatisticsDlg::getAxisMinorStepWidthForErrorBarDecimals( m_aModel->getModel(), m_xChartView, aObjectCID ) );
+            aDlg.SetAxisMinorStepWidthForErrorBarDecimals(
+                InsertErrorBarsDialog::getAxisMinorStepWidthForErrorBarDecimals( m_aModel->getModel(), m_xChartView, aObjectCID ) );
         }
 
         //-------------------------------------------------------------
--- chart2/source/controller/main/ChartController_Tools.cxx	2007-11-23 12:54:29.000000000 +0100
+++ chart2/source/controller/main/ChartController_Tools.cxx	2008-01-15 08:46:45.000000000 +0100
@@ -95,8 +95,56 @@
 using ::com::sun::star::uno::Sequence;
 using ::rtl::OUString;
 
-// namespace
-// {
+namespace
+{
+
+bool lcl_deleteDataSeries(
+    const OUString & rCID,
+    const Reference< frame::XModel > & xModel,
+    const Reference< chart2::XUndoManager > & xUndoManager )
+{
+    bool bResult = false;
+    uno::Reference< chart2::XDataSeries > xSeries( ::chart::ObjectIdentifier::getDataSeriesForCID( rCID, xModel ));
+    uno::Reference< chart2::XChartDocument > xChartDoc( xModel, uno::UNO_QUERY );
+    if( xSeries.is() && xChartDoc.is())
+    {
+        uno::Reference< chart2::XChartType > xChartType(
+            ::chart::DataSeriesHelper::getChartTypeOfSeries( xSeries, xChartDoc->getFirstDiagram()));
+        if( xChartType.is())
+        {
+            ::chart::UndoGuard aUndoGuard(
+                ActionDescriptionProvider::createDescription(
+                    ActionDescriptionProvider::DELETE, ::rtl::OUString( String( ::chart::SchResId( STR_OBJECT_DATASERIES )))),
+                xUndoManager, xModel );
+            ::chart::DataSeriesHelper::deleteSeries( xSeries, xChartType );
+            bResult = true;
+            aUndoGuard.commitAction();
+        }
+    }
+    return bResult;
+}
+
+bool lcl_deleteDataCurve(
+    const OUString & rCID,
+    const Reference< frame::XModel > & xModel,
+    const Reference< chart2::XUndoManager > & xUndoManager )
+{
+    bool bResult = false;
+    uno::Reference< chart2::XRegressionCurveContainer > xRegCurveCnt(
+        ::chart::ObjectIdentifier::getObjectPropertySet(
+            ::chart::ObjectIdentifier::getSeriesParticleFromCID( rCID ), xModel ), uno::UNO_QUERY );
+    if( xRegCurveCnt.is())
+    {
+        ::chart::UndoGuard aUndoGuard(
+            ActionDescriptionProvider::createDescription(
+                ActionDescriptionProvider::DELETE, ::rtl::OUString( String( ::chart::SchResId( STR_OBJECT_CURVE )))),
+            xUndoManager, xModel );
+        ::chart::RegressionCurveHelper::removeAllExceptMeanValueLine( xRegCurveCnt );
+        bResult = true;
+        aUndoGuard.commitAction();
+    }
+    return bResult;
+}
 
 // void lcl_CopyPageContentToPage(
 //     const Reference< drawing::XDrawPage > & xSourcePage,
@@ -143,7 +191,7 @@
 //     }
 // }
 
-// } // anonymous namespace
+} // anonymous namespace
 
 namespace
 {
@@ -495,7 +543,8 @@
             return true;
         if( (OBJECTTYPE_DATA_SERIES == aObjectType) || (OBJECTTYPE_LEGEND_ENTRY == aObjectType) )
             return true;
-        if( (OBJECTTYPE_DATA_CURVE_EQUATION == aObjectType) || (OBJECTTYPE_DATA_CURVE == aObjectType) )
+        if( (OBJECTTYPE_DATA_CURVE_EQUATION == aObjectType) || (OBJECTTYPE_DATA_CURVE == aObjectType) ||
+            (OBJECTTYPE_DATA_AVERAGE_LINE == aObjectType))
             return true;
         if( (OBJECTTYPE_DATA_LABELS == aObjectType) || (OBJECTTYPE_DATA_LABEL == aObjectType) )
             return true;
@@ -559,28 +608,23 @@
                 }
                 break;
             }
-            case OBJECTTYPE_DATA_SERIES: //fall through intended
+
+            case OBJECTTYPE_DATA_SERIES:
+                bReturn = lcl_deleteDataSeries( aCID, m_aModel->getModel(), m_xUndoManager );
+                break;
+
             case OBJECTTYPE_LEGEND_ENTRY:
             {
-                uno::Reference< chart2::XDataSeries > xSeries( ObjectIdentifier::getDataSeriesForCID( aCID, m_aModel->getModel() ));
-                if( xSeries.is() )
-                {
-                    uno::Reference< chart2::XChartType > xChartType(
-                        DataSeriesHelper::getChartTypeOfSeries( xSeries, xChartDoc->getFirstDiagram()));
-                    if( xChartType.is())
-                    {
-                        UndoGuard aUndoGuard(
-                            ActionDescriptionProvider::createDescription(
-                                ActionDescriptionProvider::DELETE, ::rtl::OUString( String( SchResId( STR_OBJECT_DATASERIES )))),
-                            m_xUndoManager, m_aModel->getModel() );
-                        DataSeriesHelper::deleteSeries( xSeries, xChartType );
-                        bReturn = true;
-                        aUndoGuard.commitAction();
-                    }
-                }
+                ObjectType eParentObjectType = ObjectIdentifier::getObjectType(
+                    ObjectIdentifier::getFullParentParticle( aCID ));
+                if( eParentObjectType == OBJECTTYPE_DATA_SERIES )
+                    bReturn = lcl_deleteDataSeries( aCID, m_aModel->getModel(), m_xUndoManager );
+                else if( eParentObjectType == OBJECTTYPE_DATA_CURVE )
+                    bReturn = lcl_deleteDataCurve( aCID, m_aModel->getModel(), m_xUndoManager );
                 break;
             }
-            case OBJECTTYPE_DATA_CURVE:
+
+            case OBJECTTYPE_DATA_AVERAGE_LINE:
             {
                 uno::Reference< chart2::XRegressionCurveContainer > xRegCurveCnt(
                     ObjectIdentifier::getObjectPropertySet(
@@ -590,14 +634,19 @@
                     // using assignment for broken gcc 3.3
                     UndoGuard aUndoGuard = UndoGuard(
                         ActionDescriptionProvider::createDescription(
-                            ActionDescriptionProvider::DELETE, ::rtl::OUString( String( SchResId( STR_OBJECT_CURVE )))),
+                            ActionDescriptionProvider::DELETE, ::rtl::OUString( String( SchResId( STR_OBJECT_AVERAGE_LINE )))),
                         m_xUndoManager, m_aModel->getModel() );
-                    RegressionCurveHelper::removeAllExceptMeanValueLine( xRegCurveCnt );
+                    RegressionCurveHelper::removeMeanValueLine( xRegCurveCnt );
                     bReturn = true;
                     aUndoGuard.commitAction();
                 }
                 break;
             }
+
+            case OBJECTTYPE_DATA_CURVE:
+                bReturn = lcl_deleteDataCurve( aCID, m_aModel->getModel(), m_xUndoManager );
+                break;
+
             case OBJECTTYPE_DATA_CURVE_EQUATION:
             {
                 uno::Reference< beans::XPropertySet > xEqProp(
--- chart2/source/controller/main/ChartController_Window.cxx	2007-11-23 12:54:45.000000000 +0100
+++ chart2/source/controller/main/ChartController_Window.cxx	2008-01-14 14:46:10.000000000 +0100
@@ -880,6 +880,7 @@
             xPopupMenu->insertSeparator( -1 );
             lcl_insertMenuCommand( xPopupMenu, xMenuEx, nUniqueId++, C2U(".uno:DiagramData"));
             xPopupMenu->insertSeparator( -1 );
+            lcl_insertMenuCommand( xPopupMenu, xMenuEx, nUniqueId++, C2U(".uno:InsertMeanValue"));
             lcl_insertMenuCommand( xPopupMenu, xMenuEx, nUniqueId++, C2U(".uno:InsertTrendline"));
             lcl_insertMenuCommand( xPopupMenu, xMenuEx, nUniqueId++, C2U(".uno:InsertTrendlineEquation"));
             xPopupMenu->insertSeparator( -1 );
--- chart2/source/controller/main/ControllerCommandDispatch.cxx	2008-01-14 14:58:25.000000000 +0100
+++ chart2/source/controller/main/ControllerCommandDispatch.cxx	2008-01-18 16:08:53.000000000 +0100
@@ -48,6 +48,7 @@
 #include "DiagramHelper.hxx"
 #include "ChartController.hxx"
 #include "RegressionCurveHelper.hxx"
+#include "DataSeriesHelper.hxx"
 
 #include <com/sun/star/util/XModifyBroadcaster.hpp>
 #include <com/sun/star/frame/XStorable.hpp>
@@ -137,6 +138,7 @@
     // trendlines
     bool bMayAddTrendline;
     bool bMayAddTrendlineEquation;
+    bool bMayAddMeanValue;
 };
 
 
@@ -149,7 +151,8 @@
         bMayMoveSeriesForward( false ),
         bMayMoveSeriesBackward( false ),
         bMayAddTrendline( false ),
-        bMayAddTrendlineEquation( false )
+        bMayAddTrendlineEquation( false ),
+        bMayAddMeanValue( false )
 {}
 
 void ControllerState::update(
@@ -172,11 +175,12 @@
 
         ObjectType aObjectType(ObjectIdentifier::getObjectType( aSelObjCID ));
         bIsTextObject = OBJECTTYPE_TITLE == aObjectType;
-        
+
+        uno::Reference< chart2::XDiagram > xDiagram( ChartModelHelper::findDiagram( xModel ));
         bIsFormateableObjectSelected = bHasSelectedObject;
         if( OBJECTTYPE_DIAGRAM==aObjectType || OBJECTTYPE_DIAGRAM_WALL==aObjectType || OBJECTTYPE_DIAGRAM_FLOOR==aObjectType )
-            bIsFormateableObjectSelected = DiagramHelper::isSupportingFloorAndWall( ChartModelHelper::findDiagram( xModel ) );
-        
+            bIsFormateableObjectSelected = DiagramHelper::isSupportingFloorAndWall( xDiagram );
+
         uno::Reference< chart2::XDataSeries > xGivenDataSeries(
             ObjectIdentifier::getDataSeriesForCID(
                 aSelObjCID, xModel ) );
@@ -195,18 +199,27 @@
 
         bMayAddTrendline = false;
         bMayAddTrendlineEquation = false;
+        bMayAddMeanValue = false;
         if( bHasSelectedObject )
         {
-            if( aObjectType == OBJECTTYPE_DATA_SERIES )
+            if( xGivenDataSeries.is())
             {
-                // @todo: only if trendlines are supported for the current chart
-                // type
-                uno::Reference< chart2::XRegressionCurveContainer > xRegCurveCnt(
-                    ObjectIdentifier::getObjectPropertySet( aSelObjCID, xModel ), uno::UNO_QUERY );
-                if( xRegCurveCnt.is())
-                    bMayAddTrendline = ! RegressionCurveHelper::getFirstCurveNotMeanValueLine( xRegCurveCnt ).is();
+                sal_Int32 nDimensionCount = DiagramHelper::getDimension( xDiagram );
+                if( ChartTypeHelper::isSupportingRegressionProperties(
+                    DataSeriesHelper::getChartTypeOfSeries( xGivenDataSeries, xDiagram ),
+                    nDimensionCount ))
+                {
+                    uno::Reference< chart2::XRegressionCurveContainer > xRegCurveCnt(
+                        xGivenDataSeries, uno::UNO_QUERY );
+                    if( xRegCurveCnt.is())
+                    {
+                        bMayAddTrendline = ! RegressionCurveHelper::getFirstCurveNotMeanValueLine( xRegCurveCnt ).is();
+                        bMayAddMeanValue = ! RegressionCurveHelper::hasMeanValueLine( xRegCurveCnt );
+                    }
+                }
             }
-            else if( aObjectType == OBJECTTYPE_DATA_CURVE )
+
+            if( aObjectType == OBJECTTYPE_DATA_CURVE )
             {
                 uno::Reference< chart2::XRegressionCurve > xRegCurve(
                     ObjectIdentifier::getObjectPropertySet( aSelObjCID, xModel ), uno::UNO_QUERY );
@@ -259,6 +272,8 @@
     bool bHasXAxisTitle;
     bool bHasYAxisTitle;
     bool bHasZAxisTitle;
+    bool bHasSecondaryXAxisTitle;
+    bool bHasSecondaryYAxisTitle;
 
     bool bHasXAxis;
     bool bHasYAxis;
@@ -291,6 +306,8 @@
         bHasXAxisTitle( false ),
         bHasYAxisTitle( false ),
         bHasZAxisTitle( false ),
+        bHasSecondaryXAxisTitle( false ),
+        bHasSecondaryYAxisTitle( false ),
         bHasXAxis( false ),
         bHasYAxis( false ),
         bHasZAxis( false ),
@@ -335,6 +352,8 @@
     bHasXAxisTitle = TitleHelper::getTitle( TitleHelper::X_AXIS_TITLE, xModel ).is();
     bHasYAxisTitle = TitleHelper::getTitle( TitleHelper::Y_AXIS_TITLE, xModel ).is();
     bHasZAxisTitle = TitleHelper::getTitle( TitleHelper::Z_AXIS_TITLE, xModel ).is();
+    bHasSecondaryXAxisTitle = TitleHelper::getTitle( TitleHelper::SECONDARY_X_AXIS_TITLE, xModel ).is();
+    bHasSecondaryYAxisTitle = TitleHelper::getTitle( TitleHelper::SECONDARY_Y_AXIS_TITLE, xModel ).is();
 
     bHasXAxis = bSupportsAxes && AxisHelper::getAxis( 0, true, xDiagram ).is();
     bHasYAxis = bSupportsAxes && AxisHelper::getAxis( 1, true, xDiagram ).is();
@@ -371,7 +390,7 @@
 
 bool ModelState::HasAnyTitle() const
 {
-    return bHasMainTitle || bHasSubTitle || bHasXAxisTitle || bHasYAxisTitle || bHasZAxisTitle;
+    return bHasMainTitle || bHasSubTitle || bHasXAxisTitle || bHasYAxisTitle || bHasZAxisTitle || bHasSecondaryXAxisTitle || bHasSecondaryYAxisTitle;
 }
 
 } // namespace impl
@@ -466,7 +485,10 @@
     m_aCommandAvailability[ C2U(".uno:InsertDescription")] = bIsWritable;
     m_aCommandAvailability[ C2U(".uno:InsertAxis")] = bIsWritable && m_apModelState->bSupportsAxes;
     m_aCommandAvailability[ C2U(".uno:InsertGrids")] = bIsWritable && m_apModelState->bSupportsAxes;
-    m_aCommandAvailability[ C2U(".uno:InsertStatistics")] = bIsWritable && m_apModelState->bSupportsStatistics;
+//     m_aCommandAvailability[ C2U(".uno:InsertStatistics")] = bIsWritable && m_apModelState->bSupportsStatistics;
+    m_aCommandAvailability[ C2U(".uno:InsertTrendlines")] = bIsWritable && m_apModelState->bSupportsStatistics;
+    m_aCommandAvailability[ C2U(".uno:InsertMeanValues")] = bIsWritable && m_apModelState->bSupportsStatistics;
+    m_aCommandAvailability[ C2U(".uno:InsertYErrorbars")] = bIsWritable && m_apModelState->bSupportsStatistics;
     m_aCommandAvailability[ C2U(".uno:InsertSymbol")] = bIsWritable && m_apControllerState->bIsTextObject;
 
     // format objects
@@ -491,6 +513,8 @@
     m_aCommandAvailability[ C2U(".uno:XTitle")] = bIsWritable && bModelStateIsValid && m_apModelState->bHasXAxisTitle;
     m_aCommandAvailability[ C2U(".uno:YTitle")] = bIsWritable && bModelStateIsValid && m_apModelState->bHasYAxisTitle;
     m_aCommandAvailability[ C2U(".uno:ZTitle")] = bIsWritable && bModelStateIsValid && m_apModelState->bHasZAxisTitle;
+    m_aCommandAvailability[ C2U(".uno:SecondaryXTitle")] = bIsWritable && bModelStateIsValid && m_apModelState->bHasSecondaryXAxisTitle;
+    m_aCommandAvailability[ C2U(".uno:SecondaryYTitle")] = bIsWritable && bModelStateIsValid && m_apModelState->bHasSecondaryYAxisTitle;
     m_aCommandAvailability[ C2U(".uno:AllTitles")] = bIsWritable && bModelStateIsValid && m_apModelState->HasAnyTitle();
 
     // text
@@ -518,6 +542,7 @@
     m_aCommandAvailability[ C2U(".uno:Forward")] = bIsWritable && bControllerStateIsValid && m_apControllerState->bMayMoveSeriesForward;
     m_aCommandAvailability[ C2U(".uno:Backward")] = bIsWritable && bControllerStateIsValid && m_apControllerState->bMayMoveSeriesBackward;
 
+    m_aCommandAvailability[ C2U(".uno:InsertMeanValue")] = bIsWritable && bControllerStateIsValid && m_apControllerState->bMayAddMeanValue;
     m_aCommandAvailability[ C2U(".uno:InsertTrendline")] = bIsWritable && bControllerStateIsValid && m_apControllerState->bMayAddTrendline;
     m_aCommandAvailability[ C2U(".uno:InsertTrendlineEquation")] = bIsWritable && bControllerStateIsValid && m_apControllerState->bMayAddTrendlineEquation;
 }
--- chart2/source/inc/ChartTypeHelper.hxx	2007-11-23 12:55:59.000000000 +0100
+++ chart2/source/inc/ChartTypeHelper.hxx	2007-12-18 14:46:19.000000000 +0100
@@ -72,6 +72,7 @@
     static sal_Bool isSupportingBarConnectors(       const ::com::sun::star::uno::Reference< ::com::sun::star::chart2::XChartType >& xChartType, sal_Int32 nDimensionCount );
     static sal_Bool isSupportingRightAngledAxes(     const ::com::sun::star::uno::Reference< ::com::sun::star::chart2::XChartType >& xChartType );
     static bool     isSupportingAxisSideBySide(      const ::com::sun::star::uno::Reference< ::com::sun::star::chart2::XChartType >& xChartType, sal_Int32 nDimensionCount );
+    static bool     isSupportingStartingAngle(       const ::com::sun::star::uno::Reference< ::com::sun::star::chart2::XChartType >& xChartType );
 
     //returns sequence of ::com::sun::star::chart::DataLabelPlacement
     static ::com::sun::star::uno::Sequence < sal_Int32 > getSupportedLabelPlacements(
--- chart2/source/inc/chartview/ChartSfxItemIds.hxx	2007-11-23 12:58:38.000000000 +0100
+++ chart2/source/inc/chartview/ChartSfxItemIds.hxx	2008-01-08 13:14:26.000000000 +0100
@@ -208,8 +208,10 @@
 #define SCHATTR_DIAGRAM_STYLE           (SCHATTR_CHARTTYPE_START + 6)
 #define SCHATTR_TEXTBREAK               (SCHATTR_CHARTTYPE_START + 7)
 #define SCHATTR_GROUP_BARS_PER_AXIS     (SCHATTR_CHARTTYPE_START + 8)
+#define SCHATTR_STARTING_ANGLE          (SCHATTR_CHARTTYPE_START + 9)
+#define SCHATTR_CLOCKWISE               (SCHATTR_CHARTTYPE_START + 10)
 
-#define SCHATTR_CHARTTYPE_END           SCHATTR_GROUP_BARS_PER_AXIS
+#define SCHATTR_CHARTTYPE_END           SCHATTR_CLOCKWISE
 
 // items for transporting information to dialogs
 #define SCHATTR_MISC_START              (SCHATTR_CHARTTYPE_END + 1)
--- chart2/source/inc/ObjectIdentifier.hxx	2007-11-23 12:57:20.000000000 +0100
+++ chart2/source/inc/ObjectIdentifier.hxx	2008-01-14 17:08:19.000000000 +0100
@@ -233,6 +233,9 @@
     static rtl::OUString getParticleID( const rtl::OUString& rCID );
     static rtl::OUString getFullParentParticle( const rtl::OUString& rCID );
 
+    //returns the series particle of a CID when the CID is a child of the series
+    static rtl::OUString getSeriesParticleFromCID( const rtl::OUString& rCID );
+
     //return the model object that is indicated by rObjectCID
     static ::com::sun::star::uno::Reference< ::com::sun::star::beans::XPropertySet >
             getObjectPropertySet(
--- chart2/source/inc/RegressionCurveHelper.hxx	2007-11-23 12:58:07.000000000 +0100
+++ chart2/source/inc/RegressionCurveHelper.hxx	2008-01-14 17:08:42.000000000 +0100
@@ -106,7 +106,9 @@
         REGRESSION_TYPE_LINEAR,
         REGRESSION_TYPE_LOG,
         REGRESSION_TYPE_EXP,
-        REGRESSION_TYPE_POWER
+        REGRESSION_TYPE_POWER,
+        REGRESSION_TYPE_MEAN_VALUE,
+        REGRESSION_TYPE_UNKNOWN
     };
 
     /** Returns the first regression curve found that is not of type
@@ -125,6 +127,10 @@
         const ::com::sun::star::uno::Reference<
             ::com::sun::star::chart2::XRegressionCurveContainer > & xRegCnt );
 
+    static tRegressionType getRegressionType(
+        const ::com::sun::star::uno::Reference<
+            ::com::sun::star::chart2::XRegressionCurve > & xCurve );
+
     /** @param xPropertySource is taken as source to copy all properties from if
                not null
         @param xEquationProperties is set at the new regression curve as
@@ -221,6 +227,13 @@
     static void resetEquationPosition( const ::com::sun::star::uno::Reference<
                                        ::com::sun::star::chart2::XRegressionCurve > & xCurve );
 
+    /// @return the index of the given curve in the given container. -1 if not contained
+    static sal_Int32 getRegressionCurveIndex(
+        const ::com::sun::star::uno::Reference<
+            ::com::sun::star::chart2::XRegressionCurveContainer > & xContainer,
+        const ::com::sun::star::uno::Reference<
+            ::com::sun::star::chart2::XRegressionCurve > & xCurve );
+
 private:
     // not implemented
 	RegressionCurveHelper();
--- chart2/source/inc/Strings.hrc	2007-11-23 12:58:21.000000000 +0100
+++ chart2/source/inc/Strings.hrc	2008-01-15 09:19:29.000000000 +0100
@@ -38,8 +38,8 @@
 // this includes no link dependency
 #include <svtools/solar.hrc>
 
-//free 87, 88, 89, 21
-//next is 269
+//free 21 267
+//next is 270
 
 //#define RID_APP_START 30000
 ////#define STR_NULL                            (RID_APP_START +  1)
@@ -156,7 +156,6 @@
 //SchStatisticTabPage and SchDataStatisticsDlg
 //see Strings_Statistic.src
 
-#define STR_INDICATE_NONE                   (RID_APP_START + 130)
 #define STR_INDICATE_BOTH                   (RID_APP_START + 131)
 #define STR_INDICATE_UP                     (RID_APP_START + 132)
 #define STR_INDICATE_DOWN                   (RID_APP_START + 133)
@@ -222,6 +221,8 @@
 #define STR_OBJECT_TITLE_X_AXIS             (RID_APP_START + 256)
 #define STR_OBJECT_TITLE_Y_AXIS             (RID_APP_START + 257)
 #define STR_OBJECT_TITLE_Z_AXIS             (RID_APP_START + 258)
+#define STR_OBJECT_TITLE_SECONDARY_X_AXIS   (RID_APP_START + 87)
+#define STR_OBJECT_TITLE_SECONDARY_Y_AXIS   (RID_APP_START + 88)
 
 #define STR_OBJECT_DATAPOINT                (RID_APP_START + 202)
 #define STR_OBJECT_DATAPOINTS               (RID_APP_START + 203)
@@ -230,8 +231,8 @@
 
 #define STR_OBJECT_AVERAGE_LINE 			(RID_APP_START + 174)
 #define STR_OBJECT_ERROR_INDICATOR  		(RID_APP_START + 175)
-#define STR_OBJECT_CURVE    				(RID_APP_START + 176)
-#define STR_PAGE_STATISTICS                 (RID_APP_START + 206)
+#define STR_OBJECT_CURVE                    (RID_APP_START + 176)
+#define STR_OBJECT_CURVES                   (RID_APP_START + 130)
 
 #define STR_OBJECT_STOCK_LOSS               (RID_APP_START + 207)
 #define STR_OBJECT_STOCK_GAIN               (RID_APP_START + 208)
@@ -277,7 +278,9 @@
 #define STR_PAGE_PERSPECTIVE                 (RID_APP_START + 235)
 #define STR_PAGE_APPEARANCE                  (RID_APP_START + 236)
 #define STR_PAGE_ILLUMINATION                (RID_APP_START + 237)
-#define STR_PAGE_REGRESSION_OPTIONS          (RID_APP_START + 267)
+
+#define STR_PAGE_TRENDLINE_TYPE              (RID_APP_START + 89)
+#define STR_PAGE_YERROR_BARS                 (RID_APP_START + 206)
 
 #define STR_DLG_CHART_WIZARD                 (RID_APP_START + 228)
 #define STR_PAGE_CHART_ELEMENTS              (RID_APP_START + 229)
@@ -319,6 +322,8 @@
 #define STR_COLUMN_LABEL                    (RID_APP_START + 262)
 #define STR_ROW_LABEL                       (RID_APP_START + 263)
 
+#define STR_DATA_EDITOR_INCORRECT_INPUT     (RID_APP_START + 269)
+
 //-----------------------------------------------------------------------------
 /*
 ////#define STR_DIAGRAM_X_AXIS					(RID_APP_START + 34)
--- chart2/source/inc/TitleHelper.hxx	2007-05-22 20:23:19.000000000 +0200
+++ chart2/source/inc/TitleHelper.hxx	2007-11-20 17:38:15.000000000 +0100
@@ -67,8 +67,8 @@
         X_AXIS_TITLE,
         Y_AXIS_TITLE,
         Z_AXIS_TITLE,
-//         SECOND_X_AXIS_TITLE,
-//         SECOND_Y_AXIS_TITLE,
+        SECONDARY_X_AXIS_TITLE,
+        SECONDARY_Y_AXIS_TITLE,
         NORMAL_TITLE_END,
 
         //it is intended that this both types are after NORMAL_TITLE_END
--- chart2/source/model/main/Diagram.cxx	2008-01-14 15:00:44.000000000 +0100
+++ chart2/source/model/main/Diagram.cxx	2008-01-18 16:09:06.000000000 +0100
@@ -90,6 +90,7 @@
     PROP_DIAGRAM_SORT_BY_X_VALUES,
     PROP_DIAGRAM_CONNECT_BARS,
     PROP_DIAGRMA_RIGHT_ANGLED_AXES,
+    PROP_DIAGRAM_STARTING_ANGLE,
     PROP_DIAGRAM_GROUP_BARS_PER_AXIS
 };
 
@@ -130,6 +131,14 @@
                   ::getBooleanCppuType(),
                   beans::PropertyAttribute::BOUND
                   | beans::PropertyAttribute::MAYBEDEFAULT ));
+
+    rOutProperties.push_back(
+        Property( C2U( "StartingAngle" ),
+                  PROP_DIAGRAM_STARTING_ANGLE,
+                  ::getCppuType( reinterpret_cast< const sal_Int32 * >(0) ),
+                  beans::PropertyAttribute::BOUND
+                  | beans::PropertyAttribute::MAYBEDEFAULT ));
+
     rOutProperties.push_back(
         Property( C2U("GroupBarsPerAxis"),
                   PROP_DIAGRAM_GROUP_BARS_PER_AXIS,
@@ -144,6 +153,7 @@
     ::chart::PropertyHelper::setPropertyValueDefault( rOutMap, PROP_DIAGRAM_SORT_BY_X_VALUES, false );
     ::chart::PropertyHelper::setPropertyValueDefault( rOutMap, PROP_DIAGRAM_CONNECT_BARS, false );
     ::chart::PropertyHelper::setPropertyValueDefault( rOutMap, PROP_DIAGRMA_RIGHT_ANGLED_AXES, false );
+    ::chart::PropertyHelper::setPropertyValueDefault< sal_Int32 >( rOutMap, PROP_DIAGRAM_STARTING_ANGLE, 90 );
     ::chart::PropertyHelper::setPropertyValueDefault( rOutMap, PROP_DIAGRAM_GROUP_BARS_PER_AXIS, true );
 }
 
--- chart2/source/model/template/PieChartTypeTemplate.cxx	2007-11-23 13:02:46.000000000 +0100
+++ chart2/source/model/template/PieChartTypeTemplate.cxx	2008-01-08 14:09:35.000000000 +0100
@@ -617,6 +617,14 @@
                     aScaleData.Orientation = chart2::AxisOrientation_MATHEMATICAL;
                     xAxis->setScaleData( aScaleData );
                 }
+
+                xAxis = AxisHelper::getAxis( 1, 0, aCooSysSeq[nCooSysIdx] );
+                if( xAxis.is() )
+                {
+                    chart2::ScaleData aScaleData( xAxis->getScaleData() );
+                    aScaleData.Orientation = chart2::AxisOrientation_MATHEMATICAL;
+                    xAxis->setScaleData( aScaleData );
+                }
             }
             catch( const uno::Exception & ex )
             {
--- chart2/source/tools/ChartTypeHelper.cxx	2007-11-23 13:04:47.000000000 +0100
+++ chart2/source/tools/ChartTypeHelper.cxx	2007-12-18 14:46:13.000000000 +0100
@@ -365,6 +365,17 @@
     return sal_True;
 }
 
+bool ChartTypeHelper::isSupportingStartingAngle( const uno::Reference< chart2::XChartType >& xChartType )
+{
+    if(xChartType.is())
+    {
+        rtl::OUString aChartTypeName = xChartType->getChartType();
+        if( aChartTypeName.match(CHART2_SERVICE_NAME_CHARTTYPE_PIE) )
+            return true;
+    }
+    return false;
+}
+
 bool ChartTypeHelper::noBordersForSimpleScheme( const uno::Reference< chart2::XChartType >& xChartType )
 {
     if(xChartType.is())
--- chart2/source/tools/ObjectIdentifier.cxx	2007-11-23 13:06:27.000000000 +0100
+++ chart2/source/tools/ObjectIdentifier.cxx	2008-01-14 17:08:08.000000000 +0100
@@ -143,6 +143,8 @@
         ( TitleHelper::X_AXIS_TITLE, C2U("D=0:CS=0:Axis=0,0") )
         ( TitleHelper::Y_AXIS_TITLE, C2U("D=0:CS=0:Axis=1,0") )
         ( TitleHelper::Z_AXIS_TITLE, C2U("D=0:CS=0:Axis=2,0") )
+        ( TitleHelper::SECONDARY_X_AXIS_TITLE, C2U("D=0:CS=0:Axis=0,1") )
+        ( TitleHelper::SECONDARY_Y_AXIS_TITLE, C2U("D=0:CS=0:Axis=1,1") )
         ;
     return m_aTitleMap;
 }
@@ -1364,6 +1366,21 @@
     return eRet;
 }
 
+// static
+OUString ObjectIdentifier::getSeriesParticleFromCID( const OUString& rCID )
+{
+    sal_Int32 nDiagramIndex = -1;
+    sal_Int32 nCooSysIndex = -1;
+    lcl_parseCooSysIndices( nDiagramIndex, nCooSysIndex, rCID );
+
+    sal_Int32 nChartTypeIndex = -1;
+    sal_Int32 nSeriesIndex = -1;
+    sal_Int32 nPointIndex = -1;
+    lcl_parseSeriesIndices( nChartTypeIndex, nSeriesIndex, nPointIndex, rCID );
+
+    return ObjectIdentifier::createParticleForSeries( nDiagramIndex, nCooSysIndex, nChartTypeIndex, nSeriesIndex );
+}
+
 //static
 OUString ObjectIdentifier::getMovedSeriesCID( const ::rtl::OUString& rObjectCID, sal_Bool bForward )
 {
--- chart2/source/tools/RegressionCurveHelper.cxx	2007-11-23 13:07:29.000000000 +0100
+++ chart2/source/tools/RegressionCurveHelper.cxx	2008-01-14 17:08:55.000000000 +0100
@@ -523,6 +523,54 @@
 }
 
 // static
+RegressionCurveHelper::tRegressionType RegressionCurveHelper::getRegressionType(
+    const Reference< XRegressionCurve > & xCurve )
+{
+    tRegressionType eResult = REGRESSION_TYPE_UNKNOWN;
+
+    try
+    {
+        Reference< lang::XServiceName > xServName( xCurve, uno::UNO_QUERY );
+        if( xServName.is())
+        {
+            ::rtl::OUString aServiceName( xServName->getServiceName() );
+
+            if( aServiceName.equalsAsciiL(
+                    RTL_CONSTASCII_STRINGPARAM( "com.sun.star.chart2.LinearRegressionCurve" )))
+            {
+                eResult = REGRESSION_TYPE_LINEAR;
+            }
+            else if( aServiceName.equalsAsciiL(
+                         RTL_CONSTASCII_STRINGPARAM( "com.sun.star.chart2.LogarithmicRegressionCurve" )))
+            {
+                eResult = REGRESSION_TYPE_LOG;
+            }
+            else if( aServiceName.equalsAsciiL(
+                         RTL_CONSTASCII_STRINGPARAM( "com.sun.star.chart2.ExponentialRegressionCurve" )))
+            {
+                eResult = REGRESSION_TYPE_EXP;
+            }
+            else if( aServiceName.equalsAsciiL(
+                         RTL_CONSTASCII_STRINGPARAM( "com.sun.star.chart2.PotentialRegressionCurve" )))
+            {
+                eResult = REGRESSION_TYPE_POWER;
+            }
+            else if( aServiceName.equalsAsciiL(
+                         RTL_CONSTASCII_STRINGPARAM( "com.sun.star.chart2.MeanValueRegressionCurve" )))
+            {
+                eResult = REGRESSION_TYPE_MEAN_VALUE;
+            }
+        }
+    }
+    catch( Exception & ex )
+    {
+        ASSERT_EXCEPTION( ex );
+    }
+
+    return eResult;
+}
+
+// static
 RegressionCurveHelper::tRegressionType RegressionCurveHelper::getFirstRegressTypeNotMeanValueLine(
     const Reference< XRegressionCurveContainer > & xRegCnt )
 {
@@ -530,50 +578,18 @@
 
     if( xRegCnt.is())
     {
-        try
+        Sequence< Reference< XRegressionCurve > > aCurves(
+            xRegCnt->getRegressionCurves());
+        for( sal_Int32 i = 0; i < aCurves.getLength(); ++i )
         {
-            Sequence< Reference< XRegressionCurve > > aCurves(
-                xRegCnt->getRegressionCurves());
-            for( sal_Int32 i = 0; i < aCurves.getLength(); ++i )
+            tRegressionType eType = getRegressionType( aCurves[i] );
+            if( eType != REGRESSION_TYPE_MEAN_VALUE &&
+                eType != REGRESSION_TYPE_UNKNOWN )
             {
-                Reference< lang::XServiceName > xServName( aCurves[i], uno::UNO_QUERY );
-                if( xServName.is())
-                {
-                    ::rtl::OUString aServiceName( xServName->getServiceName() );
-
-                    // note: take first regression curve that matches any known
-                    // type (except mean-value line)
-                    if( aServiceName.equalsAsciiL( RTL_CONSTASCII_STRINGPARAM(
-                                "com.sun.star.chart2.LinearRegressionCurve" )))
-                    {
-                        eResult = REGRESSION_TYPE_LINEAR;
-                        break;
-                    }
-                    else if( aServiceName.equalsAsciiL( RTL_CONSTASCII_STRINGPARAM(
-                                "com.sun.star.chart2.LogarithmicRegressionCurve" )))
-                    {
-                        eResult = REGRESSION_TYPE_LOG;
-                        break;
-                    }
-                    else if( aServiceName.equalsAsciiL( RTL_CONSTASCII_STRINGPARAM(
-                                "com.sun.star.chart2.ExponentialRegressionCurve" )))
-                    {
-                        eResult = REGRESSION_TYPE_EXP;
-                        break;
-                    }
-                    else if( aServiceName.equalsAsciiL( RTL_CONSTASCII_STRINGPARAM(
-                                "com.sun.star.chart2.PotentialRegressionCurve" )))
-                    {
-                        eResult = REGRESSION_TYPE_POWER;
-                        break;
-                    }
-                }
+                eResult = eType;
+                break;
             }
         }
-        catch( Exception & ex )
-        {
-            ASSERT_EXCEPTION( ex );
-        }
     }
 
     return eResult;
@@ -664,6 +680,22 @@
     }
 }
 
+sal_Int32 RegressionCurveHelper::getRegressionCurveIndex(
+    const Reference< chart2::XRegressionCurveContainer > & xContainer,
+    const Reference< chart2::XRegressionCurve > & xCurve )
+{
+    if( xContainer.is())
+    {
+        uno::Sequence< uno::Reference< XRegressionCurve > > aCurves(
+            xContainer->getRegressionCurves());
+        for( sal_Int32 i = 0; i < aCurves.getLength(); ++i )
+        {
+            if( xCurve == aCurves[i] )
+                return i;
+        }
+    }
+    return -1;
+}
 
 //.............................................................................
 } //namespace chart
--- chart2/source/tools/TitleHelper.cxx	2007-08-17 14:15:52.000000000 +0200
+++ chart2/source/tools/TitleHelper.cxx	2007-11-20 17:38:35.000000000 +0100
@@ -86,6 +86,16 @@
             static rtl::OUString m_aIdentifier( C2U( "@zaxis-title" ) );
             return m_aIdentifier;
         }
+        case TitleHelper::SECONDARY_X_AXIS_TITLE:
+        {
+            static rtl::OUString m_aIdentifier( C2U( "@secondaryxaxis-title" ) );
+            return m_aIdentifier;
+        }
+        case TitleHelper::SECONDARY_Y_AXIS_TITLE:
+        {
+            static rtl::OUString m_aIdentifier( C2U( "@secondaryyaxis-title" ) );
+            return m_aIdentifier;
+        }
         default:
             OSL_ENSURE( false, "Unsupported Title-Type requested" );
             return ::rtl::OUString();
@@ -131,6 +141,14 @@
             if( xDiagram.is())
                 xResult.set( AxisHelper::getAxis( 2, true, xDiagram ), uno::UNO_QUERY );
             break;
+        case TitleHelper::SECONDARY_X_AXIS_TITLE:
+            if( xDiagram.is())
+                xResult.set( AxisHelper::getAxis( 0, false, xDiagram ), uno::UNO_QUERY );
+            break;
+        case TitleHelper::SECONDARY_Y_AXIS_TITLE:
+            if( xDiagram.is())
+                xResult.set( AxisHelper::getAxis( 1, false, xDiagram ), uno::UNO_QUERY );
+            break;
 
         case TitleHelper::MAIN_TITLE:
         default:
@@ -161,6 +179,8 @@
         case TitleHelper::Z_AXIS_TITLE:
         case TitleHelper::TITLE_AT_STANDARD_X_AXIS_POSITION:
         case TitleHelper::TITLE_AT_STANDARD_Y_AXIS_POSITION:
+        case TitleHelper::SECONDARY_X_AXIS_TITLE:
+        case TitleHelper::SECONDARY_Y_AXIS_TITLE:
             xResult.set( lcl_getTitleParentFromDiagram( nTitleIndex, xDiagram ));
             break;
         default:
@@ -189,6 +209,29 @@
 {
     uno::Reference< XTitle > xTitle;
     uno::Reference< XTitled > xTitled( lcl_getTitleParent( eTitleType, xModel ) );
+
+    if( !xTitled.is() )
+    {
+        uno::Reference< XDiagram > xDiagram( ChartModelHelper::findDiagram( xModel ) );
+        uno::Reference< chart2::XAxis > xAxis;
+        switch( eTitleType )
+        {
+            case TitleHelper::SECONDARY_X_AXIS_TITLE:
+                xAxis = AxisHelper::createAxis( 0, false, xDiagram, xContext );
+                break;
+            case TitleHelper::SECONDARY_Y_AXIS_TITLE:
+                xAxis = AxisHelper::createAxis( 1, false, xDiagram, xContext );
+               break;
+            default:
+               break;
+        }
+        uno::Reference< beans::XPropertySet > xProps( xAxis, uno::UNO_QUERY );
+        if( xProps.is() )
+        {
+            xProps->setPropertyValue( C2U( "Show" ), uno::makeAny( sal_False ) );
+            xTitled = lcl_getTitleParent( eTitleType, xModel );
+        }
+    }
     
     if(xTitled.is())
     {
@@ -214,6 +257,8 @@
                 case TitleHelper::Z_AXIS_TITLE:
                 case TitleHelper::TITLE_AT_STANDARD_X_AXIS_POSITION:
                 case TitleHelper::TITLE_AT_STANDARD_Y_AXIS_POSITION:
+                case TitleHelper::SECONDARY_X_AXIS_TITLE:
+                case TitleHelper::SECONDARY_Y_AXIS_TITLE:
                     chart::TitleHelper::setCompleteString(
                         rTitleText, xTitle, xContext, & fDefaultCharHeightAxis );
                     break;
@@ -230,7 +275,10 @@
 
             //default rotation 90 degree for y axis title in normal coordinatesystems or for x axis title for swapped coordinatesystems
             if( eTitleType == TitleHelper::X_AXIS_TITLE ||
-                eTitleType == TitleHelper::Y_AXIS_TITLE )
+                eTitleType == TitleHelper::Y_AXIS_TITLE ||
+                eTitleType == TitleHelper::SECONDARY_X_AXIS_TITLE ||
+                eTitleType == TitleHelper::SECONDARY_Y_AXIS_TITLE )
+
             {
                 try
                 {
@@ -242,7 +290,9 @@
                     {
                         double fNewAngleDegree = 90.0;
                         if( (!bIsVertical && eTitleType == TitleHelper::Y_AXIS_TITLE)
-                            || (bIsVertical && eTitleType == TitleHelper::X_AXIS_TITLE) )
+                            || (bIsVertical && eTitleType == TitleHelper::X_AXIS_TITLE)
+                            || (!bIsVertical && eTitleType == TitleHelper::SECONDARY_Y_AXIS_TITLE)
+                            || (bIsVertical && eTitleType == TitleHelper::SECONDARY_X_AXIS_TITLE) )
                             xTitleProps->setPropertyValue( C2U( "TextRotation" ), uno::makeAny( fNewAngleDegree ));
                     }
                 }
--- chart2/source/view/charttypes/PieChart.cxx	2008-01-14 15:05:45.000000000 +0100
+++ chart2/source/view/charttypes/PieChart.cxx	2008-01-18 16:08:47.000000000 +0100
@@ -388,6 +388,8 @@
         if(!pSeries)
             continue;
 
+        m_pPosHelper->m_fAngleDegreeOffset = pSeries->getStartingAngle();
+	   
         double fLogicYSum = 0.0;
         //iterate through all points to get the sum
         sal_Int32 nPointIndex=0;
@@ -759,7 +761,7 @@
     PieLabelInfo* p2 = pCenter->pNext;
     //return true when successful
 
-    bool bLabelOrderIsAntiClockWise = true;//todo adapt this when pies can be oriented differently
+    bool bLabelOrderIsAntiClockWise = m_pPosHelper->isMathematicalOrientationAngle();
 
     PieLabelInfo* pCurrent = 0;
     for( pCurrent = p2 ;pCurrent->pPrevious != pSecondBorder; pCurrent = pCurrent->pNext )
--- chart2/source/view/inc/VDataSeries.hxx	2007-11-23 13:11:38.000000000 +0100
+++ chart2/source/view/inc/VDataSeries.hxx	2007-12-18 14:45:14.000000000 +0100
@@ -164,6 +164,9 @@
 
     void setGroupBarsPerAxis( sal_Bool bGroupBarsPerAxis );
     sal_Bool getGroupBarsPerAxis() const;
+
+    void setStartingAngle( sal_Int32 nStartingAngle );
+    sal_Int32 getStartingAngle() const;
     
     //this is only temporarily here for area chart:
     ::com::sun::star::drawing::PolyPolygonShape3D       m_aPolyPolygonShape3D;
@@ -239,6 +242,8 @@
 
     sal_Bool                m_bGroupBarsPerAxis;
 
+    sal_Int32               m_nStartingAngle;
+
     rtl::OUString           m_aSeriesParticle;
     rtl::OUString           m_aCID;
     rtl::OUString           m_aPointCID_Stub;
--- chart2/source/view/main/ChartItemPool.cxx	2007-11-23 13:12:05.000000000 +0100
+++ chart2/source/view/main/ChartItemPool.cxx	2008-01-08 13:14:59.000000000 +0100
@@ -220,6 +220,8 @@
     ppPoolDefaults[SCHATTR_DIAGRAM_STYLE        - SCHATTR_START] = new SvxChartStyleItem( CHSTYLE_2D_COLUMN, SCHATTR_DIAGRAM_STYLE );
     ppPoolDefaults[SCHATTR_TEXTBREAK            - SCHATTR_START] = new SfxBoolItem( SCHATTR_TEXTBREAK, FALSE );
     ppPoolDefaults[SCHATTR_GROUP_BARS_PER_AXIS  - SCHATTR_START] = new SfxBoolItem(SCHATTR_GROUP_BARS_PER_AXIS, FALSE);
+    ppPoolDefaults[SCHATTR_STARTING_ANGLE       - SCHATTR_START] = new SfxInt32Item( SCHATTR_STARTING_ANGLE, 90 );
+    ppPoolDefaults[SCHATTR_CLOCKWISE            - SCHATTR_START] = new SfxBoolItem( SCHATTR_CLOCKWISE, FALSE );
 
     ppPoolDefaults[SCHATTR_AXIS_FOR_ALL_SERIES  - SCHATTR_START] = new SfxInt32Item(SCHATTR_AXIS_FOR_ALL_SERIES, 0);
     ppPoolDefaults[SCHATTR_REGRESSION_SHOW_EQUATION - SCHATTR_START] = new SfxBoolItem(SCHATTR_REGRESSION_SHOW_EQUATION, 0);
--- chart2/source/view/main/ChartView.cxx	2008-01-14 15:06:38.000000000 +0100
+++ chart2/source/view/main/ChartView.cxx	2008-01-18 16:08:50.000000000 +0100
@@ -680,12 +680,14 @@
     sal_Bool bSortByXValues = sal_False;
     sal_Bool bConnectBars = sal_False;
     sal_Bool bGroupBarsPerAxis = sal_True;
+    sal_Int32 nStartingAngle = 90;
     try
     {
         uno::Reference< beans::XPropertySet > xDiaProp( xDiagram, uno::UNO_QUERY_THROW );
         xDiaProp->getPropertyValue( C2U( "SortByXValues" ) ) >>= bSortByXValues;
         xDiaProp->getPropertyValue( C2U( "ConnectBars" ) ) >>= bConnectBars;
         xDiaProp->getPropertyValue( C2U( "GroupBarsPerAxis" ) ) >>= bGroupBarsPerAxis;
+        xDiaProp->getPropertyValue( C2U( "StartingAngle" ) ) >>= nStartingAngle;
     }
     catch( const uno::Exception & ex )
     {
@@ -755,8 +757,8 @@
                     pSeries->doSortByXValues();
 
                 pSeries->setConnectBars( bConnectBars );
-
                 pSeries->setGroupBarsPerAxis( bGroupBarsPerAxis );
+                pSeries->setStartingAngle( nStartingAngle );
 
                 rtl::OUString aSeriesParticle( ObjectIdentifier::createParticleForSeries( nDiagramIndex, nCS, nT, nS ) );
                 pSeries->setParticle(aSeriesParticle);
@@ -1638,17 +1640,24 @@
     //add axis title sizes to the diagram size
     uno::Reference< chart2::XTitle > xTitle_Height( TitleHelper::getTitle( TitleHelper::TITLE_AT_STANDARD_X_AXIS_POSITION, xChartModel ) );
     uno::Reference< chart2::XTitle > xTitle_Width( TitleHelper::getTitle( TitleHelper::TITLE_AT_STANDARD_Y_AXIS_POSITION, xChartModel ) );
-    if( xTitle_Height.is() || xTitle_Width.is() )
+    uno::Reference< chart2::XTitle > xSecondTitle_Height( TitleHelper::getTitle( TitleHelper::SECONDARY_X_AXIS_TITLE, xChartModel ) );
+    uno::Reference< chart2::XTitle > xSecondTitle_Width( TitleHelper::getTitle( TitleHelper::SECONDARY_Y_AXIS_TITLE, xChartModel ) );
+    if( xTitle_Height.is() || xTitle_Width.is() || xSecondTitle_Height.is() || xSecondTitle_Width.is() )
     {
         ExplicitValueProvider* pExplicitValueProvider = ExplicitValueProvider::getExplicitValueProvider(xChartView);
         if( pExplicitValueProvider )
         {
             //detect wether x axis points into x direction or not
             if( lcl_getPropertySwapXAndYAxis( ChartModelHelper::findDiagram( xChartModel ) ) )
+            {
                 std::swap( xTitle_Height, xTitle_Width );
+                std::swap( xSecondTitle_Height, xSecondTitle_Width );
+            }
 
             sal_Int32 nTitleSpaceWidth = 0;
             sal_Int32 nTitleSpaceHeight = 0;
+            sal_Int32 nSecondTitleSpaceWidth = 0;
+            sal_Int32 nSecondTitleSpaceHeight = 0;
 
             if( xTitle_Height.is() )
             {
@@ -1664,10 +1673,25 @@
                 if(nTitleSpaceWidth)
                     nTitleSpaceWidth+=lcl_getDiagramTitleSpace();
             }
+            if( xSecondTitle_Height.is() )
+            {
+                rtl::OUString aCID_X( ObjectIdentifier::createClassifiedIdentifierForObject( xSecondTitle_Height, xChartModel ) );
+                nSecondTitleSpaceHeight = pExplicitValueProvider->getRectangleOfObject( aCID_X, true ).Height;
+                if( nSecondTitleSpaceHeight )
+                    nSecondTitleSpaceHeight+=lcl_getDiagramTitleSpace();
+            }
+            if( xSecondTitle_Width.is() )
+            {
+                rtl::OUString aCID_Y( ObjectIdentifier::createClassifiedIdentifierForObject( xSecondTitle_Width, xChartModel ) );
+                nSecondTitleSpaceWidth += pExplicitValueProvider->getRectangleOfObject( aCID_Y, true ).Width;
+                if( nSecondTitleSpaceWidth )
+                    nSecondTitleSpaceWidth+=lcl_getDiagramTitleSpace();
+            }
 
             aRet.X -= nTitleSpaceWidth;
-            aRet.Width += nTitleSpaceWidth;
-            aRet.Height += nTitleSpaceHeight;
+            aRet.Y -= nSecondTitleSpaceHeight;
+            aRet.Width += nTitleSpaceWidth + nSecondTitleSpaceWidth;
+            aRet.Height += nTitleSpaceHeight + nSecondTitleSpaceHeight;
         }
     }
     return aRet;
@@ -1683,7 +1707,8 @@
     , const awt::Rectangle& rSpaceLeft
     , const awt::Size & rPageSize
     , const uno::Reference< XDiagram > & xDiagram
-    , VTitle* pXTitle, VTitle* pYTitle )
+    , VTitle* pXTitle, VTitle* pYTitle
+    , VTitle* pSecondXTitle, VTitle* pSecondYTitle )
 {
     //@todo: we need a size dependent on the axis labels
     awt::Rectangle aRemainingSpace(rSpaceLeft);
@@ -1743,11 +1768,16 @@
     {
         sal_Int32 nTitleSpaceWidth = 0;
         sal_Int32 nTitleSpaceHeight = 0;
+        sal_Int32 nSecondTitleSpaceWidth = 0;
+        sal_Int32 nSecondTitleSpaceHeight = 0;
         {
             //todo detect wether x axis points into x direction or not
             //detect wether x axis points into x direction or not
             if( lcl_getPropertySwapXAndYAxis( xDiagram ) )
+            {
                 std::swap( pXTitle, pYTitle );
+                std::swap( pSecondXTitle, pSecondYTitle );
+            }
 
             if( pXTitle )
             {
@@ -1761,10 +1791,23 @@
                 if(nTitleSpaceWidth)
                     nTitleSpaceWidth+=lcl_getDiagramTitleSpace();
             }
+            if( pSecondXTitle)
+            {
+                nSecondTitleSpaceHeight += pSecondXTitle->getFinalSize().Height;
+                if(nSecondTitleSpaceHeight)
+                    nSecondTitleSpaceHeight+=lcl_getDiagramTitleSpace();
+            }
+            if( pSecondYTitle)
+            {
+                nSecondTitleSpaceWidth += pSecondYTitle->getFinalSize().Width;
+                if(nSecondTitleSpaceWidth)
+                    nSecondTitleSpaceWidth+=lcl_getDiagramTitleSpace();
+            }
         }
-        rOutAvailableDiagramSize.Height -= nTitleSpaceHeight;
-        rOutAvailableDiagramSize.Width -= nTitleSpaceWidth;
+        rOutAvailableDiagramSize.Height -= nTitleSpaceHeight + nSecondTitleSpaceHeight;
+        rOutAvailableDiagramSize.Width -= nTitleSpaceWidth + nSecondTitleSpaceWidth;
         rOutPos.X += nTitleSpaceWidth;
+        rOutPos.Y += nSecondTitleSpaceHeight;
     }
 
     return true;
@@ -1784,6 +1827,10 @@
     sal_Int32 nXDistance = static_cast<sal_Int32>(rPageSize.Width*lcl_getPageLayoutDistancePercentage());
     switch( eAlignment )
     {
+    case ALIGN_TOP:
+        aNewPosition = awt::Point( rDiagramPlusAxesRect.X + rDiagramPlusAxesRect.Width/2
+                                    , rDiagramPlusAxesRect.Y - aTitleSize.Height/2  - nYDistance );
+        break;
     case ALIGN_BOTTOM:
         aNewPosition = awt::Point( rDiagramPlusAxesRect.X + rDiagramPlusAxesRect.Width/2
                                     , rDiagramPlusAxesRect.Y + rDiagramPlusAxesRect.Height + aTitleSize.Height/2  + nYDistance );
@@ -1792,6 +1839,10 @@
         aNewPosition = awt::Point( rDiagramPlusAxesRect.X - aTitleSize.Width/2 - nXDistance
                                     , rDiagramPlusAxesRect.Y + rDiagramPlusAxesRect.Height/2 );
         break;
+    case ALIGN_RIGHT:
+        aNewPosition = awt::Point( rDiagramPlusAxesRect.X + rDiagramPlusAxesRect.Width + aTitleSize.Width/2 + nXDistance
+                                    , rDiagramPlusAxesRect.Y + rDiagramPlusAxesRect.Height/2 );
+        break;
     case ALIGN_Z:
         aNewPosition = awt::Point( rDiagramPlusAxesRect.X + rDiagramPlusAxesRect.Width + aTitleSize.Width/2 + nXDistance
                                     , rDiagramPlusAxesRect.Y + rDiagramPlusAxesRect.Height - aTitleSize.Height/2 );
@@ -2140,24 +2191,54 @@
         if(aRemainingSpace.Width<=0||aRemainingSpace.Height<=0)
             return;
 
+        Reference< chart2::XChartType > xChartType( DiagramHelper::getChartTypeByIndex( xDiagram, 0 ) );
+        sal_Int32 nDimension = DiagramHelper::getDimension( xDiagram );
+
         //------------ create x axis title
         bool bAutoPosition_XTitle = true;
-        std::auto_ptr<VTitle> apVTitle_X( lcl_createTitle( TitleHelper::getTitle( TitleHelper::TITLE_AT_STANDARD_X_AXIS_POSITION, m_xChartModel ), xPageShapes, m_xShapeFactory, m_xChartModel
-                    , aRemainingSpace, aPageSize, ALIGN_BOTTOM, bAutoPosition_XTitle) );
+        std::auto_ptr<VTitle> apVTitle_X;
+        if( ChartTypeHelper::isSupportingMainAxis( xChartType, nDimension, 0 ) )
+            apVTitle_X = lcl_createTitle( TitleHelper::getTitle( TitleHelper::TITLE_AT_STANDARD_X_AXIS_POSITION, m_xChartModel ), xPageShapes, m_xShapeFactory, m_xChartModel
+                    , aRemainingSpace, aPageSize, ALIGN_BOTTOM, bAutoPosition_XTitle );
         if(aRemainingSpace.Width<=0||aRemainingSpace.Height<=0)
             return;
 
         //------------ create y axis title
         bool bAutoPosition_YTitle = true;
-        std::auto_ptr<VTitle> apVTitle_Y( lcl_createTitle( TitleHelper::getTitle( TitleHelper::TITLE_AT_STANDARD_Y_AXIS_POSITION, m_xChartModel ), xPageShapes, m_xShapeFactory, m_xChartModel
-                    , aRemainingSpace, aPageSize, ALIGN_LEFT, bAutoPosition_YTitle) );
+        std::auto_ptr<VTitle> apVTitle_Y;
+        if( ChartTypeHelper::isSupportingMainAxis( xChartType, nDimension, 1 ) )
+            apVTitle_Y = lcl_createTitle( TitleHelper::getTitle( TitleHelper::TITLE_AT_STANDARD_Y_AXIS_POSITION, m_xChartModel ), xPageShapes, m_xShapeFactory, m_xChartModel
+                    , aRemainingSpace, aPageSize, ALIGN_LEFT, bAutoPosition_YTitle );
         if(aRemainingSpace.Width<=0||aRemainingSpace.Height<=0)
             return;
 
         //------------ create z axis title
         bool bAutoPosition_ZTitle = true;
-        std::auto_ptr<VTitle> apVTitle_Z( lcl_createTitle( TitleHelper::getTitle( TitleHelper::Z_AXIS_TITLE, m_xChartModel ), xPageShapes, m_xShapeFactory, m_xChartModel
-                    , aRemainingSpace, aPageSize, ALIGN_RIGHT, bAutoPosition_ZTitle) );
+        std::auto_ptr<VTitle> apVTitle_Z;
+        if( ChartTypeHelper::isSupportingMainAxis( xChartType, nDimension, 2 ) )
+            apVTitle_Z = lcl_createTitle( TitleHelper::getTitle( TitleHelper::Z_AXIS_TITLE, m_xChartModel ), xPageShapes, m_xShapeFactory, m_xChartModel
+                    , aRemainingSpace, aPageSize, ALIGN_RIGHT, bAutoPosition_ZTitle );
+        if(aRemainingSpace.Width<=0||aRemainingSpace.Height<=0)
+            return;
+
+        bool bDummy = false;
+        bool bIsVertical = DiagramHelper::getVertical( xDiagram, bDummy, bDummy );
+
+        //------------ create secondary x axis title
+        bool bAutoPosition_SecondXTitle = true;
+        std::auto_ptr<VTitle> apVTitle_SecondX;
+        if( ChartTypeHelper::isSupportingSecondaryAxis( xChartType, nDimension, 0 ) )
+            apVTitle_SecondX = lcl_createTitle( TitleHelper::getTitle( TitleHelper::SECONDARY_X_AXIS_TITLE, m_xChartModel ), xPageShapes, m_xShapeFactory, m_xChartModel
+                    , aRemainingSpace, aPageSize, bIsVertical? ALIGN_RIGHT : ALIGN_TOP, bAutoPosition_SecondXTitle );
+        if(aRemainingSpace.Width<=0||aRemainingSpace.Height<=0)
+            return;
+
+        //------------ create secondary y axis title
+        bool bAutoPosition_SecondYTitle = true;
+        std::auto_ptr<VTitle> apVTitle_SecondY;
+        if( ChartTypeHelper::isSupportingSecondaryAxis( xChartType, nDimension, 1 ) )
+            apVTitle_SecondY = lcl_createTitle( TitleHelper::getTitle( TitleHelper::SECONDARY_Y_AXIS_TITLE, m_xChartModel ), xPageShapes, m_xShapeFactory, m_xChartModel
+                    , aRemainingSpace, aPageSize, bIsVertical? ALIGN_TOP : ALIGN_RIGHT, bAutoPosition_SecondYTitle );
         if(aRemainingSpace.Width<=0||aRemainingSpace.Height<=0)
             return;
 
@@ -2165,7 +2246,7 @@
         awt::Point aAvailablePosDia;
         awt::Size  aAvailableSizeForDiagram;
         if( getAvailablePosAndSizeForDiagram( aAvailablePosDia, aAvailableSizeForDiagram, aRemainingSpace, aPageSize, ChartModelHelper::findDiagram( m_xChartModel )
-                , apVTitle_X.get(), apVTitle_Y.get() ) )
+                , apVTitle_X.get(), apVTitle_Y.get(), apVTitle_SecondX.get(), apVTitle_SecondY.get() ) )
         {
             impl_createDiagramAndContent( aSeriesPlotterContainer
                         , xDiagramPlusAxes_Shapes
@@ -2185,6 +2266,10 @@
                 changePositionOfAxisTitle( apVTitle_Y.get(), ALIGN_LEFT, aDiagramPlusAxesRect, aPageSize );
             if(bAutoPosition_ZTitle)
                 changePositionOfAxisTitle( apVTitle_Z.get(), ALIGN_Z, aDiagramPlusAxesRect, aPageSize );
+            if(bAutoPosition_SecondXTitle)
+                changePositionOfAxisTitle( apVTitle_SecondX.get(), bIsVertical? ALIGN_RIGHT : ALIGN_TOP, aDiagramPlusAxesRect, aPageSize );
+            if(bAutoPosition_SecondYTitle)
+                changePositionOfAxisTitle( apVTitle_SecondY.get(), bIsVertical? ALIGN_TOP : ALIGN_RIGHT, aDiagramPlusAxesRect, aPageSize );
         }
 
         //cleanup: remove all empty group shapes to avoid grey border lines:
--- chart2/source/view/main/VDataSeries.cxx	2007-11-23 13:13:18.000000000 +0100
+++ chart2/source/view/main/VDataSeries.cxx	2007-12-18 14:45:23.000000000 +0100
@@ -182,6 +182,7 @@
     , m_nAxisIndex(0)
     , m_bConnectBars(sal_False)
     , m_bGroupBarsPerAxis(sal_True)
+    , m_nStartingAngle(90)
 
     , m_aSeriesParticle()
     , m_aCID()
@@ -427,6 +428,15 @@
     return m_bGroupBarsPerAxis;
 }
 
+void VDataSeries::setStartingAngle( sal_Int32 nStartingAngle )
+{
+    m_nStartingAngle = nStartingAngle;
+}
+sal_Int32 VDataSeries::getStartingAngle() const
+{
+    return m_nStartingAngle;
+}
+
 void VDataSeries::setAttachedAxisIndex( sal_Int32 nAttachedAxisIndex )
 {
     if( nAttachedAxisIndex < 0 )
--- chart2/uiconfig/menubar/menubar.xml	2007-05-22 21:28:24.000000000 +0200
+++ chart2/uiconfig/menubar/menubar.xml	2008-01-11 16:52:16.000000000 +0100
@@ -49,7 +49,9 @@
 			    <menu:menuitem menu:id=".uno:InsertLegend" menu:helpid="30516" menu:label="" />
 			<menu:menuseparator/>
 			    <menu:menuitem menu:id=".uno:InsertDescription" menu:helpid="30517" menu:label="" />
-			    <menu:menuitem menu:id=".uno:InsertStatistics" menu:helpid="30556" menu:label="" />
+			    <menu:menuitem menu:id=".uno:InsertTrendlines" menu:label="" />
+			    <menu:menuitem menu:id=".uno:InsertMeanValues" menu:label="" />
+			    <menu:menuitem menu:id=".uno:InsertYErrorbars" menu:label="" />
 			<menu:menuseparator/>
 			    <menu:menuitem menu:id=".uno:InsertSymbol" menu:helpid="10503" menu:label="" />
 		</menu:menupopup>
@@ -74,6 +76,9 @@
 					<menu:menuitem menu:id=".uno:YTitle" menu:helpid="30560" menu:label="" />
 					<menu:menuitem menu:id=".uno:ZTitle" menu:helpid="30561" menu:label="" />
 					<menu:menuseparator/>
+                    <menu:menuitem menu:id=".uno:SecondaryXTitle" menu:label="" />
+                    <menu:menuitem menu:id=".uno:SecondaryYTitle" menu:label="" />
+                    <menu:menuseparator/>
 					<menu:menuitem menu:id=".uno:AllTitles" menu:helpid="30562" menu:label="" />
 				</menu:menupopup>
 			</menu:menu>
@@ -148,4 +153,4 @@
 			<menu:menuitem menu:id=".uno:About"/>
 		</menu:menupopup>
 	</menu:menu>
-</menu:menubar>
\ Kein Zeilenumbruch am Dateiende.
+</menu:menubar>
--- offapi/com/sun/star/chart/makefile.mk	2007-11-23 12:42:20.000000000 +0100
+++ offapi/com/sun/star/chart/makefile.mk	2007-12-18 14:44:51.000000000 +0100
@@ -108,6 +108,7 @@
 	XStatisticDisplay.idl\
 	XTwoAxisXSupplier.idl\
 	XTwoAxisYSupplier.idl\
+	XSecondAxisTitleSupplier.idl\
 	XYDiagram.idl\
 
 # ------------------------------------------------------------------
--- offapi/com/sun/star/chart/XSecondAxisTitleSupplier.idl	1970-01-01 01:00:00.000000000 +0100
+++ offapi/com/sun/star/chart/XSecondAxisTitleSupplier.idl	2007-11-20 17:07:15.000000000 +0100
@@ -0,0 +1,24 @@
+#ifndef __com_sun_star_chart_XSecondAxisTitleSupplier_idl__ 
+#define __com_sun_star_chart_XSecondAxisTitleSupplier_idl__ 
+
+#ifndef __com_sun_star_uno_XInterface_idl__ 
+#include <com/sun/star/uno/XInterface.idl> 
+#endif
+
+#ifndef __com_sun_star_drawing_XShape_idl__ 
+#include <com/sun/star/drawing/XShape.idl> 
+#endif 
+ 
+ 
+module com {  module sun {  module star {  module chart {  
+
+interface XSecondAxisTitleSupplier: com::sun::star::uno::XInterface
+{ 
+    com::sun::star::drawing::XShape getSecondXAxisTitle(); 
+
+    com::sun::star::drawing::XShape getSecondYAxisTitle();
+}; 
+
+}; }; }; };  
+ 
+#endif 
\ Kein Zeilenumbruch am Dateiende.
--- officecfg/registry/data/org/openoffice/Office/UI/ChartCommands.xcu	2007-11-23 12:33:03.000000000 +0100
+++ officecfg/registry/data/org/openoffice/Office/UI/ChartCommands.xcu	2008-01-15 16:12:40.000000000 +0100
@@ -215,9 +215,19 @@
 					<value xml:lang="en-US">~All Axes...</value>
 				</prop>
 			</node>
-			<node oor:name=".uno:InsertStatistics" oor:op="replace">
+			<node oor:name=".uno:InsertTrendlines" oor:op="replace">
 				<prop oor:name="Label" oor:type="xs:string">
-					<value xml:lang="en-US">~Statistics...</value>
+					<value xml:lang="en-US">T~rend Lines...</value>
+				</prop>
+			</node>
+			<node oor:name=".uno:InsertMeanValues" oor:op="replace">
+				<prop oor:name="Label" oor:type="xs:string">
+					<value xml:lang="en-US">Mean ~Value Lines</value>
+				</prop>
+			</node>
+			<node oor:name=".uno:InsertYErrorbars" oor:op="replace">
+				<prop oor:name="Label" oor:type="xs:string">
+					<value xml:lang="en-US">~Y Error Bars...</value>
 				</prop>
 			</node>
 			<node oor:name=".uno:MainTitle" oor:op="replace">
@@ -246,6 +256,16 @@
 					<value xml:lang="en-US">~Z Axis Title...</value>
 				</prop>
 			</node>
+			<node oor:name=".uno:SecondaryXTitle" oor:op="replace">
+				<prop oor:name="Label" oor:type="xs:string">
+					<value xml:lang="en-US">S~econdary X Axis Title...</value>
+				</prop>
+			</node>
+			<node oor:name=".uno:SecondaryYTitle" oor:op="replace">
+				<prop oor:name="Label" oor:type="xs:string">
+					<value xml:lang="en-US">Se~condary Y Axis Title...</value>
+				</prop>
+			</node>
 			<node oor:name=".uno:AllTitles" oor:op="replace">
 				<prop oor:name="Label" oor:type="xs:string">
 					
@@ -391,13 +411,19 @@
 			<node oor:name=".uno:InsertTrendline" oor:op="replace">
 				<prop oor:name="Label" oor:type="xs:string">
 					
-					<value xml:lang="en-US">Insert ~Regression Curve</value>
+					<value xml:lang="en-US">Insert Tre~nd Line...</value>
+				</prop>
+			</node>
+			<node oor:name=".uno:InsertMeanValue" oor:op="replace">
+				<prop oor:name="Label" oor:type="xs:string">
+					
+					<value xml:lang="en-US">Insert Mean ~Value Line</value>
 				</prop>
 			</node>
 			<node oor:name=".uno:InsertTrendlineEquation" oor:op="replace">
 				<prop oor:name="Label" oor:type="xs:string">
 					
-					<value xml:lang="en-US">Insert Regresion Curve ~Equation</value>
+					<value xml:lang="en-US">Insert Trend Line ~Equation</value>
 				</prop>
 			</node>
 		</node>
--- xmloff/inc/pch/precompiled_xmloff.hxx	2007-05-10 17:19:58.000000000 +0200
+++ xmloff/inc/pch/precompiled_xmloff.hxx	2007-11-20 17:21:50.000000000 +0100
@@ -117,6 +117,7 @@
 #include "com/sun/star/chart/XChartDataArray.hpp"
 #include "com/sun/star/chart/XChartDocument.hpp"
 #include "com/sun/star/chart/XDiagram.hpp"
+#include "com/sun/star/chart/XSecondAxisTitleSupplier.hpp"
 #include "com/sun/star/chart/XStatisticDisplay.hpp"
 #include "com/sun/star/chart/XTwoAxisXSupplier.hpp"
 #include "com/sun/star/chart/XTwoAxisYSupplier.hpp"
--- xmloff/inc/xmloff/xmltoken.hxx	2007-11-23 13:17:42.000000000 +0100
+++ xmloff/inc/xmloff/xmltoken.hxx	2007-12-18 14:44:08.000000000 +0100
@@ -2983,6 +2983,7 @@
         XML_N_FIELD, 
         XML_NP_FIELD, 
 	
+        XML_ANGLE_OFFSET,
 		XML_TOKEN_END
     };
 
--- xmloff/source/chart/PropertyMap.hxx	2007-11-23 12:34:41.000000000 +0100
+++ xmloff/source/chart/PropertyMap.hxx	2007-12-18 14:44:17.000000000 +0100
@@ -160,6 +160,7 @@
   	MAP_CONTEXT( "NumberOfLines", CHART, XML_LINES_USED, XML_TYPE_NUMBER, LINES_USED  ),
 	MAP_ENTRY( "StackedBarsConnected", CHART, XML_CONNECT_BARS, XML_TYPE_BOOL ),
     MAP_ENTRY( "GroupBarsPerAxis", CHART, XML_GROUP_BARS_PER_AXIS, XML_TYPE_BOOL ),
+    MAP_ENTRY( "StartingAngle", CHART, XML_ANGLE_OFFSET, XML_TYPE_NUMBER ),
     // spline settings
     MAP_ENTRY( "SplineOrder", CHART, XML_SPLINE_ORDER, XML_TYPE_NUMBER ),
     MAP_ENTRY( "SplineResolution", CHART, XML_SPLINE_RESOLUTION, XML_TYPE_NUMBER ),
--- xmloff/source/chart/SchXMLErrorBuildIds.hxx	2007-05-22 18:06:00.000000000 +0200
+++ xmloff/source/chart/SchXMLErrorBuildIds.hxx	2008-01-08 14:12:35.000000000 +0100
@@ -35,8 +35,12 @@
 #ifndef SCH_XML_ERRORBUILDIDS_HXX_
 #define SCH_XML_ERRORBUILDIDS_HXX_
 
+#include <sal/types.h>
+
 namespace xmloff { namespace chart {
 
+const sal_Int32 BUILD_ID_3_0 = 0000; //todo: adapt to a number greater than OOo 2.4 when these builds with their ID are available
+
 }}
 
 #endif	// SCH_XML_ERRORBUILDIDS_HXX_
--- xmloff/source/chart/SchXMLExport.cxx	2008-01-14 14:42:17.000000000 +0100
+++ xmloff/source/chart/SchXMLExport.cxx	2008-01-18 16:08:22.000000000 +0100
@@ -137,6 +137,7 @@
 #include <com/sun/star/drawing/XShapes.hpp>
 #include <com/sun/star/embed/Aspects.hpp>
 #include <com/sun/star/embed/XVisualObject.hpp>
+#include <com/sun/star/chart/XSecondAxisTitleSupplier.hpp>
 
 #include "MultiPropertySetHandler.hxx"
 #include "PropertyMap.hxx"
@@ -1652,7 +1653,9 @@
 		bHasSecondaryYAxis = sal_False;
 	sal_Bool bHasXAxisTitle = sal_False,
 		bHasYAxisTitle = sal_False,
-		bHasZAxisTitle = sal_False;
+		bHasZAxisTitle = sal_False,
+		bHasSecondaryXAxisTitle = sal_False,
+		bHasSecondaryYAxisTitle = sal_False;
 	sal_Bool bHasXAxisMajorGrid = sal_False,
 		bHasXAxisMinorGrid = sal_False,
 		bHasYAxisMajorGrid = sal_False,
@@ -1706,6 +1709,10 @@
 		OUString (RTL_CONSTASCII_USTRINGPARAM ("HasYAxisTitle")), bHasYAxisTitle);
 	aDiagramProperties.Add (
 		OUString (RTL_CONSTASCII_USTRINGPARAM ("HasZAxisTitle")), bHasZAxisTitle);
+	aDiagramProperties.Add (
+		OUString (RTL_CONSTASCII_USTRINGPARAM ("HasSecondaryXAxisTitle")), bHasSecondaryXAxisTitle);
+	aDiagramProperties.Add (
+		OUString (RTL_CONSTASCII_USTRINGPARAM ("HasSecondaryYAxisTitle")), bHasSecondaryYAxisTitle);
 
 	aDiagramProperties.Add (
 		OUString (RTL_CONSTASCII_USTRINGPARAM ("HasXAxisGrid")), bHasXAxisMajorGrid);
@@ -1874,7 +1881,7 @@
     }
 
 	// secondary x axis
-	if( bHasSecondaryXAxis )
+	if( bHasSecondaryXAxis || bHasSecondaryXAxisTitle )
 	{
 		Reference< chart::XTwoAxisXSupplier > xAxisTwoXSupp( xDiagram, uno::UNO_QUERY );
 		if( xAxisTwoXSupp.is())
@@ -1900,6 +1907,37 @@
 			}
 			aPropertyStates.clear();
 
+            if( bHasSecondaryXAxisTitle )
+            {
+                Reference< chart::XSecondAxisTitleSupplier > xAxisSupp( xDiagram, uno::UNO_QUERY );
+                Reference< beans::XPropertySet > xTitleProp( xAxisSupp->getSecondXAxisTitle(), uno::UNO_QUERY );
+                if( xTitleProp.is())
+                {
+                    aPropertyStates = mxExpPropMapper->Filter( xTitleProp );
+                    if( bExportContent )
+                    {
+                        OUString aText;
+                        Any aAny( xTitleProp->getPropertyValue(
+							OUString( RTL_CONSTASCII_USTRINGPARAM( "String" ))));
+						aAny >>= aText;
+
+                        Reference< drawing::XShape > xShape( xTitleProp, uno::UNO_QUERY );
+                        if( xShape.is())
+                            addPosition( xShape );
+
+                        AddAutoStyleAttribute( aPropertyStates );
+                        SvXMLElementExport aTitle( mrExport, XML_NAMESPACE_CHART, XML_TITLE, sal_True, sal_True );
+
+                        exportText( aText );
+                    }
+                    else
+                    {
+                        CollectAutoStyle( aPropertyStates );
+                    }
+                    aPropertyStates.clear();
+                }
+            }
+
 			if( pAxis )
 			{
 				delete pAxis;
@@ -2021,7 +2059,7 @@
 		}
 	}
 
-	if( bHasSecondaryYAxis )
+	if( bHasSecondaryYAxis || bHasSecondaryYAxisTitle )
 	{
 		Reference< chart::XTwoAxisYSupplier > xAxisTwoYSupp( xDiagram, uno::UNO_QUERY );
 		if( xAxisTwoYSupp.is())
@@ -2046,6 +2084,37 @@
                 CollectAutoStyle( aPropertyStates );
 			}
 			aPropertyStates.clear();
+            if( bHasSecondaryYAxisTitle )
+            {
+                Reference< chart::XSecondAxisTitleSupplier > xAxisSupp( xDiagram, uno::UNO_QUERY );
+                Reference< beans::XPropertySet > xTitleProp( xAxisSupp->getSecondYAxisTitle(), uno::UNO_QUERY );
+                if( xTitleProp.is())
+                {
+                    aPropertyStates = mxExpPropMapper->Filter( xTitleProp );
+                    if( bExportContent )
+                    {
+                        OUString aText;
+                        Any aAny( xTitleProp->getPropertyValue(
+							OUString( RTL_CONSTASCII_USTRINGPARAM( "String" ))));
+						aAny >>= aText;
+
+                        Reference< drawing::XShape > xShape( xTitleProp, uno::UNO_QUERY );
+                        if( xShape.is())
+                            addPosition( xShape );
+
+                        AddAutoStyleAttribute( aPropertyStates );
+                        SvXMLElementExport aTitle( mrExport, XML_NAMESPACE_CHART, XML_TITLE, sal_True, sal_True );
+
+                        exportText( aText );
+                    }
+                    else
+                    {
+                        CollectAutoStyle( aPropertyStates );
+                    }
+                    aPropertyStates.clear();
+                }
+            }
+
 			if( pAxis )
 			{
 				delete pAxis;
--- xmloff/source/chart/SchXMLPlotAreaContext.cxx	2008-02-02 16:52:28.000000000 +0100
+++ xmloff/source/chart/SchXMLPlotAreaContext.cxx	2008-02-02 16:49:32.000000000 +0100
@@ -99,6 +99,8 @@
 #include <com/sun/star/drawing/CameraGeometry.hpp>
 #include <com/sun/star/drawing/FillStyle.hpp>
 #include <com/sun/star/drawing/LineStyle.hpp>
+#include <com/sun/star/chart/XSecondAxisTitleSupplier.hpp>
+
 #include <com/sun/star/awt/Point.hpp>
 #include <com/sun/star/awt/Size.hpp>
 
@@ -432,6 +434,26 @@
                     //this old property is not supported fully anymore with the new chart, so we need to get the information a little bit different from similar properties
                     mrSeriesDefaultsAndStyles.maLinesOnProperty = SchXMLTools::getPropertyFromContext(
                         ::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("Lines")), pPropStyleContext, pStylesCtxt );
+
+                    //correct default starting angle for old 3D pies
+                    sal_Int32 nBuildId = 0;
+                    sal_Int32 nUPD;
+                    if( !GetImport().getBuildIds( nUPD, nBuildId ) || nBuildId < xmloff::chart::BUILD_ID_3_0 )
+                    {
+                        bool bIs3d = false;
+                        if( xProp.is() && ( xProp->getPropertyValue(::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("Dim3D"))) >>= bIs3d ) &&
+                            bIs3d )
+                        {
+                            if( maChartTypeServiceName.equalsAsciiL( RTL_CONSTASCII_STRINGPARAM( "com.sun.star.chart2.PieChartType" ))
+                                || maChartTypeServiceName.equalsAsciiL( RTL_CONSTASCII_STRINGPARAM( "com.sun.star.chart2.DonutChartType" )) )
+                            {
+                                ::rtl::OUString aPropName( ::rtl::OUString(RTL_CONSTASCII_USTRINGPARAM("StartingAngle")) );
+                                uno::Any aAStartingAngle( SchXMLTools::getPropertyFromContext( aPropName, pPropStyleContext, pStylesCtxt ) );
+                                if( !aAStartingAngle.hasValue() )
+                                    xProp->setPropertyValue( aPropName, uno::makeAny(sal_Int32(0)) ) ;
+                            }
+                        }
+                    }
                 }
 			}
 		}
@@ -742,6 +764,16 @@
 					xResult = uno::Reference< drawing::XShape >( xSuppl->getXAxisTitle(), uno::UNO_QUERY );
 				}
 			}
+			else
+			{
+				uno::Reference< chart::XSecondAxisTitleSupplier > xSuppl( mxDiagram, uno::UNO_QUERY );
+				if( xSuppl.is() )
+				{
+					if( xDiaProp.is() )
+						xDiaProp->setPropertyValue( rtl::OUString::createFromAscii( "HasSecondaryXAxisTitle" ), aTrueBool );
+					xResult = uno::Reference< drawing::XShape >( xSuppl->getSecondXAxisTitle(), uno::UNO_QUERY );
+				}
+			}
 			break;
 		case SCH_XML_AXIS_Y:
 			if( maCurrentAxis.nIndexInCategory == 0 )
@@ -754,6 +786,16 @@
 					xResult = uno::Reference< drawing::XShape >( xSuppl->getYAxisTitle(), uno::UNO_QUERY );
 				}
 			}
+			else
+			{
+				uno::Reference< chart::XSecondAxisTitleSupplier > xSuppl( mxDiagram, uno::UNO_QUERY );
+				if( xSuppl.is() )
+				{
+					if( xDiaProp.is() )
+						xDiaProp->setPropertyValue( rtl::OUString::createFromAscii( "HasSecondaryYAxisTitle" ), aTrueBool );
+					xResult = uno::Reference< drawing::XShape >( xSuppl->getSecondYAxisTitle(), uno::UNO_QUERY );
+				}
+			}
 			break;
 		case SCH_XML_AXIS_Z:
         {
@@ -1200,6 +1242,28 @@
                     }
                 }
 			}
+            else
+            {
+                uno::Reference< chart::XSecondAxisTitleSupplier > xSuppl( mxDiagram, uno::UNO_QUERY );
+                if( xSuppl.is() &&
+                    bHasTitle )
+                {
+                    uno::Reference< beans::XPropertySet > xTitleProp( xSuppl->getSecondXAxisTitle(), uno::UNO_QUERY );
+                    if( xTitleProp.is())
+                    {
+                        try
+                        {
+                            uno::Any aAny;
+                            aAny <<= maCurrentAxis.aTitle;
+                            xTitleProp->setPropertyValue( rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "String" )), aAny );
+                        }
+                        catch( beans::UnknownPropertyException & )
+                        {
+                            DBG_ERROR( "Property String for Title not available" );
+                        }
+                    }
+                }
+            }
 			break;
 
 		case SCH_XML_AXIS_Y:
@@ -1225,6 +1289,28 @@
                     }
 				}
 			}
+            else
+            {
+                uno::Reference< chart::XSecondAxisTitleSupplier > xSuppl( mxDiagram, uno::UNO_QUERY );
+                if( xSuppl.is() &&
+                    bHasTitle )
+                {
+                    uno::Reference< beans::XPropertySet > xTitleProp( xSuppl->getSecondYAxisTitle(), uno::UNO_QUERY );
+                    if( xTitleProp.is())
+                    {
+                        try
+                        {
+                            uno::Any aAny;
+                            aAny <<= maCurrentAxis.aTitle;
+                            xTitleProp->setPropertyValue( rtl::OUString( RTL_CONSTASCII_USTRINGPARAM( "String" )), aAny );
+                        }
+                        catch( beans::UnknownPropertyException & )
+                        {
+                            DBG_ERROR( "Property String for Title not available" );
+                        }
+                    }
+                }
+            }
 			break;
 
 		case SCH_XML_AXIS_Z:
--- xmloff/source/core/xmltoken.cxx	2007-11-23 13:18:23.000000000 +0100
+++ xmloff/source/core/xmltoken.cxx	2007-12-18 14:44:21.000000000 +0100
@@ -2961,6 +2961,7 @@
         TOKEN( "dependency",             XML_DEPENDENCY ),
 
 		TOKEN( "nav-order",				XML_NAV_ORDER ),
+
         TOKEN( "automatic-content",     XML_AUTOMATIC_CONTENT ),
         TOKEN( "display-r-square",      XML_DISPLAY_R_SQUARE ),
         TOKEN( "display-equation",      XML_DISPLAY_EQUATION ),
@@ -2983,6 +2984,7 @@
         TOKEN( "fieldmark-end",         XML_FIELDMARK_END ),
         TOKEN( "urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:field:1.0",   XML_N_FIELD ),
         TOKEN( "field",         XML_NP_FIELD ),
+        TOKEN( "angle-offset",          XML_ANGLE_OFFSET ),
 #if OSL_DEBUG_LEVEL > 0
         { 0, NULL, NULL,                       XML_TOKEN_END }
 #else
